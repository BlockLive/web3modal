(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const u of n)if(u.type==="childList")for(const l of u.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const u={};return n.integrity&&(u.integrity=n.integrity),n.referrerPolicy&&(u.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?u.credentials="include":n.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function i(n){if(n.ep)return;n.ep=!0;const u=r(n);fetch(n.href,u)}})();var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fo(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function i(){if(this instanceof i){var n=[null];n.push.apply(n,arguments);var u=Function.bind.apply(t,n);return new u}return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),r}function Wc(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Gc=Yc;function Yc(e,t,r){var i=r&&r.stringify||Wc,n=1;if(typeof e=="object"&&e!==null){var u=t.length+n;if(u===1)return e;var l=new Array(u);l[0]=i(e);for(var o=1;o<u;o++)l[o]=i(t[o]);return l.join(" ")}if(typeof e!="string")return e;var f=t.length;if(f===0)return e;for(var g="",b=1-n,I=-1,$=e&&e.length||0,O=0;O<$;){if(e.charCodeAt(O)===37&&O+1<$){switch(I=I>-1?I:0,e.charCodeAt(O+1)){case 100:case 102:if(b>=f||t[b]==null)break;I<O&&(g+=e.slice(I,O)),g+=Number(t[b]),I=O+2,O++;break;case 105:if(b>=f||t[b]==null)break;I<O&&(g+=e.slice(I,O)),g+=Math.floor(Number(t[b])),I=O+2,O++;break;case 79:case 111:case 106:if(b>=f||t[b]===void 0)break;I<O&&(g+=e.slice(I,O));var C=typeof t[b];if(C==="string"){g+="'"+t[b]+"'",I=O+2,O++;break}if(C==="function"){g+=t[b].name||"<anonymous>",I=O+2,O++;break}g+=i(t[b]),I=O+2,O++;break;case 115:if(b>=f)break;I<O&&(g+=e.slice(I,O)),g+=String(t[b]),I=O+2,O++;break;case 37:I<O&&(g+=e.slice(I,O)),g+="%",I=O+2,O++,b--;break}++b}++O}return I===-1?e:(I<$&&(g+=e.slice(I)),g)}const as=Gc;var vi=Pt;const $r=su().console||{},Jc={mapHttpRequest:ii,mapHttpResponse:ii,wrapRequestSerializer:Bi,wrapResponseSerializer:Bi,wrapErrorSerializer:Bi,req:ii,res:ii,err:tu};function Xc(e,t){return Array.isArray(e)?e.filter(function(i){return i!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Pt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||$r;e.browser.write&&(e.browser.asObject=!0);const i=e.serializers||{},n=Xc(e.browser.serialize,i);let u=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(u=!1);const l=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const o=e.level||"info",f=Object.create(r);f.log||(f.log=jr),Object.defineProperty(f,"levelVal",{get:b}),Object.defineProperty(f,"level",{get:I,set:$});const g={transmit:t,serialize:n,asObject:e.browser.asObject,levels:l,timestamp:ru(e)};f.levels=Pt.levels,f.level=o,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=jr,f.serializers=i,f._serialize=n,f._stdErrSerialize=u,f.child=O,t&&(f._logEvent=cn());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function I(){return this._level}function $(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,ur(g,f,"error","log"),ur(g,f,"fatal","error"),ur(g,f,"warn","error"),ur(g,f,"info","log"),ur(g,f,"debug","log"),ur(g,f,"trace","log")}function O(C,q){if(!C)throw new Error("missing bindings for child Pino");q=q||{},n&&C.serializers&&(q.serializers=C.serializers);const H=q.serializers;if(n&&H){var Z=Object.assign({},i,H),A=e.browser.serialize===!0?Object.keys(Z):n;delete C.serializers,Di([C],A,Z,this._stdErrSerialize)}function U(m){this._childLevel=(m._childLevel|0)+1,this.error=hr(m,C,"error"),this.fatal=hr(m,C,"fatal"),this.warn=hr(m,C,"warn"),this.info=hr(m,C,"info"),this.debug=hr(m,C,"debug"),this.trace=hr(m,C,"trace"),Z&&(this.serializers=Z,this._serialize=A),t&&(this._logEvent=cn([].concat(m._logEvent.bindings,C)))}return U.prototype=this,new U(this)}return f}Pt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Pt.stdSerializers=Jc;Pt.stdTimeFunctions=Object.assign({},{nullTime:Lo,epochTime:Mo,unixTime:iu,isoTime:nu});function ur(e,t,r,i){const n=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?jr:n[r]?n[r]:$r[r]||$r[i]||jr,Zc(e,t,r)}function Zc(e,t,r){!e.transmit&&t[r]===jr||(t[r]=function(i){return function(){const u=e.timestamp(),l=new Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===$r?$r:this;for(var f=0;f<l.length;f++)l[f]=arguments[f];if(e.serialize&&!e.asObject&&Di(l,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?i.call(o,Qc(this,r,l,u)):i.apply(o,l),e.transmit){const g=e.transmit.level||t.level,b=Pt.levels.values[g],I=Pt.levels.values[r];if(I<b)return;eu(this,{ts:u,methodLevel:r,methodValue:I,transmitLevel:g,transmitValue:Pt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},l)}}}(t[r]))}function Qc(e,t,r,i){e._serialize&&Di(r,e._serialize,e.serializers,e._stdErrSerialize);const n=r.slice();let u=n[0];const l={};i&&(l.time=i),l.level=Pt.levels.values[t];let o=(e._childLevel|0)+1;if(o<1&&(o=1),u!==null&&typeof u=="object"){for(;o--&&typeof n[0]=="object";)Object.assign(l,n.shift());u=n.length?as(n.shift(),n):void 0}else typeof u=="string"&&(u=as(n.shift(),n));return u!==void 0&&(l.msg=u),l}function Di(e,t,r,i){for(const n in e)if(i&&e[n]instanceof Error)e[n]=Pt.stdSerializers.err(e[n]);else if(typeof e[n]=="object"&&!Array.isArray(e[n]))for(const u in e[n])t&&t.indexOf(u)>-1&&u in r&&(e[n][u]=r[u](e[n][u]))}function hr(e,t,r){return function(){const i=new Array(1+arguments.length);i[0]=t;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return e[r].apply(this,i)}}function eu(e,t,r){const i=t.send,n=t.ts,u=t.methodLevel,l=t.methodValue,o=t.val,f=e._logEvent.bindings;Di(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=n,e._logEvent.messages=r.filter(function(g){return f.indexOf(g)===-1}),e._logEvent.level.label=u,e._logEvent.level.value=l,i(u,e._logEvent,o),e._logEvent=cn(f)}function cn(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function tu(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function ru(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Lo:Mo}function ii(){return{}}function Bi(e){return e}function jr(){}function Lo(){return!1}function Mo(){return Date.now()}function iu(){return Math.round(Date.now()/1e3)}function nu(){return new Date(Date.now()).toISOString()}function su(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var lt={},ou={get exports(){return lt},set exports(e){lt=e}},wr=typeof Reflect=="object"?Reflect:null,cs=wr&&typeof wr.apply=="function"?wr.apply:function(t,r,i){return Function.prototype.apply.call(t,r,i)},hi;wr&&typeof wr.ownKeys=="function"?hi=wr.ownKeys:Object.getOwnPropertySymbols?hi=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:hi=function(t){return Object.getOwnPropertyNames(t)};function au(e){console&&console.warn&&console.warn(e)}var Bo=Number.isNaN||function(t){return t!==t};function Te(){Te.init.call(this)}ou.exports=Te;lt.once=lu;Te.EventEmitter=Te;Te.prototype._events=void 0;Te.prototype._eventsCount=0;Te.prototype._maxListeners=void 0;var us=10;function Si(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Te,"defaultMaxListeners",{enumerable:!0,get:function(){return us},set:function(e){if(typeof e!="number"||e<0||Bo(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");us=e}});Te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Te.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Bo(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function $o(e){return e._maxListeners===void 0?Te.defaultMaxListeners:e._maxListeners}Te.prototype.getMaxListeners=function(){return $o(this)};Te.prototype.emit=function(t){for(var r=[],i=1;i<arguments.length;i++)r.push(arguments[i]);var n=t==="error",u=this._events;if(u!==void 0)n=n&&u.error===void 0;else if(!n)return!1;if(n){var l;if(r.length>0&&(l=r[0]),l instanceof Error)throw l;var o=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw o.context=l,o}var f=u[t];if(f===void 0)return!1;if(typeof f=="function")cs(f,this,r);else for(var g=f.length,b=qo(f,g),i=0;i<g;++i)cs(b[i],this,r);return!0};function jo(e,t,r,i){var n,u,l;if(Si(r),u=e._events,u===void 0?(u=e._events=Object.create(null),e._eventsCount=0):(u.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),u=e._events),l=u[t]),l===void 0)l=u[t]=r,++e._eventsCount;else if(typeof l=="function"?l=u[t]=i?[r,l]:[l,r]:i?l.unshift(r):l.push(r),n=$o(e),n>0&&l.length>n&&!l.warned){l.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=l.length,au(o)}return e}Te.prototype.addListener=function(t,r){return jo(this,t,r,!1)};Te.prototype.on=Te.prototype.addListener;Te.prototype.prependListener=function(t,r){return jo(this,t,r,!0)};function cu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function zo(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},n=cu.bind(i);return n.listener=r,i.wrapFn=n,n}Te.prototype.once=function(t,r){return Si(r),this.on(t,zo(this,t,r)),this};Te.prototype.prependOnceListener=function(t,r){return Si(r),this.prependListener(t,zo(this,t,r)),this};Te.prototype.removeListener=function(t,r){var i,n,u,l,o;if(Si(r),n=this._events,n===void 0)return this;if(i=n[t],i===void 0)return this;if(i===r||i.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||r));else if(typeof i!="function"){for(u=-1,l=i.length-1;l>=0;l--)if(i[l]===r||i[l].listener===r){o=i[l].listener,u=l;break}if(u<0)return this;u===0?i.shift():uu(i,u),i.length===1&&(n[t]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",t,o||r)}return this};Te.prototype.off=Te.prototype.removeListener;Te.prototype.removeAllListeners=function(t){var r,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[t]),this;if(arguments.length===0){var u=Object.keys(i),l;for(n=0;n<u.length;++n)l=u[n],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=i[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(n=r.length-1;n>=0;n--)this.removeListener(t,r[n]);return this};function Ko(e,t,r){var i=e._events;if(i===void 0)return[];var n=i[t];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?hu(n):qo(n,n.length)}Te.prototype.listeners=function(t){return Ko(this,t,!0)};Te.prototype.rawListeners=function(t){return Ko(this,t,!1)};Te.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ho.call(e,t)};Te.prototype.listenerCount=Ho;function Ho(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Te.prototype.eventNames=function(){return this._eventsCount>0?hi(this._events):[]};function qo(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e[i];return r}function uu(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function hu(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function lu(e,t){return new Promise(function(r,i){function n(l){e.removeListener(t,u),i(l)}function u(){typeof e.removeListener=="function"&&e.removeListener("error",n),r([].slice.call(arguments))}Vo(e,t,u,{once:!0}),t!=="error"&&fu(e,n,{once:!0})})}function fu(e,t,r){typeof e.on=="function"&&Vo(e,"error",t,r)}function Vo(e,t,r,i){if(typeof e.on=="function")i.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function n(u){i.once&&e.removeEventListener(t,n),r(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var xi={},dt={},du={get exports(){return dt},set exports(e){dt=e}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(e){var t,r,i,n,u,l,o,f,g,b,I,$,O,C,q,H,Z,A,U,m,_,S,a;(function(y){var K=typeof ht=="object"?ht:typeof self=="object"?self:typeof this=="object"?this:{};y(E(K,E(e.exports)));function E(N,B){return N!==K&&(typeof Object.create=="function"?Object.defineProperty(N,"__esModule",{value:!0}):N.__esModule=!0),function(V,T){return N[V]=B?B(V,T):T}}})(function(y){var K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,N){E.__proto__=N}||function(E,N){for(var B in N)N.hasOwnProperty(B)&&(E[B]=N[B])};t=function(E,N){K(E,N);function B(){this.constructor=E}E.prototype=N===null?Object.create(N):(B.prototype=N.prototype,new B)},r=Object.assign||function(E){for(var N,B=1,V=arguments.length;B<V;B++){N=arguments[B];for(var T in N)Object.prototype.hasOwnProperty.call(N,T)&&(E[T]=N[T])}return E},i=function(E,N){var B={};for(var V in E)Object.prototype.hasOwnProperty.call(E,V)&&N.indexOf(V)<0&&(B[V]=E[V]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var T=0,V=Object.getOwnPropertySymbols(E);T<V.length;T++)N.indexOf(V[T])<0&&Object.prototype.propertyIsEnumerable.call(E,V[T])&&(B[V[T]]=E[V[T]]);return B},n=function(E,N,B,V){var T=arguments.length,x=T<3?N:V===null?V=Object.getOwnPropertyDescriptor(N,B):V,W;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(E,N,B,V);else for(var G=E.length-1;G>=0;G--)(W=E[G])&&(x=(T<3?W(x):T>3?W(N,B,x):W(N,B))||x);return T>3&&x&&Object.defineProperty(N,B,x),x},u=function(E,N){return function(B,V){N(B,V,E)}},l=function(E,N){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(E,N)},o=function(E,N,B,V){function T(x){return x instanceof B?x:new B(function(W){W(x)})}return new(B||(B=Promise))(function(x,W){function G(Y){try{z(V.next(Y))}catch(J){W(J)}}function k(Y){try{z(V.throw(Y))}catch(J){W(J)}}function z(Y){Y.done?x(Y.value):T(Y.value).then(G,k)}z((V=V.apply(E,N||[])).next())})},f=function(E,N){var B={label:0,sent:function(){if(x[0]&1)throw x[1];return x[1]},trys:[],ops:[]},V,T,x,W;return W={next:G(0),throw:G(1),return:G(2)},typeof Symbol=="function"&&(W[Symbol.iterator]=function(){return this}),W;function G(z){return function(Y){return k([z,Y])}}function k(z){if(V)throw new TypeError("Generator is already executing.");for(;B;)try{if(V=1,T&&(x=z[0]&2?T.return:z[0]?T.throw||((x=T.return)&&x.call(T),0):T.next)&&!(x=x.call(T,z[1])).done)return x;switch(T=0,x&&(z=[z[0]&2,x.value]),z[0]){case 0:case 1:x=z;break;case 4:return B.label++,{value:z[1],done:!1};case 5:B.label++,T=z[1],z=[0];continue;case 7:z=B.ops.pop(),B.trys.pop();continue;default:if(x=B.trys,!(x=x.length>0&&x[x.length-1])&&(z[0]===6||z[0]===2)){B=0;continue}if(z[0]===3&&(!x||z[1]>x[0]&&z[1]<x[3])){B.label=z[1];break}if(z[0]===6&&B.label<x[1]){B.label=x[1],x=z;break}if(x&&B.label<x[2]){B.label=x[2],B.ops.push(z);break}x[2]&&B.ops.pop(),B.trys.pop();continue}z=N.call(E,B)}catch(Y){z=[6,Y],T=0}finally{V=x=0}if(z[0]&5)throw z[1];return{value:z[0]?z[1]:void 0,done:!0}}},a=function(E,N,B,V){V===void 0&&(V=B),E[V]=N[B]},g=function(E,N){for(var B in E)B!=="default"&&!N.hasOwnProperty(B)&&(N[B]=E[B])},b=function(E){var N=typeof Symbol=="function"&&Symbol.iterator,B=N&&E[N],V=0;if(B)return B.call(E);if(E&&typeof E.length=="number")return{next:function(){return E&&V>=E.length&&(E=void 0),{value:E&&E[V++],done:!E}}};throw new TypeError(N?"Object is not iterable.":"Symbol.iterator is not defined.")},I=function(E,N){var B=typeof Symbol=="function"&&E[Symbol.iterator];if(!B)return E;var V=B.call(E),T,x=[],W;try{for(;(N===void 0||N-- >0)&&!(T=V.next()).done;)x.push(T.value)}catch(G){W={error:G}}finally{try{T&&!T.done&&(B=V.return)&&B.call(V)}finally{if(W)throw W.error}}return x},$=function(){for(var E=[],N=0;N<arguments.length;N++)E=E.concat(I(arguments[N]));return E},O=function(){for(var E=0,N=0,B=arguments.length;N<B;N++)E+=arguments[N].length;for(var V=Array(E),T=0,N=0;N<B;N++)for(var x=arguments[N],W=0,G=x.length;W<G;W++,T++)V[T]=x[W];return V},C=function(E){return this instanceof C?(this.v=E,this):new C(E)},q=function(E,N,B){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var V=B.apply(E,N||[]),T,x=[];return T={},W("next"),W("throw"),W("return"),T[Symbol.asyncIterator]=function(){return this},T;function W(re){V[re]&&(T[re]=function(Q){return new Promise(function(ae,ne){x.push([re,Q,ae,ne])>1||G(re,Q)})})}function G(re,Q){try{k(V[re](Q))}catch(ae){J(x[0][3],ae)}}function k(re){re.value instanceof C?Promise.resolve(re.value.v).then(z,Y):J(x[0][2],re)}function z(re){G("next",re)}function Y(re){G("throw",re)}function J(re,Q){re(Q),x.shift(),x.length&&G(x[0][0],x[0][1])}},H=function(E){var N,B;return N={},V("next"),V("throw",function(T){throw T}),V("return"),N[Symbol.iterator]=function(){return this},N;function V(T,x){N[T]=E[T]?function(W){return(B=!B)?{value:C(E[T](W)),done:T==="return"}:x?x(W):W}:x}},Z=function(E){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var N=E[Symbol.asyncIterator],B;return N?N.call(E):(E=typeof b=="function"?b(E):E[Symbol.iterator](),B={},V("next"),V("throw"),V("return"),B[Symbol.asyncIterator]=function(){return this},B);function V(x){B[x]=E[x]&&function(W){return new Promise(function(G,k){W=E[x](W),T(G,k,W.done,W.value)})}}function T(x,W,G,k){Promise.resolve(k).then(function(z){x({value:z,done:G})},W)}},A=function(E,N){return Object.defineProperty?Object.defineProperty(E,"raw",{value:N}):E.raw=N,E},U=function(E){if(E&&E.__esModule)return E;var N={};if(E!=null)for(var B in E)Object.hasOwnProperty.call(E,B)&&(N[B]=E[B]);return N.default=E,N},m=function(E){return E&&E.__esModule?E:{default:E}},_=function(E,N){if(!N.has(E))throw new TypeError("attempted to get private field on non-instance");return N.get(E)},S=function(E,N,B){if(!N.has(E))throw new TypeError("attempted to set private field on non-instance");return N.set(E,B),B},y("__extends",t),y("__assign",r),y("__rest",i),y("__decorate",n),y("__param",u),y("__metadata",l),y("__awaiter",o),y("__generator",f),y("__exportStar",g),y("__createBinding",a),y("__values",b),y("__read",I),y("__spread",$),y("__spreadArrays",O),y("__await",C),y("__asyncGenerator",q),y("__asyncDelegator",H),y("__asyncValues",Z),y("__makeTemplateObject",A),y("__importStar",U),y("__importDefault",m),y("__classPrivateFieldGet",_),y("__classPrivateFieldSet",S)})})(du);var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});function pu(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}Kr.safeJsonParse=pu;function gu(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}Kr.safeJsonStringify=gu;var di={},$i={get exports(){return di},set exports(e){di=e}},hs;function yu(){return hs||(hs=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,i){this[r]=String(i)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ht<"u"&&ht.localStorage?$i.exports=ht.localStorage:typeof window<"u"&&window.localStorage?$i.exports=window.localStorage:$i.exports=new t}()),di}var ji={},Sr={},ls;function wu(){if(ls)return Sr;ls=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IKeyValueStorage=void 0;class e{}return Sr.IKeyValueStorage=e,Sr}var xr={},fs;function bu(){if(fs)return xr;fs=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.parseEntry=void 0;const e=Kr;function t(r){var i;return[r[0],e.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return xr.parseEntry=t,xr}var ds;function mu(){return ds||(ds=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(wu(),e),t.__exportStar(bu(),e)}(ji)),ji}Object.defineProperty(xi,"__esModule",{value:!0});xi.KeyValueStorage=void 0;const yr=dt,ps=Kr,_u=yr.__importDefault(yu()),Eu=mu();class ko{constructor(){this.localStorage=_u.default}getKeys(){return yr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return yr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Eu.parseEntry)})}getItem(t){return yr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return ps.safeJsonParse(r)})}setItem(t,r){return yr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,ps.safeJsonStringify(r))})}removeItem(t){return yr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}xi.KeyValueStorage=ko;var vu=xi.default=ko,Hr={},Ir={},ce={},zi={},Or={},gs;function Du(){if(gs)return Or;gs=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Or.delay=e,Or}var Jt={},Ki={},Xt={},ys;function Su(){return ys||(ys=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.ONE_THOUSAND=Xt.ONE_HUNDRED=void 0,Xt.ONE_HUNDRED=100,Xt.ONE_THOUSAND=1e3),Xt}var Hi={},ws;function xu(){return ws||(ws=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(Hi)),Hi}var bs;function Wo(){return bs||(bs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(Su(),e),t.__exportStar(xu(),e)}(Ki)),Ki}var ms;function Iu(){if(ms)return Jt;ms=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.fromMiliseconds=Jt.toMiliseconds=void 0;const e=Wo();function t(i){return i*e.ONE_THOUSAND}Jt.toMiliseconds=t;function r(i){return Math.floor(i/e.ONE_THOUSAND)}return Jt.fromMiliseconds=r,Jt}var _s;function Ou(){return _s||(_s=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(Du(),e),t.__exportStar(Iu(),e)}(zi)),zi}var lr={},Es;function Au(){if(Es)return lr;Es=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return lr.Watch=e,lr.default=e,lr}var qi={},Ar={},vs;function Tu(){if(vs)return Ar;vs=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.IWatch=void 0;class e{}return Ar.IWatch=e,Ar}var Ds;function Cu(){return Ds||(Ds=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),dt.__exportStar(Tu(),e)}(qi)),qi}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(Ou(),e),t.__exportStar(Au(),e),t.__exportStar(Cu(),e),t.__exportStar(Wo(),e)})(ce);var Vi={},Tr={};let sr=class{};const Nu=Object.freeze(Object.defineProperty({__proto__:null,IEvents:sr},Symbol.toStringTag,{value:"Module"})),Ru=Fo(Nu);var Ss;function Uu(){if(Ss)return Tr;Ss=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.IHeartBeat=void 0;const e=Ru;class t extends e.IEvents{constructor(i){super()}}return Tr.IHeartBeat=t,Tr}var xs;function Go(){return xs||(xs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),dt.__exportStar(Uu(),e)}(Vi)),Vi}var ki={},Zt={},Is;function Pu(){if(Is)return Zt;Is=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.HEARTBEAT_EVENTS=Zt.HEARTBEAT_INTERVAL=void 0;const e=ce;return Zt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Zt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Zt}var Os;function Yo(){return Os||(Os=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),dt.__exportStar(Pu(),e)}(ki)),ki}var As;function Fu(){if(As)return Ir;As=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.HeartBeat=void 0;const e=dt,t=lt,r=ce,i=Go(),n=Yo();class u extends i.IHeartBeat{constructor(o){super(o),this.events=new t.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=(o==null?void 0:o.interval)||n.HEARTBEAT_INTERVAL}static init(o){return e.__awaiter(this,void 0,void 0,function*(){const f=new u(o);return yield f.init(),f})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(o,f){this.events.on(o,f)}once(o,f){this.events.once(o,f)}off(o,f){this.events.off(o,f)}removeListener(o,f){this.events.removeListener(o,f)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return Ir.HeartBeat=u,Ir}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(Fu(),e),t.__exportStar(Go(),e),t.__exportStar(Yo(),e)})(Hr);var Ae={},Qt={},Ts;function Jo(){return Ts||(Ts=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.PINO_CUSTOM_CONTEXT_KEY=Qt.PINO_LOGGER_DEFAULTS=void 0,Qt.PINO_LOGGER_DEFAULTS={level:"info"},Qt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Qt}var ut={},Cs;function Lu(){if(Cs)return ut;Cs=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.generateChildLogger=ut.formatChildLoggerContext=ut.getLoggerContext=ut.setBrowserLoggerContext=ut.getBrowserLoggerContext=ut.getDefaultLoggerOptions=void 0;const e=Jo();function t(o){return Object.assign(Object.assign({},o),{level:(o==null?void 0:o.level)||e.PINO_LOGGER_DEFAULTS.level})}ut.getDefaultLoggerOptions=t;function r(o,f=e.PINO_CUSTOM_CONTEXT_KEY){return o[f]||""}ut.getBrowserLoggerContext=r;function i(o,f,g=e.PINO_CUSTOM_CONTEXT_KEY){return o[g]=f,o}ut.setBrowserLoggerContext=i;function n(o,f=e.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof o.bindings>"u"?g=r(o,f):g=o.bindings().context||"",g}ut.getLoggerContext=n;function u(o,f,g=e.PINO_CUSTOM_CONTEXT_KEY){const b=n(o,g);return b.trim()?`${b}/${f}`:f}ut.formatChildLoggerContext=u;function l(o,f,g=e.PINO_CUSTOM_CONTEXT_KEY){const b=u(o,f,g),I=o.child({context:b});return i(I,b,g)}return ut.generateChildLogger=l,ut}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=dt,r=t.__importDefault(vi);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Jo(),e),t.__exportStar(Lu(),e)})(Ae);let Mu=class extends sr{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},Bu=class extends sr{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},$u=class{constructor(t,r){this.logger=t,this.core=r}},ju=class extends sr{constructor(t,r){super(),this.relayer=t,this.logger=r}},zu=class extends sr{constructor(t){super()}},Ku=class{constructor(t,r,i,n){this.core=t,this.logger=r,this.name=i}},Hu=class extends sr{constructor(t,r){super(),this.relayer=t,this.logger=r}},qu=class extends sr{constructor(t,r){super(),this.core=t,this.logger=r}};function Xo(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function xn(e){return typeof e=="string"?e:JSON.stringify(e)}var In={},br={},Ii={},Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});Oi.BrowserRandomSource=void 0;const Ns=65536;class Vu{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let i=0;i<r.length;i+=Ns)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Ns)));return r}}Oi.BrowserRandomSource=Vu;function ku(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ai={},bt={};Object.defineProperty(bt,"__esModule",{value:!0});function Wu(e){for(var t=0;t<e.length;t++)e[t]=0;return e}bt.wipe=Wu;const Gu={},Yu=Object.freeze(Object.defineProperty({__proto__:null,default:Gu},Symbol.toStringTag,{value:"Module"})),Ju=Fo(Yu);Object.defineProperty(Ai,"__esModule",{value:!0});Ai.NodeRandomSource=void 0;const Xu=bt;class Zu{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ku<"u"){const t=Ju;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(t);for(let n=0;n<i.length;n++)i[n]=r[n];return(0,Xu.wipe)(r),i}}Ai.NodeRandomSource=Zu;Object.defineProperty(Ii,"__esModule",{value:!0});Ii.SystemRandomSource=void 0;const Qu=Oi,eh=Ai;class th{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Qu.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new eh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Ii.SystemRandomSource=th;var pe={},Zo={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(o,f){var g=o>>>16&65535,b=o&65535,I=f>>>16&65535,$=f&65535;return b*$+(g*$+b*I<<16>>>0)|0}e.mul=Math.imul||t;function r(o,f){return o+f|0}e.add=r;function i(o,f){return o-f|0}e.sub=i;function n(o,f){return o<<f|o>>>32-f}e.rotl=n;function u(o,f){return o<<32-f|o>>>f}e.rotr=u;function l(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o}e.isInteger=Number.isInteger||l,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(o){return e.isInteger(o)&&o>=-e.MAX_SAFE_INTEGER&&o<=e.MAX_SAFE_INTEGER}})(Zo);Object.defineProperty(pe,"__esModule",{value:!0});var Qo=Zo;function rh(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}pe.readInt16BE=rh;function ih(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}pe.readUint16BE=ih;function nh(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}pe.readInt16LE=nh;function sh(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}pe.readUint16LE=sh;function ea(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}pe.writeUint16BE=ea;pe.writeInt16BE=ea;function ta(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}pe.writeUint16LE=ta;pe.writeInt16LE=ta;function un(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}pe.readInt32BE=un;function hn(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}pe.readUint32BE=hn;function ln(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}pe.readInt32LE=ln;function fn(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}pe.readUint32LE=fn;function pi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}pe.writeUint32BE=pi;pe.writeInt32BE=pi;function gi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}pe.writeUint32LE=gi;pe.writeInt32LE=gi;function oh(e,t){t===void 0&&(t=0);var r=un(e,t),i=un(e,t+4);return r*4294967296+i-(i>>31)*4294967296}pe.readInt64BE=oh;function ah(e,t){t===void 0&&(t=0);var r=hn(e,t),i=hn(e,t+4);return r*4294967296+i}pe.readUint64BE=ah;function ch(e,t){t===void 0&&(t=0);var r=ln(e,t),i=ln(e,t+4);return i*4294967296+r-(r>>31)*4294967296}pe.readInt64LE=ch;function uh(e,t){t===void 0&&(t=0);var r=fn(e,t),i=fn(e,t+4);return i*4294967296+r}pe.readUint64LE=uh;function ra(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),pi(e/4294967296>>>0,t,r),pi(e>>>0,t,r+4),t}pe.writeUint64BE=ra;pe.writeInt64BE=ra;function ia(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),gi(e>>>0,t,r),gi(e/4294967296>>>0,t,r+4),t}pe.writeUint64LE=ia;pe.writeInt64LE=ia;function hh(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,u=e/8+r-1;u>=r;u--)i+=t[u]*n,n*=256;return i}pe.readUintBE=hh;function lh(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,u=r;u<r+e/8;u++)i+=t[u]*n,n*=256;return i}pe.readUintLE=lh;function fh(e,t,r,i){if(r===void 0&&(r=new Uint8Array(e/8)),i===void 0&&(i=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Qo.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var n=1,u=e/8+i-1;u>=i;u--)r[u]=t/n&255,n*=256;return r}pe.writeUintBE=fh;function dh(e,t,r,i){if(r===void 0&&(r=new Uint8Array(e/8)),i===void 0&&(i=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Qo.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var n=1,u=i;u<i+e/8;u++)r[u]=t/n&255,n*=256;return r}pe.writeUintLE=dh;function ph(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}pe.readFloat32BE=ph;function gh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}pe.readFloat32LE=gh;function yh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}pe.readFloat64BE=yh;function wh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}pe.readFloat64LE=wh;function bh(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(r,e),t}pe.writeFloat32BE=bh;function mh(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat32(r,e,!0),t}pe.writeFloat32LE=mh;function _h(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(r,e),t}pe.writeFloat64BE=_h;function Eh(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(t.buffer,t.byteOffset,t.byteLength);return i.setFloat64(r,e,!0),t}pe.writeFloat64LE=Eh;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=Ii,r=pe,i=bt;e.defaultRandomSource=new t.SystemRandomSource;function n(g,b=e.defaultRandomSource){return b.randomBytes(g)}e.randomBytes=n;function u(g=e.defaultRandomSource){const b=n(4,g),I=(0,r.readUint32LE)(b);return(0,i.wipe)(b),I}e.randomUint32=u;const l="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o(g,b=l,I=e.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let $="";const O=b.length,C=256-256%O;for(;g>0;){const q=n(Math.ceil(g*256/C),I);for(let H=0;H<q.length&&g>0;H++){const Z=q[H];Z<C&&($+=b.charAt(Z%O),g--)}(0,i.wipe)(q)}return $}e.randomString=o;function f(g,b=l,I=e.defaultRandomSource){const $=Math.ceil(g/(Math.log(b.length)/Math.LN2));return o($,b,I)}e.randomStringForEntropy=f})(br);var na={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=pe,r=bt;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var i=function(){function o(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},o.prototype.update=function(f,g){if(g===void 0&&(g=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=f[b++],g--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(b=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,b,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=f[b++],g--;return this},o.prototype.finish=function(f){if(!this._finished){var g=this._bytesHashed,b=this._bufferLength,I=g/536870912|0,$=g<<3,O=g%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<O-8;C++)this._buffer[C]=0;t.writeUint32BE(I,this._buffer,O-8),t.writeUint32BE($,this._buffer,O-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,O),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)t.writeUint32BE(this._stateHi[C],f,C*8),t.writeUint32BE(this._stateLo[C],f,C*8+4);return this},o.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},o}();e.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(o,f,g,b,I,$,O){for(var C=g[0],q=g[1],H=g[2],Z=g[3],A=g[4],U=g[5],m=g[6],_=g[7],S=b[0],a=b[1],y=b[2],K=b[3],E=b[4],N=b[5],B=b[6],V=b[7],T,x,W,G,k,z,Y,J;O>=128;){for(var re=0;re<16;re++){var Q=8*re+$;o[re]=t.readUint32BE(I,Q),f[re]=t.readUint32BE(I,Q+4)}for(var re=0;re<80;re++){var ae=C,ne=q,ge=H,M=Z,L=A,R=U,h=m,v=_,ee=S,te=a,fe=y,Se=K,_e=E,xe=N,Fe=B,Ue=V;if(T=_,x=V,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=(A>>>14|E<<32-14)^(A>>>18|E<<32-18)^(E>>>41-32|A<<32-(41-32)),x=(E>>>14|A<<32-14)^(E>>>18|A<<32-18)^(A>>>41-32|E<<32-(41-32)),k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,T=A&U^~A&m,x=E&N^~E&B,k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,T=n[re*2],x=n[re*2+1],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,T=o[re%16],x=f[re%16],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,W=Y&65535|J<<16,G=k&65535|z<<16,T=W,x=G,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=(C>>>28|S<<32-28)^(S>>>34-32|C<<32-(34-32))^(S>>>39-32|C<<32-(39-32)),x=(S>>>28|C<<32-28)^(C>>>34-32|S<<32-(34-32))^(C>>>39-32|S<<32-(39-32)),k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,T=C&q^C&H^q&H,x=S&a^S&y^a&y,k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,v=Y&65535|J<<16,Ue=k&65535|z<<16,T=M,x=Se,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=W,x=G,k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,M=Y&65535|J<<16,Se=k&65535|z<<16,q=ae,H=ne,Z=ge,A=M,U=L,m=R,_=h,C=v,a=ee,y=te,K=fe,E=Se,N=_e,B=xe,V=Fe,S=Ue,re%16===15)for(var Q=0;Q<16;Q++)T=o[Q],x=f[Q],k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=o[(Q+9)%16],x=f[(Q+9)%16],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,W=o[(Q+1)%16],G=f[(Q+1)%16],T=(W>>>1|G<<32-1)^(W>>>8|G<<32-8)^W>>>7,x=(G>>>1|W<<32-1)^(G>>>8|W<<32-8)^(G>>>7|W<<32-7),k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,W=o[(Q+14)%16],G=f[(Q+14)%16],T=(W>>>19|G<<32-19)^(G>>>61-32|W<<32-(61-32))^W>>>6,x=(G>>>19|W<<32-19)^(W>>>61-32|G<<32-(61-32))^(G>>>6|W<<32-6),k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,o[Q]=Y&65535|J<<16,f[Q]=k&65535|z<<16}T=C,x=S,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[0],x=b[0],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[0]=C=Y&65535|J<<16,b[0]=S=k&65535|z<<16,T=q,x=a,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[1],x=b[1],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[1]=q=Y&65535|J<<16,b[1]=a=k&65535|z<<16,T=H,x=y,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[2],x=b[2],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[2]=H=Y&65535|J<<16,b[2]=y=k&65535|z<<16,T=Z,x=K,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[3],x=b[3],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[3]=Z=Y&65535|J<<16,b[3]=K=k&65535|z<<16,T=A,x=E,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[4],x=b[4],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[4]=A=Y&65535|J<<16,b[4]=E=k&65535|z<<16,T=U,x=N,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[5],x=b[5],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[5]=U=Y&65535|J<<16,b[5]=N=k&65535|z<<16,T=m,x=B,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[6],x=b[6],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[6]=m=Y&65535|J<<16,b[6]=B=k&65535|z<<16,T=_,x=V,k=x&65535,z=x>>>16,Y=T&65535,J=T>>>16,T=g[7],x=b[7],k+=x&65535,z+=x>>>16,Y+=T&65535,J+=T>>>16,z+=k>>>16,Y+=z>>>16,J+=Y>>>16,g[7]=_=Y&65535|J<<16,b[7]=V=k&65535|z<<16,$+=128,O-=128}return $}function l(o){var f=new i;f.update(o);var g=f.digest();return f.clean(),g}e.hash=l})(na);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=br,r=na,i=bt;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function n(M){const L=new Float64Array(16);if(M)for(let R=0;R<M.length;R++)L[R]=M[R];return L}const u=new Uint8Array(32);u[0]=9;const l=n(),o=n([1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),I=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function O(M,L){for(let R=0;R<16;R++)M[R]=L[R]|0}function C(M){let L=1;for(let R=0;R<16;R++){let h=M[R]+L+65535;L=Math.floor(h/65536),M[R]=h-L*65536}M[0]+=L-1+37*(L-1)}function q(M,L,R){const h=~(R-1);for(let v=0;v<16;v++){const ee=h&(M[v]^L[v]);M[v]^=ee,L[v]^=ee}}function H(M,L){const R=n(),h=n();for(let v=0;v<16;v++)h[v]=L[v];C(h),C(h),C(h);for(let v=0;v<2;v++){R[0]=h[0]-65517;for(let te=1;te<15;te++)R[te]=h[te]-65535-(R[te-1]>>16&1),R[te-1]&=65535;R[15]=h[15]-32767-(R[14]>>16&1);const ee=R[15]>>16&1;R[14]&=65535,q(h,R,1-ee)}for(let v=0;v<16;v++)M[2*v]=h[v]&255,M[2*v+1]=h[v]>>8}function Z(M,L){let R=0;for(let h=0;h<32;h++)R|=M[h]^L[h];return(1&R-1>>>8)-1}function A(M,L){const R=new Uint8Array(32),h=new Uint8Array(32);return H(R,M),H(h,L),Z(R,h)}function U(M){const L=new Uint8Array(32);return H(L,M),L[0]&1}function m(M,L){for(let R=0;R<16;R++)M[R]=L[2*R]+(L[2*R+1]<<8);M[15]&=32767}function _(M,L,R){for(let h=0;h<16;h++)M[h]=L[h]+R[h]}function S(M,L,R){for(let h=0;h<16;h++)M[h]=L[h]-R[h]}function a(M,L,R){let h,v,ee=0,te=0,fe=0,Se=0,_e=0,xe=0,Fe=0,Ue=0,Ee=0,be=0,he=0,ye=0,me=0,ue=0,de=0,d=0,s=0,c=0,p=0,D=0,F=0,j=0,ie=0,oe=0,ve=0,Ie=0,De=0,pt=0,kt=0,Er=0,Jr=0,je=R[0],Me=R[1],ze=R[2],Ke=R[3],He=R[4],Be=R[5],ke=R[6],We=R[7],Ge=R[8],Ye=R[9],Je=R[10],Ve=R[11],qe=R[12],Pe=R[13],Xe=R[14],Ze=R[15];h=L[0],ee+=h*je,te+=h*Me,fe+=h*ze,Se+=h*Ke,_e+=h*He,xe+=h*Be,Fe+=h*ke,Ue+=h*We,Ee+=h*Ge,be+=h*Ye,he+=h*Je,ye+=h*Ve,me+=h*qe,ue+=h*Pe,de+=h*Xe,d+=h*Ze,h=L[1],te+=h*je,fe+=h*Me,Se+=h*ze,_e+=h*Ke,xe+=h*He,Fe+=h*Be,Ue+=h*ke,Ee+=h*We,be+=h*Ge,he+=h*Ye,ye+=h*Je,me+=h*Ve,ue+=h*qe,de+=h*Pe,d+=h*Xe,s+=h*Ze,h=L[2],fe+=h*je,Se+=h*Me,_e+=h*ze,xe+=h*Ke,Fe+=h*He,Ue+=h*Be,Ee+=h*ke,be+=h*We,he+=h*Ge,ye+=h*Ye,me+=h*Je,ue+=h*Ve,de+=h*qe,d+=h*Pe,s+=h*Xe,c+=h*Ze,h=L[3],Se+=h*je,_e+=h*Me,xe+=h*ze,Fe+=h*Ke,Ue+=h*He,Ee+=h*Be,be+=h*ke,he+=h*We,ye+=h*Ge,me+=h*Ye,ue+=h*Je,de+=h*Ve,d+=h*qe,s+=h*Pe,c+=h*Xe,p+=h*Ze,h=L[4],_e+=h*je,xe+=h*Me,Fe+=h*ze,Ue+=h*Ke,Ee+=h*He,be+=h*Be,he+=h*ke,ye+=h*We,me+=h*Ge,ue+=h*Ye,de+=h*Je,d+=h*Ve,s+=h*qe,c+=h*Pe,p+=h*Xe,D+=h*Ze,h=L[5],xe+=h*je,Fe+=h*Me,Ue+=h*ze,Ee+=h*Ke,be+=h*He,he+=h*Be,ye+=h*ke,me+=h*We,ue+=h*Ge,de+=h*Ye,d+=h*Je,s+=h*Ve,c+=h*qe,p+=h*Pe,D+=h*Xe,F+=h*Ze,h=L[6],Fe+=h*je,Ue+=h*Me,Ee+=h*ze,be+=h*Ke,he+=h*He,ye+=h*Be,me+=h*ke,ue+=h*We,de+=h*Ge,d+=h*Ye,s+=h*Je,c+=h*Ve,p+=h*qe,D+=h*Pe,F+=h*Xe,j+=h*Ze,h=L[7],Ue+=h*je,Ee+=h*Me,be+=h*ze,he+=h*Ke,ye+=h*He,me+=h*Be,ue+=h*ke,de+=h*We,d+=h*Ge,s+=h*Ye,c+=h*Je,p+=h*Ve,D+=h*qe,F+=h*Pe,j+=h*Xe,ie+=h*Ze,h=L[8],Ee+=h*je,be+=h*Me,he+=h*ze,ye+=h*Ke,me+=h*He,ue+=h*Be,de+=h*ke,d+=h*We,s+=h*Ge,c+=h*Ye,p+=h*Je,D+=h*Ve,F+=h*qe,j+=h*Pe,ie+=h*Xe,oe+=h*Ze,h=L[9],be+=h*je,he+=h*Me,ye+=h*ze,me+=h*Ke,ue+=h*He,de+=h*Be,d+=h*ke,s+=h*We,c+=h*Ge,p+=h*Ye,D+=h*Je,F+=h*Ve,j+=h*qe,ie+=h*Pe,oe+=h*Xe,ve+=h*Ze,h=L[10],he+=h*je,ye+=h*Me,me+=h*ze,ue+=h*Ke,de+=h*He,d+=h*Be,s+=h*ke,c+=h*We,p+=h*Ge,D+=h*Ye,F+=h*Je,j+=h*Ve,ie+=h*qe,oe+=h*Pe,ve+=h*Xe,Ie+=h*Ze,h=L[11],ye+=h*je,me+=h*Me,ue+=h*ze,de+=h*Ke,d+=h*He,s+=h*Be,c+=h*ke,p+=h*We,D+=h*Ge,F+=h*Ye,j+=h*Je,ie+=h*Ve,oe+=h*qe,ve+=h*Pe,Ie+=h*Xe,De+=h*Ze,h=L[12],me+=h*je,ue+=h*Me,de+=h*ze,d+=h*Ke,s+=h*He,c+=h*Be,p+=h*ke,D+=h*We,F+=h*Ge,j+=h*Ye,ie+=h*Je,oe+=h*Ve,ve+=h*qe,Ie+=h*Pe,De+=h*Xe,pt+=h*Ze,h=L[13],ue+=h*je,de+=h*Me,d+=h*ze,s+=h*Ke,c+=h*He,p+=h*Be,D+=h*ke,F+=h*We,j+=h*Ge,ie+=h*Ye,oe+=h*Je,ve+=h*Ve,Ie+=h*qe,De+=h*Pe,pt+=h*Xe,kt+=h*Ze,h=L[14],de+=h*je,d+=h*Me,s+=h*ze,c+=h*Ke,p+=h*He,D+=h*Be,F+=h*ke,j+=h*We,ie+=h*Ge,oe+=h*Ye,ve+=h*Je,Ie+=h*Ve,De+=h*qe,pt+=h*Pe,kt+=h*Xe,Er+=h*Ze,h=L[15],d+=h*je,s+=h*Me,c+=h*ze,p+=h*Ke,D+=h*He,F+=h*Be,j+=h*ke,ie+=h*We,oe+=h*Ge,ve+=h*Ye,Ie+=h*Je,De+=h*Ve,pt+=h*qe,kt+=h*Pe,Er+=h*Xe,Jr+=h*Ze,ee+=38*s,te+=38*c,fe+=38*p,Se+=38*D,_e+=38*F,xe+=38*j,Fe+=38*ie,Ue+=38*oe,Ee+=38*ve,be+=38*Ie,he+=38*De,ye+=38*pt,me+=38*kt,ue+=38*Er,de+=38*Jr,v=1,h=ee+v+65535,v=Math.floor(h/65536),ee=h-v*65536,h=te+v+65535,v=Math.floor(h/65536),te=h-v*65536,h=fe+v+65535,v=Math.floor(h/65536),fe=h-v*65536,h=Se+v+65535,v=Math.floor(h/65536),Se=h-v*65536,h=_e+v+65535,v=Math.floor(h/65536),_e=h-v*65536,h=xe+v+65535,v=Math.floor(h/65536),xe=h-v*65536,h=Fe+v+65535,v=Math.floor(h/65536),Fe=h-v*65536,h=Ue+v+65535,v=Math.floor(h/65536),Ue=h-v*65536,h=Ee+v+65535,v=Math.floor(h/65536),Ee=h-v*65536,h=be+v+65535,v=Math.floor(h/65536),be=h-v*65536,h=he+v+65535,v=Math.floor(h/65536),he=h-v*65536,h=ye+v+65535,v=Math.floor(h/65536),ye=h-v*65536,h=me+v+65535,v=Math.floor(h/65536),me=h-v*65536,h=ue+v+65535,v=Math.floor(h/65536),ue=h-v*65536,h=de+v+65535,v=Math.floor(h/65536),de=h-v*65536,h=d+v+65535,v=Math.floor(h/65536),d=h-v*65536,ee+=v-1+37*(v-1),v=1,h=ee+v+65535,v=Math.floor(h/65536),ee=h-v*65536,h=te+v+65535,v=Math.floor(h/65536),te=h-v*65536,h=fe+v+65535,v=Math.floor(h/65536),fe=h-v*65536,h=Se+v+65535,v=Math.floor(h/65536),Se=h-v*65536,h=_e+v+65535,v=Math.floor(h/65536),_e=h-v*65536,h=xe+v+65535,v=Math.floor(h/65536),xe=h-v*65536,h=Fe+v+65535,v=Math.floor(h/65536),Fe=h-v*65536,h=Ue+v+65535,v=Math.floor(h/65536),Ue=h-v*65536,h=Ee+v+65535,v=Math.floor(h/65536),Ee=h-v*65536,h=be+v+65535,v=Math.floor(h/65536),be=h-v*65536,h=he+v+65535,v=Math.floor(h/65536),he=h-v*65536,h=ye+v+65535,v=Math.floor(h/65536),ye=h-v*65536,h=me+v+65535,v=Math.floor(h/65536),me=h-v*65536,h=ue+v+65535,v=Math.floor(h/65536),ue=h-v*65536,h=de+v+65535,v=Math.floor(h/65536),de=h-v*65536,h=d+v+65535,v=Math.floor(h/65536),d=h-v*65536,ee+=v-1+37*(v-1),M[0]=ee,M[1]=te,M[2]=fe,M[3]=Se,M[4]=_e,M[5]=xe,M[6]=Fe,M[7]=Ue,M[8]=Ee,M[9]=be,M[10]=he,M[11]=ye,M[12]=me,M[13]=ue,M[14]=de,M[15]=d}function y(M,L){a(M,L,L)}function K(M,L){const R=n();let h;for(h=0;h<16;h++)R[h]=L[h];for(h=253;h>=0;h--)y(R,R),h!==2&&h!==4&&a(R,R,L);for(h=0;h<16;h++)M[h]=R[h]}function E(M,L){const R=n();let h;for(h=0;h<16;h++)R[h]=L[h];for(h=250;h>=0;h--)y(R,R),h!==1&&a(R,R,L);for(h=0;h<16;h++)M[h]=R[h]}function N(M,L){const R=n(),h=n(),v=n(),ee=n(),te=n(),fe=n(),Se=n(),_e=n(),xe=n();S(R,M[1],M[0]),S(xe,L[1],L[0]),a(R,R,xe),_(h,M[0],M[1]),_(xe,L[0],L[1]),a(h,h,xe),a(v,M[3],L[3]),a(v,v,g),a(ee,M[2],L[2]),_(ee,ee,ee),S(te,h,R),S(fe,ee,v),_(Se,ee,v),_(_e,h,R),a(M[0],te,fe),a(M[1],_e,Se),a(M[2],Se,fe),a(M[3],te,_e)}function B(M,L,R){for(let h=0;h<4;h++)q(M[h],L[h],R)}function V(M,L){const R=n(),h=n(),v=n();K(v,L[2]),a(R,L[0],v),a(h,L[1],v),H(M,h),M[31]^=U(R)<<7}function T(M,L,R){O(M[0],l),O(M[1],o),O(M[2],o),O(M[3],l);for(let h=255;h>=0;--h){const v=R[h/8|0]>>(h&7)&1;B(M,L,v),N(L,M),N(M,M),B(M,L,v)}}function x(M,L){const R=[n(),n(),n(),n()];O(R[0],b),O(R[1],I),O(R[2],o),a(R[3],b,I),T(M,R,L)}function W(M){if(M.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const L=(0,r.hash)(M);L[0]&=248,L[31]&=127,L[31]|=64;const R=new Uint8Array(32),h=[n(),n(),n(),n()];x(h,L),V(R,h);const v=new Uint8Array(64);return v.set(M),v.set(R,32),{publicKey:R,secretKey:v}}e.generateKeyPairFromSeed=W;function G(M){const L=(0,t.randomBytes)(32,M),R=W(L);return(0,i.wipe)(L),R}e.generateKeyPair=G;function k(M){if(M.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(M.subarray(32))}e.extractPublicKeyFromSecretKey=k;const z=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(M,L){let R,h,v,ee;for(h=63;h>=32;--h){for(R=0,v=h-32,ee=h-12;v<ee;++v)L[v]+=R-16*L[h]*z[v-(h-32)],R=Math.floor((L[v]+128)/256),L[v]-=R*256;L[v]+=R,L[h]=0}for(R=0,v=0;v<32;v++)L[v]+=R-(L[31]>>4)*z[v],R=L[v]>>8,L[v]&=255;for(v=0;v<32;v++)L[v]-=R*z[v];for(h=0;h<32;h++)L[h+1]+=L[h]>>8,M[h]=L[h]&255}function J(M){const L=new Float64Array(64);for(let R=0;R<64;R++)L[R]=M[R];for(let R=0;R<64;R++)M[R]=0;Y(M,L)}function re(M,L){const R=new Float64Array(64),h=[n(),n(),n(),n()],v=(0,r.hash)(M.subarray(0,32));v[0]&=248,v[31]&=127,v[31]|=64;const ee=new Uint8Array(64);ee.set(v.subarray(32),32);const te=new r.SHA512;te.update(ee.subarray(32)),te.update(L);const fe=te.digest();te.clean(),J(fe),x(h,fe),V(ee,h),te.reset(),te.update(ee.subarray(0,32)),te.update(M.subarray(32)),te.update(L);const Se=te.digest();J(Se);for(let _e=0;_e<32;_e++)R[_e]=fe[_e];for(let _e=0;_e<32;_e++)for(let xe=0;xe<32;xe++)R[_e+xe]+=Se[_e]*v[xe];return Y(ee.subarray(32),R),ee}e.sign=re;function Q(M,L){const R=n(),h=n(),v=n(),ee=n(),te=n(),fe=n(),Se=n();return O(M[2],o),m(M[1],L),y(v,M[1]),a(ee,v,f),S(v,v,M[2]),_(ee,M[2],ee),y(te,ee),y(fe,te),a(Se,fe,te),a(R,Se,v),a(R,R,ee),E(R,R),a(R,R,v),a(R,R,ee),a(R,R,ee),a(M[0],R,ee),y(h,M[0]),a(h,h,ee),A(h,v)&&a(M[0],M[0],$),y(h,M[0]),a(h,h,ee),A(h,v)?-1:(U(M[0])===L[31]>>7&&S(M[0],l,M[0]),a(M[3],M[0],M[1]),0)}function ae(M,L,R){const h=new Uint8Array(32),v=[n(),n(),n(),n()],ee=[n(),n(),n(),n()];if(R.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(Q(ee,M))return!1;const te=new r.SHA512;te.update(R.subarray(0,32)),te.update(M),te.update(L);const fe=te.digest();return J(fe),T(v,ee,fe),x(ee,R.subarray(32)),N(v,ee),V(h,v),!Z(R,h)}e.verify=ae;function ne(M){let L=[n(),n(),n(),n()];if(Q(L,M))throw new Error("Ed25519: invalid public key");let R=n(),h=n(),v=L[1];_(R,o,v),S(h,o,v),K(h,h),a(R,R,h);let ee=new Uint8Array(32);return H(ee,R),ee}e.convertPublicKeyToX25519=ne;function ge(M){const L=(0,r.hash)(M.subarray(0,32));L[0]&=248,L[31]&=127,L[31]|=64;const R=new Uint8Array(L.subarray(0,32));return(0,i.wipe)(L),R}e.convertSecretKeyToX25519=ge})(In);const vh="EdDSA",Dh="JWT",sa=".",oa="base64url",Sh="utf8",xh="utf8",Ih=":",Oh="did",Ah="key",Rs="base58btc",Th="z",Ch="K36",Nh=32;function On(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function aa(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?On(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Rh(e,t){t||(t=e.reduce((n,u)=>n+u.length,0));const r=aa(t);let i=0;for(const n of e)r.set(n,i),i+=n.length;return On(r)}function Uh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var u=e.charAt(n),l=u.charCodeAt(0);if(r[l]!==255)throw new TypeError(u+" is ambiguous");r[l]=n}var o=e.length,f=e.charAt(0),g=Math.log(o)/Math.log(256),b=Math.log(256)/Math.log(o);function I(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var q=0,H=0,Z=0,A=C.length;Z!==A&&C[Z]===0;)Z++,q++;for(var U=(A-Z)*b+1>>>0,m=new Uint8Array(U);Z!==A;){for(var _=C[Z],S=0,a=U-1;(_!==0||S<H)&&a!==-1;a--,S++)_+=256*m[a]>>>0,m[a]=_%o>>>0,_=_/o>>>0;if(_!==0)throw new Error("Non-zero carry");H=S,Z++}for(var y=U-H;y!==U&&m[y]===0;)y++;for(var K=f.repeat(q);y<U;++y)K+=e.charAt(m[y]);return K}function $(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var q=0;if(C[q]!==" "){for(var H=0,Z=0;C[q]===f;)H++,q++;for(var A=(C.length-q)*g+1>>>0,U=new Uint8Array(A);C[q];){var m=r[C.charCodeAt(q)];if(m===255)return;for(var _=0,S=A-1;(m!==0||_<Z)&&S!==-1;S--,_++)m+=o*U[S]>>>0,U[S]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");Z=_,q++}if(C[q]!==" "){for(var a=A-Z;a!==A&&U[a]===0;)a++;for(var y=new Uint8Array(H+(A-a)),K=H;a!==A;)y[K++]=U[a++];return y}}}function O(C){var q=$(C);if(q)return q;throw new Error(`Non-${t} character`)}return{encode:I,decodeUnsafe:$,decode:O}}var Ph=Uh,Fh=Ph;const Lh=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Mh=e=>new TextEncoder().encode(e),Bh=e=>new TextDecoder().decode(e);class $h{constructor(t,r,i){this.name=t,this.prefix=r,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class jh{constructor(t,r,i){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ca(this,t)}}class zh{constructor(t){this.decoders=t}or(t){return ca(this,t)}decode(t){const r=t[0],i=this.decoders[r];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ca=(e,t)=>new zh({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Kh{constructor(t,r,i,n){this.name=t,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new $h(t,r,i),this.decoder=new jh(t,r,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ti=({name:e,prefix:t,encode:r,decode:i})=>new Kh(e,t,r,i),qr=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:n}=Fh(r,t);return Ti({prefix:e,name:t,encode:i,decode:u=>Lh(n(u))})},Hh=(e,t,r,i)=>{const n={};for(let b=0;b<t.length;++b)n[t[b]]=b;let u=e.length;for(;e[u-1]==="=";)--u;const l=new Uint8Array(u*r/8|0);let o=0,f=0,g=0;for(let b=0;b<u;++b){const I=n[e[b]];if(I===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|I,o+=r,o>=8&&(o-=8,l[g++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return l},qh=(e,t,r)=>{const i=t[t.length-1]==="=",n=(1<<r)-1;let u="",l=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],l+=8;l>r;)l-=r,u+=t[n&o>>l];if(l&&(u+=t[n&o<<r-l]),i)for(;u.length*r&7;)u+="=";return u},nt=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>Ti({prefix:t,name:e,encode(n){return qh(n,i,r)},decode(n){return Hh(n,i,r,e)}}),Vh=Ti({prefix:"\0",name:"identity",encode:e=>Bh(e),decode:e=>Mh(e)}),kh=Object.freeze(Object.defineProperty({__proto__:null,identity:Vh},Symbol.toStringTag,{value:"Module"})),Wh=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Gh=Object.freeze(Object.defineProperty({__proto__:null,base2:Wh},Symbol.toStringTag,{value:"Module"})),Yh=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Jh=Object.freeze(Object.defineProperty({__proto__:null,base8:Yh},Symbol.toStringTag,{value:"Module"})),Xh=qr({prefix:"9",name:"base10",alphabet:"0123456789"}),Zh=Object.freeze(Object.defineProperty({__proto__:null,base10:Xh},Symbol.toStringTag,{value:"Module"})),Qh=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),el=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),tl=Object.freeze(Object.defineProperty({__proto__:null,base16:Qh,base16upper:el},Symbol.toStringTag,{value:"Module"})),rl=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),il=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nl=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sl=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ol=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),al=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cl=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ul=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hl=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ll=Object.freeze(Object.defineProperty({__proto__:null,base32:rl,base32hex:ol,base32hexpad:cl,base32hexpadupper:ul,base32hexupper:al,base32pad:nl,base32padupper:sl,base32upper:il,base32z:hl},Symbol.toStringTag,{value:"Module"})),fl=qr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),dl=qr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),pl=Object.freeze(Object.defineProperty({__proto__:null,base36:fl,base36upper:dl},Symbol.toStringTag,{value:"Module"})),gl=qr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yl=qr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),wl=Object.freeze(Object.defineProperty({__proto__:null,base58btc:gl,base58flickr:yl},Symbol.toStringTag,{value:"Module"})),bl=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ml=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),_l=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),El=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),vl=Object.freeze(Object.defineProperty({__proto__:null,base64:bl,base64pad:ml,base64url:_l,base64urlpad:El},Symbol.toStringTag,{value:"Module"})),ua=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Dl=ua.reduce((e,t,r)=>(e[r]=t,e),[]),Sl=ua.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function xl(e){return e.reduce((t,r)=>(t+=Dl[r],t),"")}function Il(e){const t=[];for(const r of e){const i=Sl[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(i)}return new Uint8Array(t)}const Ol=Ti({prefix:"🚀",name:"base256emoji",encode:xl,decode:Il}),Al=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Ol},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const yi={...kh,...Gh,...Jh,...Zh,...tl,...ll,...pl,...wl,...vl,...Al};function ha(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const Us=ha("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Wi=ha("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=aa(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),la={utf8:Us,"utf-8":Us,hex:yi.base16,latin1:Wi,ascii:Wi,binary:Wi,...yi};function An(e,t="utf8"){const r=la[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function Tn(e,t="utf8"){const r=la[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?On(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function wi(e){return An(Tn(xn(e),Sh),oa)}function fa(e){const t=Tn(Ch,Rs),r=Th+An(Rh([t,e]),Rs);return[Oh,Ah,r].join(Ih)}function Tl(e){return An(e,oa)}function Cl(e){return Tn([wi(e.header),wi(e.payload)].join(sa),xh)}function Nl(e){return[wi(e.header),wi(e.payload),Tl(e.signature)].join(sa)}function Ps(e=br.randomBytes(Nh)){return In.generateKeyPairFromSeed(e)}async function Rl(e,t,r,i,n=ce.fromMiliseconds(Date.now())){const u={alg:vh,typ:Dh},l=fa(i.publicKey),o=n+r,f={iss:l,sub:e,aud:t,iat:n,exp:o},g=Cl({header:u,payload:f}),b=In.sign(i.secretKey,g);return Nl({header:u,payload:f,signature:b})}var Cn={},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});var at=pe,dn=bt,Ul=20;function Pl(e,t,r){for(var i=1634760805,n=857760878,u=2036477234,l=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],g=r[11]<<24|r[10]<<16|r[9]<<8|r[8],b=r[15]<<24|r[14]<<16|r[13]<<8|r[12],I=r[19]<<24|r[18]<<16|r[17]<<8|r[16],$=r[23]<<24|r[22]<<16|r[21]<<8|r[20],O=r[27]<<24|r[26]<<16|r[25]<<8|r[24],C=r[31]<<24|r[30]<<16|r[29]<<8|r[28],q=t[3]<<24|t[2]<<16|t[1]<<8|t[0],H=t[7]<<24|t[6]<<16|t[5]<<8|t[4],Z=t[11]<<24|t[10]<<16|t[9]<<8|t[8],A=t[15]<<24|t[14]<<16|t[13]<<8|t[12],U=i,m=n,_=u,S=l,a=o,y=f,K=g,E=b,N=I,B=$,V=O,T=C,x=q,W=H,G=Z,k=A,z=0;z<Ul;z+=2)U=U+a|0,x^=U,x=x>>>32-16|x<<16,N=N+x|0,a^=N,a=a>>>32-12|a<<12,m=m+y|0,W^=m,W=W>>>32-16|W<<16,B=B+W|0,y^=B,y=y>>>32-12|y<<12,_=_+K|0,G^=_,G=G>>>32-16|G<<16,V=V+G|0,K^=V,K=K>>>32-12|K<<12,S=S+E|0,k^=S,k=k>>>32-16|k<<16,T=T+k|0,E^=T,E=E>>>32-12|E<<12,_=_+K|0,G^=_,G=G>>>32-8|G<<8,V=V+G|0,K^=V,K=K>>>32-7|K<<7,S=S+E|0,k^=S,k=k>>>32-8|k<<8,T=T+k|0,E^=T,E=E>>>32-7|E<<7,m=m+y|0,W^=m,W=W>>>32-8|W<<8,B=B+W|0,y^=B,y=y>>>32-7|y<<7,U=U+a|0,x^=U,x=x>>>32-8|x<<8,N=N+x|0,a^=N,a=a>>>32-7|a<<7,U=U+y|0,k^=U,k=k>>>32-16|k<<16,V=V+k|0,y^=V,y=y>>>32-12|y<<12,m=m+K|0,x^=m,x=x>>>32-16|x<<16,T=T+x|0,K^=T,K=K>>>32-12|K<<12,_=_+E|0,W^=_,W=W>>>32-16|W<<16,N=N+W|0,E^=N,E=E>>>32-12|E<<12,S=S+a|0,G^=S,G=G>>>32-16|G<<16,B=B+G|0,a^=B,a=a>>>32-12|a<<12,_=_+E|0,W^=_,W=W>>>32-8|W<<8,N=N+W|0,E^=N,E=E>>>32-7|E<<7,S=S+a|0,G^=S,G=G>>>32-8|G<<8,B=B+G|0,a^=B,a=a>>>32-7|a<<7,m=m+K|0,x^=m,x=x>>>32-8|x<<8,T=T+x|0,K^=T,K=K>>>32-7|K<<7,U=U+y|0,k^=U,k=k>>>32-8|k<<8,V=V+k|0,y^=V,y=y>>>32-7|y<<7;at.writeUint32LE(U+i|0,e,0),at.writeUint32LE(m+n|0,e,4),at.writeUint32LE(_+u|0,e,8),at.writeUint32LE(S+l|0,e,12),at.writeUint32LE(a+o|0,e,16),at.writeUint32LE(y+f|0,e,20),at.writeUint32LE(K+g|0,e,24),at.writeUint32LE(E+b|0,e,28),at.writeUint32LE(N+I|0,e,32),at.writeUint32LE(B+$|0,e,36),at.writeUint32LE(V+O|0,e,40),at.writeUint32LE(T+C|0,e,44),at.writeUint32LE(x+q|0,e,48),at.writeUint32LE(W+H|0,e,52),at.writeUint32LE(G+Z|0,e,56),at.writeUint32LE(k+A|0,e,60)}function da(e,t,r,i,n){if(n===void 0&&(n=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var u,l;if(n===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");u=new Uint8Array(16),l=u.length-t.length,u.set(t,l)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");u=t,l=n}for(var o=new Uint8Array(64),f=0;f<r.length;f+=64){Pl(o,u,e);for(var g=f;g<f+64&&g<r.length;g++)i[g]=r[g]^o[g-f];Ll(u,0,l)}return dn.wipe(o),n===0&&dn.wipe(u),i}Ci.streamXOR=da;function Fl(e,t,r,i){return i===void 0&&(i=0),dn.wipe(r),da(e,t,r,r,i)}Ci.stream=Fl;function Ll(e,t,r){for(var i=1;r--;)i=i+(e[t]&255)|0,e[t]=i&255,i>>>=8,t++;if(i>0)throw new Error("ChaCha: counter overflow")}var pa={},Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});function Ml(e,t,r){return~(e-1)&t|e-1&r}Vt.select=Ml;function Bl(e,t){return(e|0)-(t|0)-1>>>31&1}Vt.lessOrEqual=Bl;function ga(e,t){if(e.length!==t.length)return 0;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 1&r-1>>>8}Vt.compare=ga;function $l(e,t){return e.length===0||t.length===0?!1:ga(e,t)!==0}Vt.equal=$l;(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Vt,r=bt;e.DIGEST_LENGTH=16;var i=function(){function l(o){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=o[0]|o[1]<<8;this._r[0]=f&8191;var g=o[2]|o[3]<<8;this._r[1]=(f>>>13|g<<3)&8191;var b=o[4]|o[5]<<8;this._r[2]=(g>>>10|b<<6)&7939;var I=o[6]|o[7]<<8;this._r[3]=(b>>>7|I<<9)&8191;var $=o[8]|o[9]<<8;this._r[4]=(I>>>4|$<<12)&255,this._r[5]=$>>>1&8190;var O=o[10]|o[11]<<8;this._r[6]=($>>>14|O<<2)&8191;var C=o[12]|o[13]<<8;this._r[7]=(O>>>11|C<<5)&8065;var q=o[14]|o[15]<<8;this._r[8]=(C>>>8|q<<8)&8191,this._r[9]=q>>>5&127,this._pad[0]=o[16]|o[17]<<8,this._pad[1]=o[18]|o[19]<<8,this._pad[2]=o[20]|o[21]<<8,this._pad[3]=o[22]|o[23]<<8,this._pad[4]=o[24]|o[25]<<8,this._pad[5]=o[26]|o[27]<<8,this._pad[6]=o[28]|o[29]<<8,this._pad[7]=o[30]|o[31]<<8}return l.prototype._blocks=function(o,f,g){for(var b=this._fin?0:2048,I=this._h[0],$=this._h[1],O=this._h[2],C=this._h[3],q=this._h[4],H=this._h[5],Z=this._h[6],A=this._h[7],U=this._h[8],m=this._h[9],_=this._r[0],S=this._r[1],a=this._r[2],y=this._r[3],K=this._r[4],E=this._r[5],N=this._r[6],B=this._r[7],V=this._r[8],T=this._r[9];g>=16;){var x=o[f+0]|o[f+1]<<8;I+=x&8191;var W=o[f+2]|o[f+3]<<8;$+=(x>>>13|W<<3)&8191;var G=o[f+4]|o[f+5]<<8;O+=(W>>>10|G<<6)&8191;var k=o[f+6]|o[f+7]<<8;C+=(G>>>7|k<<9)&8191;var z=o[f+8]|o[f+9]<<8;q+=(k>>>4|z<<12)&8191,H+=z>>>1&8191;var Y=o[f+10]|o[f+11]<<8;Z+=(z>>>14|Y<<2)&8191;var J=o[f+12]|o[f+13]<<8;A+=(Y>>>11|J<<5)&8191;var re=o[f+14]|o[f+15]<<8;U+=(J>>>8|re<<8)&8191,m+=re>>>5|b;var Q=0,ae=Q;ae+=I*_,ae+=$*(5*T),ae+=O*(5*V),ae+=C*(5*B),ae+=q*(5*N),Q=ae>>>13,ae&=8191,ae+=H*(5*E),ae+=Z*(5*K),ae+=A*(5*y),ae+=U*(5*a),ae+=m*(5*S),Q+=ae>>>13,ae&=8191;var ne=Q;ne+=I*S,ne+=$*_,ne+=O*(5*T),ne+=C*(5*V),ne+=q*(5*B),Q=ne>>>13,ne&=8191,ne+=H*(5*N),ne+=Z*(5*E),ne+=A*(5*K),ne+=U*(5*y),ne+=m*(5*a),Q+=ne>>>13,ne&=8191;var ge=Q;ge+=I*a,ge+=$*S,ge+=O*_,ge+=C*(5*T),ge+=q*(5*V),Q=ge>>>13,ge&=8191,ge+=H*(5*B),ge+=Z*(5*N),ge+=A*(5*E),ge+=U*(5*K),ge+=m*(5*y),Q+=ge>>>13,ge&=8191;var M=Q;M+=I*y,M+=$*a,M+=O*S,M+=C*_,M+=q*(5*T),Q=M>>>13,M&=8191,M+=H*(5*V),M+=Z*(5*B),M+=A*(5*N),M+=U*(5*E),M+=m*(5*K),Q+=M>>>13,M&=8191;var L=Q;L+=I*K,L+=$*y,L+=O*a,L+=C*S,L+=q*_,Q=L>>>13,L&=8191,L+=H*(5*T),L+=Z*(5*V),L+=A*(5*B),L+=U*(5*N),L+=m*(5*E),Q+=L>>>13,L&=8191;var R=Q;R+=I*E,R+=$*K,R+=O*y,R+=C*a,R+=q*S,Q=R>>>13,R&=8191,R+=H*_,R+=Z*(5*T),R+=A*(5*V),R+=U*(5*B),R+=m*(5*N),Q+=R>>>13,R&=8191;var h=Q;h+=I*N,h+=$*E,h+=O*K,h+=C*y,h+=q*a,Q=h>>>13,h&=8191,h+=H*S,h+=Z*_,h+=A*(5*T),h+=U*(5*V),h+=m*(5*B),Q+=h>>>13,h&=8191;var v=Q;v+=I*B,v+=$*N,v+=O*E,v+=C*K,v+=q*y,Q=v>>>13,v&=8191,v+=H*a,v+=Z*S,v+=A*_,v+=U*(5*T),v+=m*(5*V),Q+=v>>>13,v&=8191;var ee=Q;ee+=I*V,ee+=$*B,ee+=O*N,ee+=C*E,ee+=q*K,Q=ee>>>13,ee&=8191,ee+=H*y,ee+=Z*a,ee+=A*S,ee+=U*_,ee+=m*(5*T),Q+=ee>>>13,ee&=8191;var te=Q;te+=I*T,te+=$*V,te+=O*B,te+=C*N,te+=q*E,Q=te>>>13,te&=8191,te+=H*K,te+=Z*y,te+=A*a,te+=U*S,te+=m*_,Q+=te>>>13,te&=8191,Q=(Q<<2)+Q|0,Q=Q+ae|0,ae=Q&8191,Q=Q>>>13,ne+=Q,I=ae,$=ne,O=ge,C=M,q=L,H=R,Z=h,A=v,U=ee,m=te,f+=16,g-=16}this._h[0]=I,this._h[1]=$,this._h[2]=O,this._h[3]=C,this._h[4]=q,this._h[5]=H,this._h[6]=Z,this._h[7]=A,this._h[8]=U,this._h[9]=m},l.prototype.finish=function(o,f){f===void 0&&(f=0);var g=new Uint16Array(10),b,I,$,O;if(this._leftover){for(O=this._leftover,this._buffer[O++]=1;O<16;O++)this._buffer[O]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(b=this._h[1]>>>13,this._h[1]&=8191,O=2;O<10;O++)this._h[O]+=b,b=this._h[O]>>>13,this._h[O]&=8191;for(this._h[0]+=b*5,b=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=b,b=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=b,g[0]=this._h[0]+5,b=g[0]>>>13,g[0]&=8191,O=1;O<10;O++)g[O]=this._h[O]+b,b=g[O]>>>13,g[O]&=8191;for(g[9]-=1<<13,I=(b^1)-1,O=0;O<10;O++)g[O]&=I;for(I=~I,O=0;O<10;O++)this._h[O]=this._h[O]&I|g[O];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,$=this._h[0]+this._pad[0],this._h[0]=$&65535,O=1;O<8;O++)$=(this._h[O]+this._pad[O]|0)+($>>>16)|0,this._h[O]=$&65535;return o[f+0]=this._h[0]>>>0,o[f+1]=this._h[0]>>>8,o[f+2]=this._h[1]>>>0,o[f+3]=this._h[1]>>>8,o[f+4]=this._h[2]>>>0,o[f+5]=this._h[2]>>>8,o[f+6]=this._h[3]>>>0,o[f+7]=this._h[3]>>>8,o[f+8]=this._h[4]>>>0,o[f+9]=this._h[4]>>>8,o[f+10]=this._h[5]>>>0,o[f+11]=this._h[5]>>>8,o[f+12]=this._h[6]>>>0,o[f+13]=this._h[6]>>>8,o[f+14]=this._h[7]>>>0,o[f+15]=this._h[7]>>>8,this._finished=!0,this},l.prototype.update=function(o){var f=0,g=o.length,b;if(this._leftover){b=16-this._leftover,b>g&&(b=g);for(var I=0;I<b;I++)this._buffer[this._leftover+I]=o[f+I];if(g-=b,f+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(b=g-g%16,this._blocks(o,f,b),f+=b,g-=b),g){for(var I=0;I<g;I++)this._buffer[this._leftover+I]=o[f+I];this._leftover+=g}return this},l.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var o=new Uint8Array(16);return this.finish(o),o},l.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},l}();e.Poly1305=i;function n(l,o){var f=new i(l);f.update(o);var g=f.digest();return f.clean(),g}e.oneTimeAuth=n;function u(l,o){return l.length!==e.DIGEST_LENGTH||o.length!==e.DIGEST_LENGTH?!1:t.equal(l,o)}e.equal=u})(pa);(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Ci,r=pa,i=bt,n=pe,u=Vt;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var l=new Uint8Array(16),o=function(){function f(g){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,g.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return f.prototype.seal=function(g,b,I,$){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var O=new Uint8Array(16);O.set(g,O.length-g.length);var C=new Uint8Array(32);t.stream(this._key,O,C,4);var q=b.length+this.tagLength,H;if($){if($.length!==q)throw new Error("ChaCha20Poly1305: incorrect destination length");H=$}else H=new Uint8Array(q);return t.streamXOR(this._key,O,b,H,4),this._authenticate(H.subarray(H.length-this.tagLength,H.length),C,H.subarray(0,H.length-this.tagLength),I),i.wipe(O),H},f.prototype.open=function(g,b,I,$){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var O=new Uint8Array(16);O.set(g,O.length-g.length);var C=new Uint8Array(32);t.stream(this._key,O,C,4);var q=new Uint8Array(this.tagLength);if(this._authenticate(q,C,b.subarray(0,b.length-this.tagLength),I),!u.equal(q,b.subarray(b.length-this.tagLength,b.length)))return null;var H=b.length-this.tagLength,Z;if($){if($.length!==H)throw new Error("ChaCha20Poly1305: incorrect destination length");Z=$}else Z=new Uint8Array(H);return t.streamXOR(this._key,O,b.subarray(0,b.length-this.tagLength),Z,4),i.wipe(O),Z},f.prototype.clean=function(){return i.wipe(this._key),this},f.prototype._authenticate=function(g,b,I,$){var O=new r.Poly1305(b);$&&(O.update($),$.length%16>0&&O.update(l.subarray($.length%16))),O.update(I),I.length%16>0&&O.update(l.subarray(I.length%16));var C=new Uint8Array(8);$&&n.writeUint64LE($.length,C),O.update(C),n.writeUint64LE(I.length,C),O.update(C);for(var q=O.digest(),H=0;H<q.length;H++)g[H]=q[H];O.clean(),i.wipe(q),i.wipe(C)},f}();e.ChaCha20Poly1305=o})(Cn);var ya={},Vr={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});function jl(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}Nn.isSerializableHash=jl;Object.defineProperty(Vr,"__esModule",{value:!0});var Ct=Nn,zl=Vt,Kl=bt,wa=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Ct.isSerializableHash(this._inner)&&Ct.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Kl.wipe(i)}return e.prototype.reset=function(){if(!Ct.isSerializableHash(this._inner)||!Ct.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){Ct.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ct.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!Ct.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!Ct.isSerializableHash(this._inner)||!Ct.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!Ct.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();Vr.HMAC=wa;function Hl(e,t,r){var i=new wa(e,t);i.update(r);var n=i.digest();return i.clean(),n}Vr.hmac=Hl;Vr.equal=zl.equal;Object.defineProperty(ya,"__esModule",{value:!0});var Fs=Vr,Ls=bt,ql=function(){function e(t,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=n;var u=Fs.hmac(this._hash,i,r);this._hmac=new Fs.HMAC(t,u),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),Ls.wipe(this._buffer),Ls.wipe(this._counter),this._bufpos=0},e}(),Vl=ya.HKDF=ql,Ni={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=pe,r=bt;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var i=function(){function o(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return o.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},o.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},o.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},o.prototype.update=function(f,g){if(g===void 0&&(g=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=f[b++],g--;this._bufferLength===this.blockSize&&(u(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(b=u(this._temp,this._state,f,b,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=f[b++],g--;return this},o.prototype.finish=function(f){if(!this._finished){var g=this._bytesHashed,b=this._bufferLength,I=g/536870912|0,$=g<<3,O=g%64<56?64:128;this._buffer[b]=128;for(var C=b+1;C<O-8;C++)this._buffer[C]=0;t.writeUint32BE(I,this._buffer,O-8),t.writeUint32BE($,this._buffer,O-4),u(this._temp,this._state,this._buffer,0,O),this._finished=!0}for(var C=0;C<this.digestLength/4;C++)t.writeUint32BE(this._state[C],f,C*4);return this},o.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},o.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},o.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},o.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},o}();e.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function u(o,f,g,b,I){for(;I>=64;){for(var $=f[0],O=f[1],C=f[2],q=f[3],H=f[4],Z=f[5],A=f[6],U=f[7],m=0;m<16;m++){var _=b+m*4;o[m]=t.readUint32BE(g,_)}for(var m=16;m<64;m++){var S=o[m-2],a=(S>>>17|S<<32-17)^(S>>>19|S<<32-19)^S>>>10;S=o[m-15];var y=(S>>>7|S<<32-7)^(S>>>18|S<<32-18)^S>>>3;o[m]=(a+o[m-7]|0)+(y+o[m-16]|0)}for(var m=0;m<64;m++){var a=(((H>>>6|H<<26)^(H>>>11|H<<21)^(H>>>25|H<<7))+(H&Z^~H&A)|0)+(U+(n[m]+o[m]|0)|0)|0,y=(($>>>2|$<<32-2)^($>>>13|$<<32-13)^($>>>22|$<<32-22))+($&O^$&C^O&C)|0;U=A,A=Z,Z=H,H=q+a|0,q=C,C=O,O=$,$=a+y|0}f[0]+=$,f[1]+=O,f[2]+=C,f[3]+=q,f[4]+=H,f[5]+=Z,f[6]+=A,f[7]+=U,b+=64,I-=64}return b}function l(o){var f=new i;f.update(o);var g=f.digest();return f.clean(),g}e.hash=l})(Ni);var Rn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=br,r=bt;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function i(m){const _=new Float64Array(16);if(m)for(let S=0;S<m.length;S++)_[S]=m[S];return _}const n=new Uint8Array(32);n[0]=9;const u=i([56129,1]);function l(m){let _=1;for(let S=0;S<16;S++){let a=m[S]+_+65535;_=Math.floor(a/65536),m[S]=a-_*65536}m[0]+=_-1+37*(_-1)}function o(m,_,S){const a=~(S-1);for(let y=0;y<16;y++){const K=a&(m[y]^_[y]);m[y]^=K,_[y]^=K}}function f(m,_){const S=i(),a=i();for(let y=0;y<16;y++)a[y]=_[y];l(a),l(a),l(a);for(let y=0;y<2;y++){S[0]=a[0]-65517;for(let E=1;E<15;E++)S[E]=a[E]-65535-(S[E-1]>>16&1),S[E-1]&=65535;S[15]=a[15]-32767-(S[14]>>16&1);const K=S[15]>>16&1;S[14]&=65535,o(a,S,1-K)}for(let y=0;y<16;y++)m[2*y]=a[y]&255,m[2*y+1]=a[y]>>8}function g(m,_){for(let S=0;S<16;S++)m[S]=_[2*S]+(_[2*S+1]<<8);m[15]&=32767}function b(m,_,S){for(let a=0;a<16;a++)m[a]=_[a]+S[a]}function I(m,_,S){for(let a=0;a<16;a++)m[a]=_[a]-S[a]}function $(m,_,S){let a,y,K=0,E=0,N=0,B=0,V=0,T=0,x=0,W=0,G=0,k=0,z=0,Y=0,J=0,re=0,Q=0,ae=0,ne=0,ge=0,M=0,L=0,R=0,h=0,v=0,ee=0,te=0,fe=0,Se=0,_e=0,xe=0,Fe=0,Ue=0,Ee=S[0],be=S[1],he=S[2],ye=S[3],me=S[4],ue=S[5],de=S[6],d=S[7],s=S[8],c=S[9],p=S[10],D=S[11],F=S[12],j=S[13],ie=S[14],oe=S[15];a=_[0],K+=a*Ee,E+=a*be,N+=a*he,B+=a*ye,V+=a*me,T+=a*ue,x+=a*de,W+=a*d,G+=a*s,k+=a*c,z+=a*p,Y+=a*D,J+=a*F,re+=a*j,Q+=a*ie,ae+=a*oe,a=_[1],E+=a*Ee,N+=a*be,B+=a*he,V+=a*ye,T+=a*me,x+=a*ue,W+=a*de,G+=a*d,k+=a*s,z+=a*c,Y+=a*p,J+=a*D,re+=a*F,Q+=a*j,ae+=a*ie,ne+=a*oe,a=_[2],N+=a*Ee,B+=a*be,V+=a*he,T+=a*ye,x+=a*me,W+=a*ue,G+=a*de,k+=a*d,z+=a*s,Y+=a*c,J+=a*p,re+=a*D,Q+=a*F,ae+=a*j,ne+=a*ie,ge+=a*oe,a=_[3],B+=a*Ee,V+=a*be,T+=a*he,x+=a*ye,W+=a*me,G+=a*ue,k+=a*de,z+=a*d,Y+=a*s,J+=a*c,re+=a*p,Q+=a*D,ae+=a*F,ne+=a*j,ge+=a*ie,M+=a*oe,a=_[4],V+=a*Ee,T+=a*be,x+=a*he,W+=a*ye,G+=a*me,k+=a*ue,z+=a*de,Y+=a*d,J+=a*s,re+=a*c,Q+=a*p,ae+=a*D,ne+=a*F,ge+=a*j,M+=a*ie,L+=a*oe,a=_[5],T+=a*Ee,x+=a*be,W+=a*he,G+=a*ye,k+=a*me,z+=a*ue,Y+=a*de,J+=a*d,re+=a*s,Q+=a*c,ae+=a*p,ne+=a*D,ge+=a*F,M+=a*j,L+=a*ie,R+=a*oe,a=_[6],x+=a*Ee,W+=a*be,G+=a*he,k+=a*ye,z+=a*me,Y+=a*ue,J+=a*de,re+=a*d,Q+=a*s,ae+=a*c,ne+=a*p,ge+=a*D,M+=a*F,L+=a*j,R+=a*ie,h+=a*oe,a=_[7],W+=a*Ee,G+=a*be,k+=a*he,z+=a*ye,Y+=a*me,J+=a*ue,re+=a*de,Q+=a*d,ae+=a*s,ne+=a*c,ge+=a*p,M+=a*D,L+=a*F,R+=a*j,h+=a*ie,v+=a*oe,a=_[8],G+=a*Ee,k+=a*be,z+=a*he,Y+=a*ye,J+=a*me,re+=a*ue,Q+=a*de,ae+=a*d,ne+=a*s,ge+=a*c,M+=a*p,L+=a*D,R+=a*F,h+=a*j,v+=a*ie,ee+=a*oe,a=_[9],k+=a*Ee,z+=a*be,Y+=a*he,J+=a*ye,re+=a*me,Q+=a*ue,ae+=a*de,ne+=a*d,ge+=a*s,M+=a*c,L+=a*p,R+=a*D,h+=a*F,v+=a*j,ee+=a*ie,te+=a*oe,a=_[10],z+=a*Ee,Y+=a*be,J+=a*he,re+=a*ye,Q+=a*me,ae+=a*ue,ne+=a*de,ge+=a*d,M+=a*s,L+=a*c,R+=a*p,h+=a*D,v+=a*F,ee+=a*j,te+=a*ie,fe+=a*oe,a=_[11],Y+=a*Ee,J+=a*be,re+=a*he,Q+=a*ye,ae+=a*me,ne+=a*ue,ge+=a*de,M+=a*d,L+=a*s,R+=a*c,h+=a*p,v+=a*D,ee+=a*F,te+=a*j,fe+=a*ie,Se+=a*oe,a=_[12],J+=a*Ee,re+=a*be,Q+=a*he,ae+=a*ye,ne+=a*me,ge+=a*ue,M+=a*de,L+=a*d,R+=a*s,h+=a*c,v+=a*p,ee+=a*D,te+=a*F,fe+=a*j,Se+=a*ie,_e+=a*oe,a=_[13],re+=a*Ee,Q+=a*be,ae+=a*he,ne+=a*ye,ge+=a*me,M+=a*ue,L+=a*de,R+=a*d,h+=a*s,v+=a*c,ee+=a*p,te+=a*D,fe+=a*F,Se+=a*j,_e+=a*ie,xe+=a*oe,a=_[14],Q+=a*Ee,ae+=a*be,ne+=a*he,ge+=a*ye,M+=a*me,L+=a*ue,R+=a*de,h+=a*d,v+=a*s,ee+=a*c,te+=a*p,fe+=a*D,Se+=a*F,_e+=a*j,xe+=a*ie,Fe+=a*oe,a=_[15],ae+=a*Ee,ne+=a*be,ge+=a*he,M+=a*ye,L+=a*me,R+=a*ue,h+=a*de,v+=a*d,ee+=a*s,te+=a*c,fe+=a*p,Se+=a*D,_e+=a*F,xe+=a*j,Fe+=a*ie,Ue+=a*oe,K+=38*ne,E+=38*ge,N+=38*M,B+=38*L,V+=38*R,T+=38*h,x+=38*v,W+=38*ee,G+=38*te,k+=38*fe,z+=38*Se,Y+=38*_e,J+=38*xe,re+=38*Fe,Q+=38*Ue,y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=E+y+65535,y=Math.floor(a/65536),E=a-y*65536,a=N+y+65535,y=Math.floor(a/65536),N=a-y*65536,a=B+y+65535,y=Math.floor(a/65536),B=a-y*65536,a=V+y+65535,y=Math.floor(a/65536),V=a-y*65536,a=T+y+65535,y=Math.floor(a/65536),T=a-y*65536,a=x+y+65535,y=Math.floor(a/65536),x=a-y*65536,a=W+y+65535,y=Math.floor(a/65536),W=a-y*65536,a=G+y+65535,y=Math.floor(a/65536),G=a-y*65536,a=k+y+65535,y=Math.floor(a/65536),k=a-y*65536,a=z+y+65535,y=Math.floor(a/65536),z=a-y*65536,a=Y+y+65535,y=Math.floor(a/65536),Y=a-y*65536,a=J+y+65535,y=Math.floor(a/65536),J=a-y*65536,a=re+y+65535,y=Math.floor(a/65536),re=a-y*65536,a=Q+y+65535,y=Math.floor(a/65536),Q=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,K+=y-1+37*(y-1),y=1,a=K+y+65535,y=Math.floor(a/65536),K=a-y*65536,a=E+y+65535,y=Math.floor(a/65536),E=a-y*65536,a=N+y+65535,y=Math.floor(a/65536),N=a-y*65536,a=B+y+65535,y=Math.floor(a/65536),B=a-y*65536,a=V+y+65535,y=Math.floor(a/65536),V=a-y*65536,a=T+y+65535,y=Math.floor(a/65536),T=a-y*65536,a=x+y+65535,y=Math.floor(a/65536),x=a-y*65536,a=W+y+65535,y=Math.floor(a/65536),W=a-y*65536,a=G+y+65535,y=Math.floor(a/65536),G=a-y*65536,a=k+y+65535,y=Math.floor(a/65536),k=a-y*65536,a=z+y+65535,y=Math.floor(a/65536),z=a-y*65536,a=Y+y+65535,y=Math.floor(a/65536),Y=a-y*65536,a=J+y+65535,y=Math.floor(a/65536),J=a-y*65536,a=re+y+65535,y=Math.floor(a/65536),re=a-y*65536,a=Q+y+65535,y=Math.floor(a/65536),Q=a-y*65536,a=ae+y+65535,y=Math.floor(a/65536),ae=a-y*65536,K+=y-1+37*(y-1),m[0]=K,m[1]=E,m[2]=N,m[3]=B,m[4]=V,m[5]=T,m[6]=x,m[7]=W,m[8]=G,m[9]=k,m[10]=z,m[11]=Y,m[12]=J,m[13]=re,m[14]=Q,m[15]=ae}function O(m,_){$(m,_,_)}function C(m,_){const S=i();for(let a=0;a<16;a++)S[a]=_[a];for(let a=253;a>=0;a--)O(S,S),a!==2&&a!==4&&$(S,S,_);for(let a=0;a<16;a++)m[a]=S[a]}function q(m,_){const S=new Uint8Array(32),a=new Float64Array(80),y=i(),K=i(),E=i(),N=i(),B=i(),V=i();for(let G=0;G<31;G++)S[G]=m[G];S[31]=m[31]&127|64,S[0]&=248,g(a,_);for(let G=0;G<16;G++)K[G]=a[G];y[0]=N[0]=1;for(let G=254;G>=0;--G){const k=S[G>>>3]>>>(G&7)&1;o(y,K,k),o(E,N,k),b(B,y,E),I(y,y,E),b(E,K,N),I(K,K,N),O(N,B),O(V,y),$(y,E,y),$(E,K,B),b(B,y,E),I(y,y,E),O(K,y),I(E,N,V),$(y,E,u),b(y,y,N),$(E,E,y),$(y,N,V),$(N,K,a),O(K,B),o(y,K,k),o(E,N,k)}for(let G=0;G<16;G++)a[G+16]=y[G],a[G+32]=E[G],a[G+48]=K[G],a[G+64]=N[G];const T=a.subarray(32),x=a.subarray(16);C(T,T),$(x,x,T);const W=new Uint8Array(32);return f(W,x),W}e.scalarMult=q;function H(m){return q(m,n)}e.scalarMultBase=H;function Z(m){if(m.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const _=new Uint8Array(m);return{publicKey:H(_),secretKey:_}}e.generateKeyPairFromSeed=Z;function A(m){const _=(0,t.randomBytes)(32,m),S=Z(_);return(0,r.wipe)(_),S}e.generateKeyPair=A;function U(m,_,S=!1){if(m.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(_.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=q(m,_);if(S){let y=0;for(let K=0;K<a.length;K++)y|=a[K];if(y===0)throw new Error("X25519: invalid shared key")}return a}e.sharedKey=U})(Rn);function ba(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Ms(e,t){t||(t=e.reduce((n,u)=>n+u.length,0));const r=ba(t);let i=0;for(const n of e)r.set(n,i),i+=n.length;return r}function ma(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const Bs=ma("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Gi=ma("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=ba(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),_a={utf8:Bs,"utf-8":Bs,hex:yi.base16,latin1:Gi,ascii:Gi,binary:Gi,...yi};function At(e,t="utf8"){const r=_a[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function Tt(e,t="utf8"){const r=_a[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var $s=globalThis&&globalThis.__spreadArray||function(e,t,r){if(r||arguments.length===2)for(var i=0,n=t.length,u;i<n;i++)(u||!(i in t))&&(u||(u=Array.prototype.slice.call(t,0,i)),u[i]=t[i]);return e.concat(u||Array.prototype.slice.call(t))},kl=function(){function e(t,r,i){this.name=t,this.version=r,this.os=i,this.type="browser"}return e}(),Wl=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),Gl=function(){function e(t,r,i,n){this.name=t,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return e}(),Yl=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Jl=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Xl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Zl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,js=3,Ql=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Xl]],zs=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ef(e){return e?Ks(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Jl:typeof navigator<"u"?Ks(navigator.userAgent):nf()}function tf(e){return e!==""&&Ql.reduce(function(t,r){var i=r[0],n=r[1];if(t)return t;var u=n.exec(e);return!!u&&[i,u]},!1)}function Ks(e){var t=tf(e);if(!t)return null;var r=t[0],i=t[1];if(r==="searchbot")return new Yl;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<js&&(n=$s($s([],n,!0),sf(js-n.length),!0)):n=[];var u=n.join("."),l=rf(e),o=Zl.exec(e);return o&&o[1]?new Gl(r,u,l,o[1]):new kl(r,u,l)}function rf(e){for(var t=0,r=zs.length;t<r;t++){var i=zs[t],n=i[0],u=i[1],l=u.exec(e);if(l)return n}return null}function nf(){var e=typeof process<"u"&&process.version;return e?new Wl(process.version.slice(1)):null}function sf(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.getLocalStorage=Ce.getLocalStorageOrThrow=Ce.getCrypto=Ce.getCryptoOrThrow=va=Ce.getLocation=Ce.getLocationOrThrow=Un=Ce.getNavigator=Ce.getNavigatorOrThrow=Ea=Ce.getDocument=Ce.getDocumentOrThrow=Ce.getFromWindowOrThrow=Ce.getFromWindow=void 0;function or(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}Ce.getFromWindow=or;function mr(e){const t=or(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Ce.getFromWindowOrThrow=mr;function of(){return mr("document")}Ce.getDocumentOrThrow=of;function af(){return or("document")}var Ea=Ce.getDocument=af;function cf(){return mr("navigator")}Ce.getNavigatorOrThrow=cf;function uf(){return or("navigator")}var Un=Ce.getNavigator=uf;function hf(){return mr("location")}Ce.getLocationOrThrow=hf;function lf(){return or("location")}var va=Ce.getLocation=lf;function ff(){return mr("crypto")}Ce.getCryptoOrThrow=ff;function df(){return or("crypto")}Ce.getCrypto=df;function pf(){return mr("localStorage")}Ce.getLocalStorageOrThrow=pf;function gf(){return or("localStorage")}Ce.getLocalStorage=gf;var Pn={};Object.defineProperty(Pn,"__esModule",{value:!0});var Da=Pn.getWindowMetadata=void 0;const Hs=Ce;function yf(){let e,t;try{e=Hs.getDocumentOrThrow(),t=Hs.getLocationOrThrow()}catch{return null}function r(){const I=e.getElementsByTagName("link"),$=[];for(let O=0;O<I.length;O++){const C=I[O],q=C.getAttribute("rel");if(q&&q.toLowerCase().indexOf("icon")>-1){const H=C.getAttribute("href");if(H)if(H.toLowerCase().indexOf("https:")===-1&&H.toLowerCase().indexOf("http:")===-1&&H.indexOf("//")!==0){let Z=t.protocol+"//"+t.host;if(H.indexOf("/")===0)Z+=H;else{const A=t.pathname.split("/");A.pop();const U=A.join("/");Z+=U+"/"+H}$.push(Z)}else if(H.indexOf("//")===0){const Z=t.protocol+H;$.push(Z)}else $.push(H)}}return $}function i(...I){const $=e.getElementsByTagName("meta");for(let O=0;O<$.length;O++){const C=$[O],q=["itemprop","property","name"].map(H=>C.getAttribute(H)).filter(H=>H?I.includes(H):!1);if(q.length&&q){const H=C.getAttribute("content");if(H)return H}}return""}function n(){let I=i("name","og:site_name","og:title","twitter:title");return I||(I=e.title),I}function u(){return i("description","og:description","twitter:description","keywords")}const l=n(),o=u(),f=t.origin,g=r();return{description:o,url:f,icons:g,name:l}}Da=Pn.getWindowMetadata=yf;var zr={},wf=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Sa="%[a-f0-9]{2}",qs=new RegExp("("+Sa+")|([^%]+?)","gi"),Vs=new RegExp("("+Sa+")+","gi");function pn(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],pn(r),pn(i))}function bf(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(qs)||[],r=1;r<t.length;r++)e=pn(t,r).join(""),t=e.match(qs)||[];return e}}function mf(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=Vs.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var i=bf(r[0]);i!==r[0]&&(t[r[0]]=i)}r=Vs.exec(e)}t["%C2"]="�";for(var n=Object.keys(t),u=0;u<n.length;u++){var l=n[u];e=e.replace(new RegExp(l,"g"),t[l])}return e}var _f=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return mf(e)}},Ef=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},vf=function(e,t){for(var r={},i=Object.keys(e),n=Array.isArray(t),u=0;u<i.length;u++){var l=i[u],o=e[l];(n?t.indexOf(l)!==-1:t(l,o,e))&&(r[l]=o)}return r};(function(e){const t=wf,r=_f,i=Ef,n=vf,u=A=>A==null,l=Symbol("encodeFragmentIdentifier");function o(A){switch(A.arrayFormat){case"index":return U=>(m,_)=>{const S=m.length;return _===void 0||A.skipNull&&_===null||A.skipEmptyString&&_===""?m:_===null?[...m,[b(U,A),"[",S,"]"].join("")]:[...m,[b(U,A),"[",b(S,A),"]=",b(_,A)].join("")]};case"bracket":return U=>(m,_)=>_===void 0||A.skipNull&&_===null||A.skipEmptyString&&_===""?m:_===null?[...m,[b(U,A),"[]"].join("")]:[...m,[b(U,A),"[]=",b(_,A)].join("")];case"colon-list-separator":return U=>(m,_)=>_===void 0||A.skipNull&&_===null||A.skipEmptyString&&_===""?m:_===null?[...m,[b(U,A),":list="].join("")]:[...m,[b(U,A),":list=",b(_,A)].join("")];case"comma":case"separator":case"bracket-separator":{const U=A.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(_,S)=>S===void 0||A.skipNull&&S===null||A.skipEmptyString&&S===""?_:(S=S===null?"":S,_.length===0?[[b(m,A),U,b(S,A)].join("")]:[[_,b(S,A)].join(A.arrayFormatSeparator)])}default:return U=>(m,_)=>_===void 0||A.skipNull&&_===null||A.skipEmptyString&&_===""?m:_===null?[...m,b(U,A)]:[...m,[b(U,A),"=",b(_,A)].join("")]}}function f(A){let U;switch(A.arrayFormat){case"index":return(m,_,S)=>{if(U=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!U){S[m]=_;return}S[m]===void 0&&(S[m]={}),S[m][U[1]]=_};case"bracket":return(m,_,S)=>{if(U=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!U){S[m]=_;return}if(S[m]===void 0){S[m]=[_];return}S[m]=[].concat(S[m],_)};case"colon-list-separator":return(m,_,S)=>{if(U=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!U){S[m]=_;return}if(S[m]===void 0){S[m]=[_];return}S[m]=[].concat(S[m],_)};case"comma":case"separator":return(m,_,S)=>{const a=typeof _=="string"&&_.includes(A.arrayFormatSeparator),y=typeof _=="string"&&!a&&I(_,A).includes(A.arrayFormatSeparator);_=y?I(_,A):_;const K=a||y?_.split(A.arrayFormatSeparator).map(E=>I(E,A)):_===null?_:I(_,A);S[m]=K};case"bracket-separator":return(m,_,S)=>{const a=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!a){S[m]=_&&I(_,A);return}const y=_===null?[]:_.split(A.arrayFormatSeparator).map(K=>I(K,A));if(S[m]===void 0){S[m]=y;return}S[m]=[].concat(S[m],y)};default:return(m,_,S)=>{if(S[m]===void 0){S[m]=_;return}S[m]=[].concat(S[m],_)}}}function g(A){if(typeof A!="string"||A.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(A,U){return U.encode?U.strict?t(A):encodeURIComponent(A):A}function I(A,U){return U.decode?r(A):A}function $(A){return Array.isArray(A)?A.sort():typeof A=="object"?$(Object.keys(A)).sort((U,m)=>Number(U)-Number(m)).map(U=>A[U]):A}function O(A){const U=A.indexOf("#");return U!==-1&&(A=A.slice(0,U)),A}function C(A){let U="";const m=A.indexOf("#");return m!==-1&&(U=A.slice(m)),U}function q(A){A=O(A);const U=A.indexOf("?");return U===-1?"":A.slice(U+1)}function H(A,U){return U.parseNumbers&&!Number.isNaN(Number(A))&&typeof A=="string"&&A.trim()!==""?A=Number(A):U.parseBooleans&&A!==null&&(A.toLowerCase()==="true"||A.toLowerCase()==="false")&&(A=A.toLowerCase()==="true"),A}function Z(A,U){U=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},U),g(U.arrayFormatSeparator);const m=f(U),_=Object.create(null);if(typeof A!="string"||(A=A.trim().replace(/^[?#&]/,""),!A))return _;for(const S of A.split("&")){if(S==="")continue;let[a,y]=i(U.decode?S.replace(/\+/g," "):S,"=");y=y===void 0?null:["comma","separator","bracket-separator"].includes(U.arrayFormat)?y:I(y,U),m(I(a,U),y,_)}for(const S of Object.keys(_)){const a=_[S];if(typeof a=="object"&&a!==null)for(const y of Object.keys(a))a[y]=H(a[y],U);else _[S]=H(a,U)}return U.sort===!1?_:(U.sort===!0?Object.keys(_).sort():Object.keys(_).sort(U.sort)).reduce((S,a)=>{const y=_[a];return Boolean(y)&&typeof y=="object"&&!Array.isArray(y)?S[a]=$(y):S[a]=y,S},Object.create(null))}e.extract=q,e.parse=Z,e.stringify=(A,U)=>{if(!A)return"";U=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},U),g(U.arrayFormatSeparator);const m=y=>U.skipNull&&u(A[y])||U.skipEmptyString&&A[y]==="",_=o(U),S={};for(const y of Object.keys(A))m(y)||(S[y]=A[y]);const a=Object.keys(S);return U.sort!==!1&&a.sort(U.sort),a.map(y=>{const K=A[y];return K===void 0?"":K===null?b(y,U):Array.isArray(K)?K.length===0&&U.arrayFormat==="bracket-separator"?b(y,U)+"[]":K.reduce(_(y),[]).join("&"):b(y,U)+"="+b(K,U)}).filter(y=>y.length>0).join("&")},e.parseUrl=(A,U)=>{U=Object.assign({decode:!0},U);const[m,_]=i(A,"#");return Object.assign({url:m.split("?")[0]||"",query:Z(q(A),U)},U&&U.parseFragmentIdentifier&&_?{fragmentIdentifier:I(_,U)}:{})},e.stringifyUrl=(A,U)=>{U=Object.assign({encode:!0,strict:!0,[l]:!0},U);const m=O(A.url).split("?")[0]||"",_=e.extract(A.url),S=e.parse(_,{sort:!1}),a=Object.assign(S,A.query);let y=e.stringify(a,U);y&&(y=`?${y}`);let K=C(A.url);return A.fragmentIdentifier&&(K=`#${U[l]?b(A.fragmentIdentifier,U):A.fragmentIdentifier}`),`${m}${y}${K}`},e.pick=(A,U,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[l]:!1},m);const{url:_,query:S,fragmentIdentifier:a}=e.parseUrl(A,m);return e.stringifyUrl({url:_,query:n(S,U),fragmentIdentifier:a},m)},e.exclude=(A,U,m)=>{const _=Array.isArray(U)?S=>!U.includes(S):(S,a)=>!U(S,a);return e.pick(A,_,m)}})(zr);const Df={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},xa="base10",ft="base16",gn="base64pad",Fn="utf8",Ia=0,_r=1,Sf=0,ks=1,yn=12,Ln=32;function xf(){const e=Rn.generateKeyPair();return{privateKey:Tt(e.secretKey,ft),publicKey:Tt(e.publicKey,ft)}}function wn(){const e=br.randomBytes(Ln);return Tt(e,ft)}function If(e,t){const r=Rn.sharedKey(At(e,ft),At(t,ft)),i=new Vl(Ni.SHA256,r).expand(Ln);return Tt(i,ft)}function Of(e){const t=Ni.hash(At(e,ft));return Tt(t,ft)}function bi(e){const t=Ni.hash(At(e,Fn));return Tt(t,ft)}function Af(e){return At(`${e}`,xa)}function kr(e){return Number(Tt(e,xa))}function Tf(e){const t=Af(typeof e.type<"u"?e.type:Ia);if(kr(t)===_r&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?At(e.senderPublicKey,ft):void 0,i=typeof e.iv<"u"?At(e.iv,ft):br.randomBytes(yn),n=new Cn.ChaCha20Poly1305(At(e.symKey,ft)).seal(i,At(e.message,Fn));return Nf({type:t,sealed:n,iv:i,senderPublicKey:r})}function Cf(e){const t=new Cn.ChaCha20Poly1305(At(e.symKey,ft)),{sealed:r,iv:i}=Mn(e.encoded),n=t.open(i,r);if(n===null)throw new Error("Failed to decrypt");return Tt(n,Fn)}function Nf(e){if(kr(e.type)===_r){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Tt(Ms([e.type,e.senderPublicKey,e.iv,e.sealed]),gn)}return Tt(Ms([e.type,e.iv,e.sealed]),gn)}function Mn(e){const t=At(e,gn),r=t.slice(Sf,ks),i=ks;if(kr(r)===_r){const o=i+Ln,f=o+yn,g=t.slice(i,o),b=t.slice(o,f),I=t.slice(f);return{type:r,sealed:I,iv:b,senderPublicKey:g}}const n=i+yn,u=t.slice(i,n),l=t.slice(n);return{type:r,sealed:l,iv:u}}function Rf(e,t){const r=Mn(e);return Oa({type:kr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Tt(r.senderPublicKey,ft):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Oa(e){const t=(e==null?void 0:e.type)||Ia;if(t===_r){if(typeof(e==null?void 0:e.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(e==null?void 0:e.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e==null?void 0:e.senderPublicKey,receiverPublicKey:e==null?void 0:e.receiverPublicKey}}function Ws(e){return e.type===_r&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Uf=Object.defineProperty,Gs=Object.getOwnPropertySymbols,Pf=Object.prototype.hasOwnProperty,Ff=Object.prototype.propertyIsEnumerable,Ys=(e,t,r)=>t in e?Uf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Js=(e,t)=>{for(var r in t||(t={}))Pf.call(t,r)&&Ys(e,r,t[r]);if(Gs)for(var r of Gs(t))Ff.call(t,r)&&Ys(e,r,t[r]);return e};const Lf="ReactNative",Fr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Mf="js";function Aa(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Bf(){return!Ea()&&!!Un()&&navigator.product===Lf}function $f(){return!Aa()&&!!Un()}function jf(){return Bf()?Fr.reactNative:Aa()?Fr.node:$f()?Fr.browser:Fr.unknown}function zf(e,t){let r=zr.parse(e);return r=Js(Js({},r),t),e=zr.stringify(r),e}function Kf(){const e=ef();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Hf(){var e;const t=jf();return t===Fr.browser?[t,((e=va())==null?void 0:e.host)||"unknown"].join(":"):t}function qf(e,t,r){const i=Kf(),n=Hf();return[[e,t].join("-"),[Mf,r].join("-"),i,n].join("/")}function Vf({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:n,projectId:u}){const l=r.split("?"),o=qf(e,t,i),f={auth:n,ua:o,projectId:u},g=zf(l[1]||"",f);return l[0]+"?"+g}function Ta(e){return Object.fromEntries(e.entries())}function Ca(e){return new Map(Object.entries(e))}function kf(e){const t=ce.toMiliseconds(e||ce.FIVE_MINUTES);let r,i,n;return{resolve:u=>{n&&r&&(clearTimeout(n),r(u))},reject:u=>{n&&i&&(clearTimeout(n),i(u))},done:()=>new Promise((u,l)=>{n=setTimeout(l,t),r=u,i=l})}}function Na(e,t){return new Promise(async(r,i)=>{const n=setTimeout(()=>i(),t),u=await e;clearTimeout(n),r(u)})}function Ra(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Wf(e){return Ra("topic",e)}function Gf(e){return Ra("id",e)}function Yf(e){const[t,r]=e.split(":"),i={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")i.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function Yi(e,t){return ce.fromMiliseconds((t||Date.now())+ce.toMiliseconds(e))}function Xs(e){return Date.now()>=ce.toMiliseconds(e)}function Ji(e,t){return`${e}${t?`:${t}`:""}`}const Jf="irn";function bn(e){return(e==null?void 0:e.relay)||{protocol:Jf}}function mn(e){const t=Df[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Xf=Object.defineProperty,Zs=Object.getOwnPropertySymbols,Zf=Object.prototype.hasOwnProperty,Qf=Object.prototype.propertyIsEnumerable,Qs=(e,t,r)=>t in e?Xf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ed=(e,t)=>{for(var r in t||(t={}))Zf.call(t,r)&&Qs(e,r,t[r]);if(Zs)for(var r of Zs(t))Qf.call(t,r)&&Qs(e,r,t[r]);return e};function td(e,t="-"){const r={},i="relay"+t;return Object.keys(e).forEach(n=>{if(n.startsWith(i)){const u=n.replace(i,""),l=e[n];r[u]=l}}),r}function rd(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,i=e.substring(0,t),n=e.substring(t+1,r).split("@"),u=typeof r<"u"?e.substring(r):"",l=zr.parse(u);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:l.symKey,relay:td(l)}}function id(e,t="-"){const r="relay",i={};return Object.keys(e).forEach(n=>{const u=r+t+n;e[n]&&(i[u]=e[n])}),i}function nd(e){return`${e.protocol}:${e.topic}@${e.version}?`+zr.stringify(ed({symKey:e.symKey},id(e.relay)))}const sd={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},od={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Ne(e,t){const{message:r,code:i}=od[e];return{message:t?`${r} ${t}`:r,code:i}}function Lr(e,t){const{message:r,code:i}=sd[e];return{message:t?`${r} ${t}`:r,code:i}}function mi(e){return typeof e>"u"}function Ua(e,t){return t&&mi(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function ad(e){if(Ua(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function cd(e){var t;return(t=e==null?void 0:e.proposer)==null?void 0:t.publicKey}function ud(e){return e==null?void 0:e.topic}function Xi(e){return typeof e<"u"&&typeof e!==null}const hd="PARSE_ERROR",ld="INVALID_REQUEST",fd="METHOD_NOT_FOUND",dd="INVALID_PARAMS",Pa="INTERNAL_ERROR",Bn="SERVER_ERROR",pd=[-32700,-32600,-32601,-32602,-32603],Mr={[hd]:{code:-32700,message:"Parse error"},[ld]:{code:-32600,message:"Invalid Request"},[fd]:{code:-32601,message:"Method not found"},[dd]:{code:-32602,message:"Invalid params"},[Pa]:{code:-32603,message:"Internal error"},[Bn]:{code:-32e3,message:"Server error"}},Fa=Bn;function gd(e){return pd.includes(e)}function eo(e){return Object.keys(Mr).includes(e)?Mr[e]:Mr[Fa]}function yd(e){const t=Object.values(Mr).find(r=>r.code===e);return t||Mr[Fa]}function wd(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var La={},Mt={},to;function bd(){if(to)return Mt;to=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.isBrowserCryptoAvailable=Mt.getSubtleCrypto=Mt.getBrowerCrypto=void 0;function e(){return(ht==null?void 0:ht.crypto)||(ht==null?void 0:ht.msCrypto)||{}}Mt.getBrowerCrypto=e;function t(){const i=e();return i.subtle||i.webkitSubtle}Mt.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return Mt.isBrowserCryptoAvailable=r,Mt}var Bt={},ro;function md(){if(ro)return Bt;ro=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.isBrowser=Bt.isNode=Bt.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Bt.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Bt.isNode=t;function r(){return!e()&&!t()}return Bt.isBrowser=r,Bt}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=dt;t.__exportStar(bd(),e),t.__exportStar(md(),e)})(La);function _d(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function Ri(e,t,r){return{id:r||_d(),jsonrpc:"2.0",method:e,params:t}}function $n(e,t){return{id:e,jsonrpc:"2.0",result:t}}function jn(e,t,r){return{id:e,jsonrpc:"2.0",error:Ed(t,r)}}function Ed(e,t){return typeof e>"u"?eo(Pa):(typeof e=="string"&&(e=Object.assign(Object.assign({},eo(Bn)),{message:e})),typeof t<"u"&&(e.data=t),gd(e.code)&&(e=yd(e.code)),e)}class vd{}class Dd extends vd{constructor(){super()}}class Sd extends Dd{constructor(t){super()}}const xd="^wss?:";function Id(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Od(e,t){const r=Id(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function io(e){return Od(e,xd)}function Ad(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function Ma(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function zn(e){return Ma(e)&&"method"in e}function Kn(e){return Ma(e)&&($t(e)||Ot(e))}function $t(e){return"result"in e}function Ot(e){return"error"in e}class Td extends Sd{constructor(t){super(t),this.events=new lt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Ri(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(u){n(u)}this.events.on(`${t.id}`,u=>{Ot(u)?n(u.error):i(u.result)});try{await this.connection.send(t,r)}catch(u){n(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Kn(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}const no=10,Cd=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Nd=()=>typeof window<"u",Rd=Cd();class Ud{constructor(t){if(this.url=t,this.events=new lt.EventEmitter,this.registering=!1,!io(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(xn(t))}catch(i){this.onError(t.id,i)}}register(t=this.url){if(!io(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),n(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,i)=>{const n=La.isReactNative()?void 0:{rejectUnauthorized:!Ad(t)},u=new Rd(t,[],n);Nd()?u.onerror=l=>{const o=l;i(this.emitError(o.error))}:u.on("error",l=>{i(this.emitError(l))}),u.onopen=()=>{this.onOpen(u),r(u)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Xo(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const i=this.parseError(r),n=i.message||i.toString(),u=jn(t,n);this.events.emit("payload",u)}parseError(t,r=this.url){return wd(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>no&&this.events.setMaxListeners(no)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var _i={},Pd={get exports(){return _i},set exports(e){_i=e}};(function(e,t){var r=200,i="__lodash_hash_undefined__",n=1,u=2,l=9007199254740991,o="[object Arguments]",f="[object Array]",g="[object AsyncFunction]",b="[object Boolean]",I="[object Date]",$="[object Error]",O="[object Function]",C="[object GeneratorFunction]",q="[object Map]",H="[object Number]",Z="[object Null]",A="[object Object]",U="[object Promise]",m="[object Proxy]",_="[object RegExp]",S="[object Set]",a="[object String]",y="[object Symbol]",K="[object Undefined]",E="[object WeakMap]",N="[object ArrayBuffer]",B="[object DataView]",V="[object Float32Array]",T="[object Float64Array]",x="[object Int8Array]",W="[object Int16Array]",G="[object Int32Array]",k="[object Uint8Array]",z="[object Uint8ClampedArray]",Y="[object Uint16Array]",J="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,ae=/^(?:0|[1-9]\d*)$/,ne={};ne[V]=ne[T]=ne[x]=ne[W]=ne[G]=ne[k]=ne[z]=ne[Y]=ne[J]=!0,ne[o]=ne[f]=ne[N]=ne[b]=ne[B]=ne[I]=ne[$]=ne[O]=ne[q]=ne[H]=ne[A]=ne[_]=ne[S]=ne[a]=ne[E]=!1;var ge=typeof ht=="object"&&ht&&ht.Object===Object&&ht,M=typeof self=="object"&&self&&self.Object===Object&&self,L=ge||M||Function("return this")(),R=t&&!t.nodeType&&t,h=R&&!0&&e&&!e.nodeType&&e,v=h&&h.exports===R,ee=v&&ge.process,te=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),fe=te&&te.isTypedArray;function Se(w,P){for(var X=-1,se=w==null?0:w.length,Re=0,we=[];++X<se;){var $e=w[X];P($e,X,w)&&(we[Re++]=$e)}return we}function _e(w,P){for(var X=-1,se=P.length,Re=w.length;++X<se;)w[Re+X]=P[X];return w}function xe(w,P){for(var X=-1,se=w==null?0:w.length;++X<se;)if(P(w[X],X,w))return!0;return!1}function Fe(w,P){for(var X=-1,se=Array(w);++X<w;)se[X]=P(X);return se}function Ue(w){return function(P){return w(P)}}function Ee(w,P){return w.has(P)}function be(w,P){return w==null?void 0:w[P]}function he(w){var P=-1,X=Array(w.size);return w.forEach(function(se,Re){X[++P]=[Re,se]}),X}function ye(w,P){return function(X){return w(P(X))}}function me(w){var P=-1,X=Array(w.size);return w.forEach(function(se){X[++P]=se}),X}var ue=Array.prototype,de=Function.prototype,d=Object.prototype,s=L["__core-js_shared__"],c=de.toString,p=d.hasOwnProperty,D=function(){var w=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),F=d.toString,j=RegExp("^"+c.call(p).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ie=v?L.Buffer:void 0,oe=L.Symbol,ve=L.Uint8Array,Ie=d.propertyIsEnumerable,De=ue.splice,pt=oe?oe.toStringTag:void 0,kt=Object.getOwnPropertySymbols,Er=ie?ie.isBuffer:void 0,Jr=ye(Object.keys,Object),je=cr(L,"DataView"),Me=cr(L,"Map"),ze=cr(L,"Promise"),Ke=cr(L,"Set"),He=cr(L,"WeakMap"),Be=cr(Object,"create"),ke=Gt(je),We=Gt(Me),Ge=Gt(ze),Ye=Gt(Ke),Je=Gt(He),Ve=oe?oe.prototype:void 0,qe=Ve?Ve.valueOf:void 0;function Pe(w){var P=-1,X=w==null?0:w.length;for(this.clear();++P<X;){var se=w[P];this.set(se[0],se[1])}}function Xe(){this.__data__=Be?Be(null):{},this.size=0}function Ze(w){var P=this.has(w)&&delete this.__data__[w];return this.size-=P?1:0,P}function oc(w){var P=this.__data__;if(Be){var X=P[w];return X===i?void 0:X}return p.call(P,w)?P[w]:void 0}function ac(w){var P=this.__data__;return Be?P[w]!==void 0:p.call(P,w)}function cc(w,P){var X=this.__data__;return this.size+=this.has(w)?0:1,X[w]=Be&&P===void 0?i:P,this}Pe.prototype.clear=Xe,Pe.prototype.delete=Ze,Pe.prototype.get=oc,Pe.prototype.has=ac,Pe.prototype.set=cc;function Ft(w){var P=-1,X=w==null?0:w.length;for(this.clear();++P<X;){var se=w[P];this.set(se[0],se[1])}}function uc(){this.__data__=[],this.size=0}function hc(w){var P=this.__data__,X=Zr(P,w);if(X<0)return!1;var se=P.length-1;return X==se?P.pop():De.call(P,X,1),--this.size,!0}function lc(w){var P=this.__data__,X=Zr(P,w);return X<0?void 0:P[X][1]}function fc(w){return Zr(this.__data__,w)>-1}function dc(w,P){var X=this.__data__,se=Zr(X,w);return se<0?(++this.size,X.push([w,P])):X[se][1]=P,this}Ft.prototype.clear=uc,Ft.prototype.delete=hc,Ft.prototype.get=lc,Ft.prototype.has=fc,Ft.prototype.set=dc;function Wt(w){var P=-1,X=w==null?0:w.length;for(this.clear();++P<X;){var se=w[P];this.set(se[0],se[1])}}function pc(){this.size=0,this.__data__={hash:new Pe,map:new(Me||Ft),string:new Pe}}function gc(w){var P=Qr(this,w).delete(w);return this.size-=P?1:0,P}function yc(w){return Qr(this,w).get(w)}function wc(w){return Qr(this,w).has(w)}function bc(w,P){var X=Qr(this,w),se=X.size;return X.set(w,P),this.size+=X.size==se?0:1,this}Wt.prototype.clear=pc,Wt.prototype.delete=gc,Wt.prototype.get=yc,Wt.prototype.has=wc,Wt.prototype.set=bc;function Xr(w){var P=-1,X=w==null?0:w.length;for(this.__data__=new Wt;++P<X;)this.add(w[P])}function mc(w){return this.__data__.set(w,i),this}function _c(w){return this.__data__.has(w)}Xr.prototype.add=Xr.prototype.push=mc,Xr.prototype.has=_c;function jt(w){var P=this.__data__=new Ft(w);this.size=P.size}function Ec(){this.__data__=new Ft,this.size=0}function vc(w){var P=this.__data__,X=P.delete(w);return this.size=P.size,X}function Dc(w){return this.__data__.get(w)}function Sc(w){return this.__data__.has(w)}function xc(w,P){var X=this.__data__;if(X instanceof Ft){var se=X.__data__;if(!Me||se.length<r-1)return se.push([w,P]),this.size=++X.size,this;X=this.__data__=new Wt(se)}return X.set(w,P),this.size=X.size,this}jt.prototype.clear=Ec,jt.prototype.delete=vc,jt.prototype.get=Dc,jt.prototype.has=Sc,jt.prototype.set=xc;function Ic(w,P){var X=ei(w),se=!X&&zc(w),Re=!X&&!se&&Mi(w),we=!X&&!se&&!Re&&ss(w),$e=X||se||Re||we,Qe=$e?Fe(w.length,String):[],tt=Qe.length;for(var Le in w)(P||p.call(w,Le))&&!($e&&(Le=="length"||Re&&(Le=="offset"||Le=="parent")||we&&(Le=="buffer"||Le=="byteLength"||Le=="byteOffset")||Lc(Le,tt)))&&Qe.push(Le);return Qe}function Zr(w,P){for(var X=w.length;X--;)if(ts(w[X][0],P))return X;return-1}function Oc(w,P,X){var se=P(w);return ei(w)?se:_e(se,X(w))}function vr(w){return w==null?w===void 0?K:Z:pt&&pt in Object(w)?Pc(w):jc(w)}function Xn(w){return Dr(w)&&vr(w)==o}function Zn(w,P,X,se,Re){return w===P?!0:w==null||P==null||!Dr(w)&&!Dr(P)?w!==w&&P!==P:Ac(w,P,X,se,Zn,Re)}function Ac(w,P,X,se,Re,we){var $e=ei(w),Qe=ei(P),tt=$e?f:zt(w),Le=Qe?f:zt(P);tt=tt==o?A:tt,Le=Le==o?A:Le;var gt=tt==A,xt=Le==A,ot=tt==Le;if(ot&&Mi(w)){if(!Mi(P))return!1;$e=!0,gt=!1}if(ot&&!gt)return we||(we=new jt),$e||ss(w)?Qn(w,P,X,se,Re,we):Rc(w,P,tt,X,se,Re,we);if(!(X&n)){var mt=gt&&p.call(w,"__wrapped__"),_t=xt&&p.call(P,"__wrapped__");if(mt||_t){var Kt=mt?w.value():w,Lt=_t?P.value():P;return we||(we=new jt),Re(Kt,Lt,X,se,we)}}return ot?(we||(we=new jt),Uc(w,P,X,se,Re,we)):!1}function Tc(w){if(!ns(w)||Bc(w))return!1;var P=rs(w)?j:Q;return P.test(Gt(w))}function Cc(w){return Dr(w)&&is(w.length)&&!!ne[vr(w)]}function Nc(w){if(!$c(w))return Jr(w);var P=[];for(var X in Object(w))p.call(w,X)&&X!="constructor"&&P.push(X);return P}function Qn(w,P,X,se,Re,we){var $e=X&n,Qe=w.length,tt=P.length;if(Qe!=tt&&!($e&&tt>Qe))return!1;var Le=we.get(w);if(Le&&we.get(P))return Le==P;var gt=-1,xt=!0,ot=X&u?new Xr:void 0;for(we.set(w,P),we.set(P,w);++gt<Qe;){var mt=w[gt],_t=P[gt];if(se)var Kt=$e?se(_t,mt,gt,P,w,we):se(mt,_t,gt,w,P,we);if(Kt!==void 0){if(Kt)continue;xt=!1;break}if(ot){if(!xe(P,function(Lt,Yt){if(!Ee(ot,Yt)&&(mt===Lt||Re(mt,Lt,X,se,we)))return ot.push(Yt)})){xt=!1;break}}else if(!(mt===_t||Re(mt,_t,X,se,we))){xt=!1;break}}return we.delete(w),we.delete(P),xt}function Rc(w,P,X,se,Re,we,$e){switch(X){case B:if(w.byteLength!=P.byteLength||w.byteOffset!=P.byteOffset)return!1;w=w.buffer,P=P.buffer;case N:return!(w.byteLength!=P.byteLength||!we(new ve(w),new ve(P)));case b:case I:case H:return ts(+w,+P);case $:return w.name==P.name&&w.message==P.message;case _:case a:return w==P+"";case q:var Qe=he;case S:var tt=se&n;if(Qe||(Qe=me),w.size!=P.size&&!tt)return!1;var Le=$e.get(w);if(Le)return Le==P;se|=u,$e.set(w,P);var gt=Qn(Qe(w),Qe(P),se,Re,we,$e);return $e.delete(w),gt;case y:if(qe)return qe.call(w)==qe.call(P)}return!1}function Uc(w,P,X,se,Re,we){var $e=X&n,Qe=es(w),tt=Qe.length,Le=es(P),gt=Le.length;if(tt!=gt&&!$e)return!1;for(var xt=tt;xt--;){var ot=Qe[xt];if(!($e?ot in P:p.call(P,ot)))return!1}var mt=we.get(w);if(mt&&we.get(P))return mt==P;var _t=!0;we.set(w,P),we.set(P,w);for(var Kt=$e;++xt<tt;){ot=Qe[xt];var Lt=w[ot],Yt=P[ot];if(se)var os=$e?se(Yt,Lt,ot,P,w,we):se(Lt,Yt,ot,w,P,we);if(!(os===void 0?Lt===Yt||Re(Lt,Yt,X,se,we):os)){_t=!1;break}Kt||(Kt=ot=="constructor")}if(_t&&!Kt){var ti=w.constructor,ri=P.constructor;ti!=ri&&"constructor"in w&&"constructor"in P&&!(typeof ti=="function"&&ti instanceof ti&&typeof ri=="function"&&ri instanceof ri)&&(_t=!1)}return we.delete(w),we.delete(P),_t}function es(w){return Oc(w,qc,Fc)}function Qr(w,P){var X=w.__data__;return Mc(P)?X[typeof P=="string"?"string":"hash"]:X.map}function cr(w,P){var X=be(w,P);return Tc(X)?X:void 0}function Pc(w){var P=p.call(w,pt),X=w[pt];try{w[pt]=void 0;var se=!0}catch{}var Re=F.call(w);return se&&(P?w[pt]=X:delete w[pt]),Re}var Fc=kt?function(w){return w==null?[]:(w=Object(w),Se(kt(w),function(P){return Ie.call(w,P)}))}:Vc,zt=vr;(je&&zt(new je(new ArrayBuffer(1)))!=B||Me&&zt(new Me)!=q||ze&&zt(ze.resolve())!=U||Ke&&zt(new Ke)!=S||He&&zt(new He)!=E)&&(zt=function(w){var P=vr(w),X=P==A?w.constructor:void 0,se=X?Gt(X):"";if(se)switch(se){case ke:return B;case We:return q;case Ge:return U;case Ye:return S;case Je:return E}return P});function Lc(w,P){return P=P??l,!!P&&(typeof w=="number"||ae.test(w))&&w>-1&&w%1==0&&w<P}function Mc(w){var P=typeof w;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?w!=="__proto__":w===null}function Bc(w){return!!D&&D in w}function $c(w){var P=w&&w.constructor,X=typeof P=="function"&&P.prototype||d;return w===X}function jc(w){return F.call(w)}function Gt(w){if(w!=null){try{return c.call(w)}catch{}try{return w+""}catch{}}return""}function ts(w,P){return w===P||w!==w&&P!==P}var zc=Xn(function(){return arguments}())?Xn:function(w){return Dr(w)&&p.call(w,"callee")&&!Ie.call(w,"callee")},ei=Array.isArray;function Kc(w){return w!=null&&is(w.length)&&!rs(w)}var Mi=Er||kc;function Hc(w,P){return Zn(w,P)}function rs(w){if(!ns(w))return!1;var P=vr(w);return P==O||P==C||P==g||P==m}function is(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=l}function ns(w){var P=typeof w;return w!=null&&(P=="object"||P=="function")}function Dr(w){return w!=null&&typeof w=="object"}var ss=fe?Ue(fe):Cc;function qc(w){return Kc(w)?Ic(w):Nc(w)}function Vc(){return[]}function kc(){return!1}e.exports=Hc})(Pd,_i);function Fd(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<e.length;n++){var u=e.charAt(n),l=u.charCodeAt(0);if(r[l]!==255)throw new TypeError(u+" is ambiguous");r[l]=n}var o=e.length,f=e.charAt(0),g=Math.log(o)/Math.log(256),b=Math.log(256)/Math.log(o);function I(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var q=0,H=0,Z=0,A=C.length;Z!==A&&C[Z]===0;)Z++,q++;for(var U=(A-Z)*b+1>>>0,m=new Uint8Array(U);Z!==A;){for(var _=C[Z],S=0,a=U-1;(_!==0||S<H)&&a!==-1;a--,S++)_+=256*m[a]>>>0,m[a]=_%o>>>0,_=_/o>>>0;if(_!==0)throw new Error("Non-zero carry");H=S,Z++}for(var y=U-H;y!==U&&m[y]===0;)y++;for(var K=f.repeat(q);y<U;++y)K+=e.charAt(m[y]);return K}function $(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var q=0;if(C[q]!==" "){for(var H=0,Z=0;C[q]===f;)H++,q++;for(var A=(C.length-q)*g+1>>>0,U=new Uint8Array(A);C[q];){var m=r[C.charCodeAt(q)];if(m===255)return;for(var _=0,S=A-1;(m!==0||_<Z)&&S!==-1;S--,_++)m+=o*U[S]>>>0,U[S]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");Z=_,q++}if(C[q]!==" "){for(var a=A-Z;a!==A&&U[a]===0;)a++;for(var y=new Uint8Array(H+(A-a)),K=H;a!==A;)y[K++]=U[a++];return y}}}function O(C){var q=$(C);if(q)return q;throw new Error(`Non-${t} character`)}return{encode:I,decodeUnsafe:$,decode:O}}var Ld=Fd,Md=Ld;const Ba=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Bd=e=>new TextEncoder().encode(e),$d=e=>new TextDecoder().decode(e);class jd{constructor(t,r,i){this.name=t,this.prefix=r,this.baseEncode=i}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class zd{constructor(t,r,i){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return $a(this,t)}}class Kd{constructor(t){this.decoders=t}or(t){return $a(this,t)}decode(t){const r=t[0],i=this.decoders[r];if(i)return i.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $a=(e,t)=>new Kd({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Hd{constructor(t,r,i,n){this.name=t,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new jd(t,r,i),this.decoder=new zd(t,r,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ui=({name:e,prefix:t,encode:r,decode:i})=>new Hd(e,t,r,i),Wr=({prefix:e,name:t,alphabet:r})=>{const{encode:i,decode:n}=Md(r,t);return Ui({prefix:e,name:t,encode:i,decode:u=>Ba(n(u))})},qd=(e,t,r,i)=>{const n={};for(let b=0;b<t.length;++b)n[t[b]]=b;let u=e.length;for(;e[u-1]==="=";)--u;const l=new Uint8Array(u*r/8|0);let o=0,f=0,g=0;for(let b=0;b<u;++b){const I=n[e[b]];if(I===void 0)throw new SyntaxError(`Non-${i} character`);f=f<<r|I,o+=r,o>=8&&(o-=8,l[g++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return l},Vd=(e,t,r)=>{const i=t[t.length-1]==="=",n=(1<<r)-1;let u="",l=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],l+=8;l>r;)l-=r,u+=t[n&o>>l];if(l&&(u+=t[n&o<<r-l]),i)for(;u.length*r&7;)u+="=";return u},st=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>Ui({prefix:t,name:e,encode(n){return Vd(n,i,r)},decode(n){return qd(n,i,r,e)}}),kd=Ui({prefix:"\0",name:"identity",encode:e=>$d(e),decode:e=>Bd(e)});var Wd=Object.freeze({__proto__:null,identity:kd});const Gd=st({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Yd=Object.freeze({__proto__:null,base2:Gd});const Jd=st({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Xd=Object.freeze({__proto__:null,base8:Jd});const Zd=Wr({prefix:"9",name:"base10",alphabet:"0123456789"});var Qd=Object.freeze({__proto__:null,base10:Zd});const ep=st({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tp=st({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var rp=Object.freeze({__proto__:null,base16:ep,base16upper:tp});const ip=st({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),np=st({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sp=st({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),op=st({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ap=st({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),cp=st({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),up=st({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hp=st({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),lp=st({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var fp=Object.freeze({__proto__:null,base32:ip,base32upper:np,base32pad:sp,base32padupper:op,base32hex:ap,base32hexupper:cp,base32hexpad:up,base32hexpadupper:hp,base32z:lp});const dp=Wr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pp=Wr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var gp=Object.freeze({__proto__:null,base36:dp,base36upper:pp});const yp=Wr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wp=Wr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var bp=Object.freeze({__proto__:null,base58btc:yp,base58flickr:wp});const mp=st({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_p=st({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ep=st({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vp=st({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Dp=Object.freeze({__proto__:null,base64:mp,base64pad:_p,base64url:Ep,base64urlpad:vp});const ja=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Sp=ja.reduce((e,t,r)=>(e[r]=t,e),[]),xp=ja.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function Ip(e){return e.reduce((t,r)=>(t+=Sp[r],t),"")}function Op(e){const t=[];for(const r of e){const i=xp[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(i)}return new Uint8Array(t)}const Ap=Ui({prefix:"🚀",name:"base256emoji",encode:Ip,decode:Op});var Tp=Object.freeze({__proto__:null,base256emoji:Ap}),Cp=za,so=128,Np=127,Rp=~Np,Up=Math.pow(2,31);function za(e,t,r){t=t||[],r=r||0;for(var i=r;e>=Up;)t[r++]=e&255|so,e/=128;for(;e&Rp;)t[r++]=e&255|so,e>>>=7;return t[r]=e|0,za.bytes=r-i+1,t}var Pp=_n,Fp=128,oo=127;function _n(e,i){var r=0,i=i||0,n=0,u=i,l,o=e.length;do{if(u>=o)throw _n.bytes=0,new RangeError("Could not decode varint");l=e[u++],r+=n<28?(l&oo)<<n:(l&oo)*Math.pow(2,n),n+=7}while(l>=Fp);return _n.bytes=u-i,r}var Lp=Math.pow(2,7),Mp=Math.pow(2,14),Bp=Math.pow(2,21),$p=Math.pow(2,28),jp=Math.pow(2,35),zp=Math.pow(2,42),Kp=Math.pow(2,49),Hp=Math.pow(2,56),qp=Math.pow(2,63),Vp=function(e){return e<Lp?1:e<Mp?2:e<Bp?3:e<$p?4:e<jp?5:e<zp?6:e<Kp?7:e<Hp?8:e<qp?9:10},kp={encode:Cp,decode:Pp,encodingLength:Vp},Ka=kp;const ao=(e,t,r=0)=>(Ka.encode(e,t,r),t),co=e=>Ka.encodingLength(e),En=(e,t)=>{const r=t.byteLength,i=co(e),n=i+co(r),u=new Uint8Array(n+r);return ao(e,u,0),ao(r,u,i),u.set(t,n),new Wp(e,r,t,u)};class Wp{constructor(t,r,i,n){this.code=t,this.size=r,this.digest=i,this.bytes=n}}const Ha=({name:e,code:t,encode:r})=>new Gp(e,t,r);class Gp{constructor(t,r,i){this.name=t,this.code=r,this.encode=i}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?En(this.code,r):r.then(i=>En(this.code,i))}else throw Error("Unknown type, must be binary type")}}const qa=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Yp=Ha({name:"sha2-256",code:18,encode:qa("SHA-256")}),Jp=Ha({name:"sha2-512",code:19,encode:qa("SHA-512")});var Xp=Object.freeze({__proto__:null,sha256:Yp,sha512:Jp});const Va=0,Zp="identity",ka=Ba,Qp=e=>En(Va,ka(e)),e0={code:Va,name:Zp,encode:ka,digest:Qp};var t0=Object.freeze({__proto__:null,identity:e0});new TextEncoder,new TextDecoder;const uo={...Wd,...Yd,...Xd,...Qd,...rp,...fp,...gp,...bp,...Dp,...Tp};({...Xp,...t0});function r0(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Wa(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const ho=Wa("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Zi=Wa("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=r0(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),i0={utf8:ho,"utf-8":ho,hex:uo.base16,latin1:Zi,ascii:Zi,binary:Zi,...uo};function n0(e,t="utf8"){const r=i0[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}const Ga="wc",s0=2,Hn="core",qt=`${Ga}@${2}:${Hn}:`,o0={name:Hn,logger:"error"},a0={database:":memory:"},c0="crypto",lo="client_ed25519_seed",u0=ce.ONE_DAY,h0="keychain",l0="0.3",f0="messages",d0="0.3",p0=ce.SIX_HOURS,g0="publisher",Ya="irn",y0="error",Ja="wss://relay.walletconnect.com",w0="relayer",rt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},b0="_subscription",ni={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},fo=ce.ONE_SECOND,m0="2.4.3",_0="0.3",Rt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},E0="subscription",v0="0.3",D0=ce.FIVE_SECONDS*1e3,S0="pairing",x0="0.3",Cr={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},Nt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},I0="history",O0="0.3",A0="expirer",vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},T0="0.3";let C0=class{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=h0,this.version=l0,this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:u}=Ne("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(u)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=t,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Ta(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Ca(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}};class N0{constructor(t,r,i){this.core=t,this.logger=r,this.name=c0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),u=Ps(n);return fa(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=xf();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const u=await this.getClientSeed(),l=Ps(u),o=wn();return await Rl(o,n,u0,l)},this.generateSharedKey=(n,u,l)=>{this.isInitialized();const o=this.getPrivateKey(n),f=If(o,u);return this.setSymKey(f,l)},this.setSymKey=async(n,u)=>{this.isInitialized();const l=u||Of(n);return await this.keychain.set(l,n),l},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,u,l)=>{this.isInitialized();const o=Oa(l),f=xn(u);if(Ws(o)){const $=o.senderPublicKey,O=o.receiverPublicKey;n=await this.generateSharedKey($,O)}const g=this.getSymKey(n),{type:b,senderPublicKey:I}=o;return Tf({type:b,symKey:g,message:f,senderPublicKey:I})},this.decode=async(n,u,l)=>{this.isInitialized();const o=Rf(u,l);if(Ws(o)){const b=o.receiverPublicKey,I=o.senderPublicKey;n=await this.generateSharedKey(b,I)}const f=this.getSymKey(n),g=Cf({symKey:f,encoded:u});return Xo(g)},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=i||new C0(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}getPayloadType(t){const r=Mn(t);return kr(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(lo)}catch{t=wn(),await this.keychain.set(lo,t)}return n0(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}let R0=class extends $u{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=f0,this.version=d0,this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const u=bi(n);let l=this.messages.get(i);return typeof l>"u"&&(l={}),typeof l[u]<"u"||(l[u]=n,this.messages.set(i,l),await this.persist()),u},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const u=this.get(i),l=bi(n);return typeof u[l]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Ae.generateChildLogger(t,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Ta(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Ca(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}};class U0 extends ju{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new lt.EventEmitter,this.name=g0,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,n,u)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:u}});try{const l=(u==null?void 0:u.ttl)||p0,o=bn(u),f=(u==null?void 0:u.prompt)||!1,g=(u==null?void 0:u.tag)||0,b={topic:i,message:n,opts:{ttl:l,relay:o,prompt:f,tag:g}},I=bi(n);this.queue.set(I,b);try{await await Na(this.rpcPublish(i,n,l,o,f,g),this.publishTimeout),this.relayer.events.emit(rt.publish,b)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(rt.connection_stalled);return}this.onPublish(I,b),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:u}})}catch(l){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(l),l}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(t,r,i,n,u,l){var o,f,g,b;const I={method:mn(n.protocol).publish,params:{topic:t,message:r,ttl:i,prompt:u,tag:l}};return mi((o=I.params)==null?void 0:o.prompt)&&((f=I.params)==null||delete f.prompt),mi((g=I.params)==null?void 0:g.tag)&&((b=I.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.provider.request(I)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:i,opts:n}=t;await this.publish(r,i,n)})}registerEventListeners(){this.relayer.core.heartbeat.on(Hr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class P0{constructor(){this.map=new Map,this.set=(t,r)=>{const i=this.get(t);this.exists(t,r)||this.map.set(t,[...i,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const i=this.get(t);if(!this.exists(t,r))return;const n=i.filter(u=>u!==r);if(!n.length){this.map.delete(t);return}this.map.set(t,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var F0=Object.defineProperty,L0=Object.defineProperties,M0=Object.getOwnPropertyDescriptors,po=Object.getOwnPropertySymbols,B0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,go=(e,t,r)=>t in e?F0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,si=(e,t)=>{for(var r in t||(t={}))B0.call(t,r)&&go(e,r,t[r]);if(po)for(var r of po(t))$0.call(t,r)&&go(e,r,t[r]);return e},Qi=(e,t)=>L0(e,M0(t));class j0 extends Hu{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new P0,this.events=new lt.EventEmitter,this.name=E0,this.version=v0,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=qt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const u=bn(n),l={topic:i,relay:u};this.pending.set(i,l);const o=await this.rpcSubscribe(i,u);return this.onSubscribe(o,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),o}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,u)=>{const l=new ce.Watch;l.start(this.pendingSubscriptionWatchLabel);const o=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),n(!0)),l.elapsed(this.pendingSubscriptionWatchLabel)>=D0&&(clearInterval(o),l.stop(this.pendingSubscriptionWatchLabel),u(!1))},this.pollingInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ae.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let i=!1;try{i=this.getSubscription(t).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const i=this.topicMap.get(t);await Promise.all(i.map(async n=>await this.unsubscribeById(t,n,r)))}async unsubscribeById(t,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:i}});try{const n=bn(i);await this.rpcUnsubscribe(t,r,n);const u=Lr("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(t,r){const i={method:mn(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await Na(this.relayer.provider.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(rt.connection_stalled)}return bi(t+this.clientId)}rpcUnsubscribe(t,r,i){const n={method:mn(i.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(t,r){this.setSubscription(t,Qi(si({},r),{id:t})),this.pending.delete(r.topic)}onResubscribe(t,r){this.addSubscription(t,Qi(si({},r),{id:t})),this.pending.delete(r.topic)}async onUnsubscribe(t,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,i),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,si({},r)),this.topicMap.set(r.topic,t),this.events.emit(Rt.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const i=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(i.topic,t),this.events.emit(Rt.deleted,Qi(si({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Rt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async t=>await this.resubscribe(t))),this.events.emit(Rt.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:r,relay:i}=t,n={topic:r,relay:i};this.pending.set(n.topic,n);const u=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(u,n)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async t=>{const r=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(r,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(Hr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(rt.connect,async()=>{await this.onConnect()}),this.relayer.on(rt.disconnect,()=>{this.onDisconnect()}),this.events.on(Rt.created,async t=>{const r=Rt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Rt.deleted,async t=>{const r=Rt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var z0=Object.defineProperty,yo=Object.getOwnPropertySymbols,K0=Object.prototype.hasOwnProperty,H0=Object.prototype.propertyIsEnumerable,wo=(e,t,r)=>t in e?z0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,q0=(e,t)=>{for(var r in t||(t={}))K0.call(t,r)&&wo(e,r,t[r]);if(yo)for(var r of yo(t))H0.call(t,r)&&wo(e,r,t[r]);return e};let V0=class extends zu{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new lt.EventEmitter,this.name=w0,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ae.generateChildLogger(t.logger,this.name):vi(Ae.getDefaultLoggerOptions({level:t.logger||y0})),this.messages=new R0(this.logger,t.core),this.subscriber=new j0(this,this.logger),this.publisher=new U0(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Ja,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,i){this.isInitialized(),await this.publisher.publish(t,r,i),await this.recordMessageEvent({topic:t,message:r})}async subscribe(t,r){this.isInitialized();let i="";return await Promise.all([new Promise(n=>{this.subscriber.once(Rt.created,u=>{u.topic===t&&n()})}),new Promise(async n=>{i=await this.subscriber.subscribe(t,r),n()})]),i}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(rt.transport_closed))}async transportOpen(t){if(!this.reconnecting){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Rt.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(rt.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(rt.transport_closed,this.rejectTransportOpen))])])}catch(r){const i=r;if(!/socket hang up/i.test(i.message))throw r;this.logger.error(r),this.events.emit(rt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,fo)),await this.transportOpen(t))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new Td(new Ud(Vf({sdkVersion:m0,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:i}=t;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(t){const{topic:r,message:i}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),zn(t)){if(!t.method.endsWith(b0))return;const r=t.params,{topic:i,message:n}=r.data,u={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(q0({type:"event",event:r.id},u)),this.events.emit(r.id,u),await this.acknowledgePayload(t),await this.onMessageEvent(u)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(rt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=$n(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(ni.payload,t=>this.onProviderPayload(t)),this.provider.on(ni.connect,()=>{this.events.emit(rt.connect)}),this.provider.on(ni.disconnect,()=>{this.events.emit(rt.disconnect),this.attemptToReconnect()}),this.provider.on(ni.error,t=>this.events.emit(rt.error,t)),this.events.on(rt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},ce.toMiliseconds(fo))}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}};var k0=Object.defineProperty,bo=Object.getOwnPropertySymbols,W0=Object.prototype.hasOwnProperty,G0=Object.prototype.propertyIsEnumerable,mo=(e,t,r)=>t in e?k0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_o=(e,t)=>{for(var r in t||(t={}))W0.call(t,r)&&mo(e,r,t[r]);if(bo)for(var r of bo(t))G0.call(t,r)&&mo(e,r,t[r]);return e};class Pi extends Ku{constructor(t,r,i,n=qt,u=void 0){super(t,r,i,n),this.core=t,this.logger=r,this.name=i,this.map=new Map,this.version=_0,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(l=>{cd(l)?this.map.set(l.id,l):ud(l)?this.map.set(l.topic,l):this.getKey&&l!==null&&!mi(l)&&this.map.set(this.getKey(l),l)}),this.cached=[],this.initialized=!0)},this.set=async(l,o)=>{this.isInitialized(),this.map.has(l)?await this.update(l,o):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:l,value:o}),this.map.set(l,o),await this.persist())},this.get=l=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:l}),this.getData(l)),this.getAll=l=>(this.isInitialized(),l?this.values.filter(o=>Object.keys(l).every(f=>_i(o[f],l[f]))):this.values),this.update=async(l,o)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:l,update:o});const f=_o(_o({},this.getData(l)),o);this.map.set(l,f),await this.persist()},this.delete=async(l,o)=>{this.isInitialized(),this.map.has(l)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:l,reason:o}),this.map.delete(l),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=n,this.getKey=u}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Y0{constructor(t,r){this.core=t,this.logger=r,this.name=S0,this.version=x0,this.events=new lt,this.initialized=!1,this.storagePrefix=qt,this.ignoredPayloadTypes=[_r],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=wn(),n=await this.core.crypto.setSymKey(i),u=Yi(ce.FIVE_MINUTES),l={protocol:Ya},o={topic:n,expiry:u,relay:l,active:!1},f=nd({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:i,relay:l});return await this.pairings.set(n,o),await this.core.relayer.subscribe(n),this.core.expirer.set(n,u),{topic:n,uri:f}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:n,symKey:u,relay:l}=rd(i.uri),o=Yi(ce.FIVE_MINUTES),f={topic:n,relay:l,expiry:o,active:!1};return await this.pairings.set(n,f),await this.core.crypto.setSymKey(u,n),await this.core.relayer.subscribe(n,{relay:l}),this.core.expirer.set(n,o),i.activatePairing&&await this.activate({topic:n}),f},this.activate=async({topic:i})=>{this.isInitialized();const n=Yi(ce.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:n}),this.core.expirer.set(i,n)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.pairings.keys.includes(n)){const u=await this.sendRequest(n,"wc_pairingPing",{}),{done:l,resolve:o,reject:f}=kf();this.events.once(Ji("pairing_ping",u),({error:g})=>{g?f(g):o()}),await l()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Lr("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(i,n,u)=>{const l=Ri(n,u),o=await this.core.crypto.encode(i,l),f=Cr[n].req;return this.core.history.set(i,l),await this.core.relayer.publish(i,o,f),l.id},this.sendResult=async(i,n,u)=>{const l=$n(i,u),o=await this.core.crypto.encode(n,l),f=await this.core.history.get(n,i),g=Cr[f.request.method].res;await this.core.relayer.publish(n,o,g),await this.core.history.resolve(l)},this.sendError=async(i,n,u)=>{const l=jn(i,u),o=await this.core.crypto.encode(n,l),f=await this.core.history.get(n,i),g=Cr[f.request.method]?Cr[f.request.method].res:Cr.unregistered_method.res;await this.core.relayer.publish(n,o,g),await this.core.history.resolve(l)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Lr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Xs(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:u}=i,l=u.method;if(this.pairings.keys.includes(n))switch(l){case"wc_pairingPing":return this.onPairingPingRequest(n,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,u);default:return this.onUnknownRpcMethodRequest(n,u)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:u}=i,l=(await this.core.history.get(n,u.id)).request.method;if(this.pairings.keys.includes(n))switch(l){case"wc_pairingPing":return this.onPairingPingResponse(n,u);default:return this.onUnknownRpcMethodResponse(l)}},this.onPairingPingRequest=async(i,n)=>{const{id:u}=n;try{this.isValidPing({topic:i}),await this.sendResult(u,i,!0),this.events.emit("pairing_ping",{id:u,topic:i})}catch(l){await this.sendError(u,i,l),this.logger.error(l)}},this.onPairingPingResponse=(i,n)=>{const{id:u}=n;setTimeout(()=>{$t(n)?this.events.emit(Ji("pairing_ping",u),{}):Ot(n)&&this.events.emit(Ji("pairing_ping",u),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:u}=n;try{this.isValidDisconnect({topic:i}),await this.sendResult(u,i,!0),await this.deletePairing(i),this.events.emit("pairing_delete",{id:u,topic:i})}catch(l){await this.sendError(u,i,l),this.logger.error(l)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:u,method:l}=n;try{if(this.registeredMethods.includes(l))return;const o=Lr("WC_METHOD_UNSUPPORTED",l);await this.sendError(u,i,o),this.logger.error(o)}catch(o){await this.sendError(u,i,o),this.logger.error(o)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Lr("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!Xi(i)){const{message:n}=Ne("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(n)}if(!ad(i.uri)){const{message:n}=Ne("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(n)}},this.isValidPing=async i=>{if(!Xi(i)){const{message:u}=Ne("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(u)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!Xi(i)){const{message:u}=Ne("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(u)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!Ua(i,!1)){const{message:n}=Ne("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=Ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Xs(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=Ne("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=t,this.logger=Ae.generateChildLogger(r,this.name),this.pairings=new Pi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(rt.message,async t=>{const{topic:r,message:i}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const n=await this.core.crypto.decode(r,i);zn(n)?(this.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Kn(n)&&(await this.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.core.expirer.on(vt.expired,async t=>{const{topic:r}=Yf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class J0 extends Bu{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new lt.EventEmitter,this.name=I0,this.version=O0,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:u}),this.records.has(n.id))return;const l={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:u};this.records.set(l.id,l),this.events.emit(Nt.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Ot(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(Nt.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(u=>{if(u.topic===i){if(typeof n<"u"&&u.id!==n)return;this.records.delete(u.id),this.events.emit(Nt.deleted,u)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Ri(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(i)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Nt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Nt.created,t=>{const r=Nt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Nt.updated,t=>{const r=Nt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Nt.deleted,t=>{const r=Nt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class X0 extends qu{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new lt.EventEmitter,this.name=A0,this.version=T0,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const u=this.formatTarget(i),l={target:u,expiry:n};this.expirations.set(u,l),this.checkExpiry(u,l),this.events.emit(vt.created,{target:u,expiration:l})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),u=this.getExpiration(n);this.expirations.delete(n),this.events.emit(vt.deleted,{target:n,expiration:u})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Wf(t);if(typeof t=="number")return Gf(t);const{message:r}=Ne("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:i}=Ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(t,r){const{expiry:i}=r;ce.toMiliseconds(i)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(vt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Hr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vt.created,t=>{const r=vt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(vt.expired,t=>{const r=vt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(vt.deleted,t=>{const r=vt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Z0=Object.defineProperty,Eo=Object.getOwnPropertySymbols,Q0=Object.prototype.hasOwnProperty,eg=Object.prototype.propertyIsEnumerable,vo=(e,t,r)=>t in e?Z0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Do=(e,t)=>{for(var r in t||(t={}))Q0.call(t,r)&&vo(e,r,t[r]);if(Eo)for(var r of Eo(t))eg.call(t,r)&&vo(e,r,t[r]);return e};class qn extends Mu{constructor(t){super(t),this.protocol=Ga,this.version=s0,this.name=Hn,this.events=new lt.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Ja;const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:vi(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||o0.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new Hr.HeartBeat,this.crypto=new N0(this,this.logger,t==null?void 0:t.keychain),this.history=new J0(this,this.logger),this.expirer=new X0(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new vu(Do(Do({},a0),t==null?void 0:t.storageOptions)),this.relayer=new V0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Y0(this,this.logger)}static async init(t){const r=new qn(t);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const tg=qn;let rg=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},ig=class{constructor(t){this.client=t}};function Vn(e,t){return e.includes(":")?[e]:t.chains||[]}const ng=1;function sg(){return Da()||{name:"",description:"",url:"",icons:[""]}}function Ht(e,t){return e.filter(r=>t.includes(r)).length===e.length}function fr(e){const t=ce.toMiliseconds(e||ce.FIVE_MINUTES);let r,i,n;return{resolve:u=>{n&&r&&(clearTimeout(n),r(u))},reject:u=>{n&&i&&(clearTimeout(n),i(u))},done:()=>new Promise((u,l)=>{n=setTimeout(l,t),r=u,i=l})}}function og(e){const[t,r]=e.split(":"),i={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")i.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function er(e,t){return ce.fromMiliseconds((t||Date.now())+ce.toMiliseconds(e))}function dr(e){return Date.now()>=ce.toMiliseconds(e)}function et(e,t){return`${e}${t?`:${t}`:""}`}function Gr(e){const t=[];return e.forEach(r=>{const[i,n]=r.split(":");t.push(`${i}:${n}`)}),t}function ag(e){const t=[];return Object.values(e).forEach(r=>{t.push(...Gr(r.accounts))}),t}function cg(e,t){const r=[];return Object.values(e).forEach(i=>{Gr(i.accounts).includes(t)&&r.push(...i.methods)}),r}function ug(e,t){const r=[];return Object.values(e).forEach(i=>{Gr(i.accounts).includes(t)&&r.push(...i.events)}),r}function hg(e,t){const r=li(e,t);if(r)throw new Error(r.message);const i={};for(const[n,u]of Object.entries(e))i[n]={methods:u.methods,events:u.events,chains:u.accounts.map(l=>`${l.split(":")[0]}:${l.split(":")[1]}`)};return i}const lg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},fg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function le(e,t){const{message:r,code:i}=fg[e];return{message:t?`${r} ${t}`:r,code:i}}function wt(e,t){const{message:r,code:i}=lg[e];return{message:t?`${r} ${t}`:r,code:i}}function Fi(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function Br(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function St(e){return typeof e>"u"}function ct(e,t){return t&&St(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function kn(e,t){return t&&St(e)?!0:typeof e=="number"&&!isNaN(e)}function dg(e,t){const{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),n=Object.keys(r);let u=!0;return Ht(n,i)?(i.forEach(l=>{const{accounts:o,methods:f,events:g}=e.namespaces[l],b=Gr(o),I=r[l];(!Ht(Vn(l,I),b)||!Ht(I.methods,f)||!Ht(I.events,g))&&(u=!1)}),u):!1}function Wn(e){return ct(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function pg(e){if(ct(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Wn(r)}}return!1}function gg(e,t){let r=null;return ct(e==null?void 0:e.publicKey,!1)||(r=le("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function So(e){let t=!0;return Fi(e)?e.length&&(t=e.every(r=>ct(r,!1))):t=!1,t}function yg(e,t,r){let i=null;return Fi(t)?t.forEach(n=>{i||(!Wn(n)||!n.includes(e))&&(i=wt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=wt("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),i}function wg(e,t){let r=null;return Object.entries(e).forEach(([i,n])=>{if(r)return;const u=yg(i,Vn(i,n),`${t} requiredNamespace`);u&&(r=u)}),r}function bg(e,t){let r=null;return Fi(e)?e.forEach(i=>{r||pg(i)||(r=wt("UNSUPPORTED_ACCOUNTS",`${t}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=wt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function mg(e,t){let r=null;return Object.values(e).forEach(i=>{if(r)return;const n=bg(i==null?void 0:i.accounts,`${t} namespace`);n&&(r=n)}),r}function _g(e,t){let r=null;return So(e==null?void 0:e.methods)?So(e==null?void 0:e.events)||(r=wt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=wt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Xa(e,t){let r=null;return Object.values(e).forEach(i=>{if(r)return;const n=_g(i,`${t}, namespace`);n&&(r=n)}),r}function Eg(e,t,r){let i=null;if(e&&Br(e)){const n=Xa(e,t);n&&(i=n);const u=wg(e,t);u&&(i=u)}else i=le("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}function li(e,t){let r=null;if(e&&Br(e)){const i=Xa(e,t);i&&(r=i);const n=mg(e,t);n&&(r=n)}else r=le("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Za(e){return ct(e.protocol,!0)}function vg(e,t){let r=!1;return t&&!e?r=!0:e&&Fi(e)&&e.length&&e.forEach(i=>{r=Za(i)}),r}function Dg(e){return typeof e=="number"}function It(e){return typeof e<"u"&&typeof e!==null}function Sg(e){return!(!e||typeof e!="object"||!e.code||!kn(e.code,!1)||!e.message||!ct(e.message,!1))}function xg(e){return!(St(e)||!ct(e.method,!1))}function Ig(e){return!(St(e)||St(e.result)&&St(e.error)||!kn(e.id,!1)||!ct(e.jsonrpc,!1))}function Og(e){return!(St(e)||!ct(e.name,!1))}function xo(e,t){return!(!Wn(t)||!ag(e).includes(t))}function Ag(e,t,r){return ct(r,!1)?cg(e,t).includes(r):!1}function Tg(e,t,r){return ct(r,!1)?ug(e,t).includes(r):!1}function en(e,t,r,i){let n=null;const u=Object.keys(e),l=Object.keys(t);return Ht(u,l)?u.forEach(o=>{if(n)return;const f=Gr(t[o].accounts);Ht(Vn(o,e[o]),f)?Ht(e[o].methods,t[o].methods)?Ht(e[o].events,t[o].events)||(n=le("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${o}`)):n=le("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${o}`):n=le("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace chains for ${o}`)}):n=le("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy ${i}`),n}function Cg(e,t){return kn(e,!1)&&e<=t.max&&e>=t.min}const Qa="wc",ec=2,tc="client",Gn=`${Qa}@${ec}:${tc}:`,tn={name:tc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ng="proposal",Rg="session",oi=ce.SEVEN_DAYS,Ug="engine",Nr={wc_sessionPropose:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1115}}},rn={min:ce.FIVE_MINUTES,max:ce.SEVEN_DAYS},Pg="request";var Fg=Object.defineProperty,Lg=Object.defineProperties,Mg=Object.getOwnPropertyDescriptors,Io=Object.getOwnPropertySymbols,Bg=Object.prototype.hasOwnProperty,$g=Object.prototype.propertyIsEnumerable,Oo=(e,t,r)=>t in e?Fg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Et=(e,t)=>{for(var r in t||(t={}))Bg.call(t,r)&&Oo(e,r,t[r]);if(Io)for(var r of Io(t))$g.call(t,r)&&Oo(e,r,t[r]);return e},nn=(e,t)=>Lg(e,Mg(t));class jg extends ig{constructor(t){super(t),this.name=Ug,this.events=new lt,this.initialized=!1,this.ignoredPayloadTypes=[ng],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Nr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const i=nn(Et({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:u,optionalNamespaces:l,sessionProperties:o,relays:f}=i;let g=n,b,I=!1;if(g&&(I=this.client.core.pairing.pairings.get(g).active),!g||!I){const{topic:U,uri:m}=await this.client.core.pairing.create();g=U,b=m}const $=await this.client.core.crypto.generateKeyPair(),O=Et({requiredNamespaces:u,optionalNamespaces:l,relays:f??[{protocol:Ya}],proposer:{publicKey:$,metadata:this.client.metadata}},o&&{sessionProperties:o}),{reject:C,resolve:q,done:H}=fr();if(this.events.once(et("session_connect"),async({error:U,session:m})=>{if(U)C(U);else if(m){m.self.publicKey=$;const _=nn(Et({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,_),await this.setExpiry(m.topic,m.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:m.peer.metadata}),q(_)}}),!g){const{message:U}=le("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(U)}const Z=await this.sendRequest(g,"wc_sessionPropose",O),A=er(ce.FIVE_MINUTES);return await this.setProposal(Z,Et({id:Z,expiry:A},O)),{uri:b,approval:H}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:u,sessionProperties:l}=r,o=this.client.proposal.get(i);let{pairingTopic:f,proposer:g,requiredNamespaces:b,optionalNamespaces:I}=o;Br(b)||(b=hg(u,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),O=g.publicKey,C=await this.client.core.crypto.generateSharedKey($,O);f&&i&&(await this.client.core.pairing.updateMetadata({topic:f,metadata:g.metadata}),await this.sendResult(i,f,{relay:{protocol:n??"irn"},responderPublicKey:$}),await this.client.proposal.delete(i,wt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:f}));const q=Et({relay:{protocol:n??"irn"},namespaces:u,requiredNamespaces:b,optionalNamespaces:I,controller:{publicKey:$,metadata:this.client.metadata},expiry:er(oi)},l&&{sessionProperties:l});await this.client.core.relayer.subscribe(C);const H=await this.sendRequest(C,"wc_sessionSettle",q),{done:Z,resolve:A,reject:U}=fr();this.events.once(et("session_approve",H),({error:_})=>{_?U(_):A(this.client.session.get(C))});const m=nn(Et({},q),{topic:C,acknowledged:!1,self:q.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:$});return await this.client.session.set(C,m),await this.setExpiry(C,er(oi)),{topic:C,acknowledged:Z}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:u}=this.client.proposal.get(i);u&&(await this.sendError(i,u,n),await this.client.proposal.delete(i,wt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,u=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:l,resolve:o,reject:f}=fr();return this.events.once(et("session_update",u),({error:g})=>{g?f(g):o()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:l}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:u,resolve:l,reject:o}=fr();return this.events.once(et("session_extend",n),({error:f})=>{f?o(f):l()}),await this.setExpiry(i,er(oi)),{acknowledged:u}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:u,expiry:l}=r,o=await this.sendRequest(u,"wc_sessionRequest",{request:n,chainId:i},l),{done:f,resolve:g,reject:b}=fr(l);return this.events.once(et("session_request",o),({error:I,result:$})=>{I?b(I):g($)}),this.client.events.emit("session_request_sent",{topic:u,request:n,chainId:i}),await f()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:u}=n;$t(n)?await this.sendResult(u,i,n.result):Ot(n)&&await this.sendError(u,i,n.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:u,resolve:l,reject:o}=fr();this.events.once(et("session_ping",n),({error:f})=>{f?o(f):l()}),await u()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:u}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:u})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",wt("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>dg(i,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,i)=>{const{self:n}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,wt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(n.publicKey),this.client.core.crypto.deleteSymKey(r),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,i)=>{await Promise.all([this.client.proposal.delete(r,wt("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.core.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.core.expirer.set(r,i.expiry)},this.setPendingSessionRequest=async r=>{const i=Nr.wc_sessionRequest.req.ttl,{id:n,topic:u,params:l}=r;await this.client.pendingRequest.set(n,{id:n,topic:u,params:l}),i&&this.client.core.expirer.set(n,er(i))},this.sendRequest=async(r,i,n,u)=>{const l=Ri(i,n),o=await this.client.core.crypto.encode(r,l),f=Nr[i].req;return u&&(f.ttl=u),this.client.core.history.set(r,l),this.client.core.relayer.publish(r,o,f),l.id},this.sendResult=async(r,i,n)=>{const u=$n(r,n),l=await this.client.core.crypto.encode(i,u),o=await this.client.core.history.get(i,r),f=Nr[o.request.method].res;this.client.core.relayer.publish(i,l,f),await this.client.core.history.resolve(u)},this.sendError=async(r,i,n)=>{const u=jn(r,n),l=await this.client.core.crypto.encode(i,u),o=await this.client.core.history.get(i,r),f=Nr[o.request.method].res;this.client.core.relayer.publish(i,l,f),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{dr(n.expiry)&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{dr(n.expiry)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession(n)),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,u=n.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,u=(await this.client.core.history.get(i,n.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:u}=i;try{this.isValidConnect(Et({},i.params));const l=er(ce.FIVE_MINUTES),o=Et({id:u,pairingTopic:r,expiry:l},n);await this.setProposal(u,o),this.client.events.emit("session_proposal",{id:u,params:o})}catch(l){await this.sendError(u,r,l),this.client.logger.error(l)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if($t(i)){const{result:u}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const l=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:l});const o=l.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});const f=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const g=await this.client.core.crypto.generateSharedKey(o,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const b=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else Ot(i)&&(await this.client.proposal.delete(n,wt("USER_DISCONNECTED")),this.events.emit(et("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:u}=i;try{this.isValidSessionSettleRequest(u);const{relay:l,controller:o,expiry:f,namespaces:g,requiredNamespaces:b,optionalNamespaces:I,sessionProperties:$}=i.params,O=Et({topic:r,relay:l,expiry:f,namespaces:g,acknowledged:!0,requiredNamespaces:b,optionalNamespaces:I,controller:o.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:o.publicKey,metadata:o.metadata}},$&&{sessionProperties:$});await this.sendResult(i.id,r,!0),this.events.emit(et("session_connect"),{session:O})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;$t(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(et("session_approve",n),{})):Ot(i)&&(await this.client.session.delete(r,wt("USER_DISCONNECTED")),this.events.emit(et("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:u}=i;try{this.isValidUpdate(Et({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(u,r,!0),this.client.events.emit("session_update",{id:u,topic:r,params:n})}catch(l){await this.sendError(u,r,l),this.client.logger.error(l)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;$t(i)?this.events.emit(et("session_update",n),{}):Ot(i)&&this.events.emit(et("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,er(oi)),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;$t(i)?this.events.emit(et("session_extend",n),{}):Ot(i)&&this.events.emit(et("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;setTimeout(()=>{$t(i)?this.events.emit(et("session_ping",n),{}):Ot(i)&&this.events.emit(et("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),this.client.core.relayer.once(rt.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(n,r,!0),this.client.events.emit("session_delete",{id:n,topic:r})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:u}=i;try{this.isValidRequest(Et({topic:r},u)),await this.setPendingSessionRequest({id:n,topic:r,params:u}),this.client.events.emit("session_request",{id:n,topic:r,params:u})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;$t(i)?this.events.emit(et("session_request",n),{result:i.result}):Ot(i)&&this.events.emit(et("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:u}=i;try{this.isValidEmit(Et({topic:r},u)),this.client.events.emit("session_event",{id:n,topic:r,params:u})}catch(l){await this.sendError(n,r,l),this.client.logger.error(l)}},this.isValidConnect=async r=>{if(!It(r)){const{message:f}=le("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(f)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:u,sessionProperties:l,relays:o}=r;if(St(i)||await this.isValidPairingTopic(i),!vg(o,!0)){const{message:f}=le("MISSING_OR_INVALID",`connect() relays: ${o}`);throw new Error(f)}!St(n)&&Br(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!St(u)&&Br(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),St(l)||this.validateSessionProps(l,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=Eg(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!It(r))throw new Error(le("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:u,sessionProperties:l}=r;await this.isValidProposalId(i);const o=this.client.proposal.get(i),f=li(n,"approve()");if(f)throw new Error(f.message);const g=en(o.requiredNamespaces,n,"approve()","requiredNamespaces");if(g)throw new Error(g.message);if(!ct(u,!0)){const{message:b}=le("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(b)}if(Object.keys(n).length>Object.keys(o.requiredNamespaces).length){const b=Object.keys(o.optionalNamespaces).filter(O=>n[O]),I={};for(const O in o.optionalNamespaces)b.includes(O)&&(I[O]=o.optionalNamespaces[O]);const $=en(I,n,"approve()","optionalNamespaces");if($)throw new Error($.message)}St(l)||this.validateSessionProps(l,"sessionProperties")},this.isValidReject=async r=>{if(!It(r)){const{message:u}=le("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Sg(n)){const{message:u}=le("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!It(r)){const{message:g}=le("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(g)}const{relay:i,controller:n,namespaces:u,expiry:l}=r;if(!Za(i)){const{message:g}=le("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const o=gg(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);const f=li(u,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(dr(l)){const{message:g}=le("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async r=>{if(!It(r)){const{message:f}=le("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const u=this.client.session.get(i),l=li(n,"update()");if(l)throw new Error(l.message);const o=en(u.requiredNamespaces,n,"update()","requiredNamespaces");if(o)throw new Error(o.message)},this.isValidExtend=async r=>{if(!It(r)){const{message:n}=le("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!It(r)){const{message:f}=le("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(f)}const{topic:i,request:n,chainId:u,expiry:l}=r;await this.isValidSessionTopic(i);const{namespaces:o}=this.client.session.get(i);if(!xo(o,u)){const{message:f}=le("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(f)}if(!xg(n)){const{message:f}=le("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(f)}if(!Ag(o,u,n.method)){const{message:f}=le("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(f)}if(l&&!Cg(l,rn)){const{message:f}=le("MISSING_OR_INVALID",`request() expiry: ${l}. Expiry must be a number (in seconds) between ${rn.min} and ${rn.max}`);throw new Error(f)}},this.isValidRespond=async r=>{if(!It(r)){const{message:u}=le("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Ig(n)){const{message:u}=le("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!It(r)){const{message:n}=le("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!It(r)){const{message:o}=le("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(o)}const{topic:i,event:n,chainId:u}=r;await this.isValidSessionTopic(i);const{namespaces:l}=this.client.session.get(i);if(!xo(l,u)){const{message:o}=le("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(o)}if(!Og(n)){const{message:o}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}if(!Tg(l,u,n.name)){const{message:o}=le("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(o)}},this.isValidDisconnect=async r=>{if(!It(r)){const{message:n}=le("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!ct(n,!1)){const{message:u}=le("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(u)}})}}isInitialized(){if(!this.initialized){const{message:t}=le("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(rt.message,async t=>{const{topic:r,message:i}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const n=await this.client.core.crypto.decode(r,i);zn(n)?(this.client.core.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Kn(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.core.expirer.on(vt.expired,async t=>{const{topic:r,id:i}=og(t.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,le("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(t){if(!ct(t,!1)){const{message:r}=le("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(dr(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=le("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!ct(t,!1)){const{message:r}=le("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(dr(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=le("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(ct(t,!1)){const{message:r}=le("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=le("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Dg(t)){const{message:r}=le("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=le("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(dr(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=le("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class zg extends Pi{constructor(t,r){super(t,r,Ng,Gn),this.core=t,this.logger=r}}class Kg extends Pi{constructor(t,r){super(t,r,Rg,Gn),this.core=t,this.logger=r}}class Hg extends Pi{constructor(t,r){super(t,r,Pg,Gn),this.core=t,this.logger=r}}class Yn extends rg{constructor(t){super(t),this.protocol=Qa,this.version=ec,this.name=tn.name,this.events=new lt.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(t==null?void 0:t.name)||tn.name,this.metadata=(t==null?void 0:t.metadata)||sg();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:vi(Ae.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||tn.logger}));this.core=(t==null?void 0:t.core)||new tg(t),this.logger=Ae.generateChildLogger(r,this.name),this.session=new Kg(this.core,this.logger),this.proposal=new zg(this.core,this.logger),this.pendingRequest=new Hg(this.core,this.logger),this.engine=new jg(this)}static async init(t){const r=new Yn(t);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const qg=Yn,Vg="modulepreload",kg=function(e){return"/"+e},Ao={},Wg=function(t,r,i){if(!r||r.length===0)return t();const n=document.getElementsByTagName("link");return Promise.all(r.map(u=>{if(u=kg(u),u in Ao)return;Ao[u]=!0;const l=u.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!i)for(let b=n.length-1;b>=0;b--){const I=n[b];if(I.href===u&&(!l||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${o}`))return;const g=document.createElement("link");if(g.rel=l?"stylesheet":Vg,l||(g.as="script",g.crossOrigin=""),g.href=u,document.head.appendChild(g),l)return new Promise((b,I)=>{g.addEventListener("load",b),g.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${u}`)))})})).then(()=>t())},Gg=Symbol(),To=Object.getPrototypeOf,vn=new WeakMap,Yg=e=>e&&(vn.has(e)?vn.get(e):To(e)===Object.prototype||To(e)===Array.prototype),Jg=e=>Yg(e)&&e[Gg]||null,Co=(e,t=!0)=>{vn.set(e,t)},sn=e=>typeof e=="object"&&e!==null,ir=new WeakMap,ai=new WeakSet,Xg=(e=Object.is,t=(g,b)=>new Proxy(g,b),r=g=>sn(g)&&!ai.has(g)&&(Array.isArray(g)||!(Symbol.iterator in g))&&!(g instanceof WeakMap)&&!(g instanceof WeakSet)&&!(g instanceof Error)&&!(g instanceof Number)&&!(g instanceof Date)&&!(g instanceof String)&&!(g instanceof RegExp)&&!(g instanceof ArrayBuffer),i=g=>{switch(g.status){case"fulfilled":return g.value;case"rejected":throw g.reason;default:throw g}},n=new WeakMap,u=(g,b,I=i)=>{const $=n.get(g);if(($==null?void 0:$[0])===b)return $[1];const O=Array.isArray(g)?[]:Object.create(Object.getPrototypeOf(g));return Co(O,!0),n.set(g,[b,O]),Reflect.ownKeys(g).forEach(C=>{if(Object.getOwnPropertyDescriptor(O,C))return;const q=Reflect.get(g,C),H={value:q,enumerable:!0,configurable:!0};if(ai.has(q))Co(q,!1);else if(q instanceof Promise)delete H.value,H.get=()=>I(q);else if(ir.has(q)){const[Z,A]=ir.get(q);H.value=u(Z,A(),I)}Object.defineProperty(O,C,H)}),O},l=new WeakMap,o=[1,1],f=g=>{if(!sn(g))throw new Error("object required");const b=l.get(g);if(b)return b;let I=o[0];const $=new Set,O=(K,E=++o[0])=>{I!==E&&(I=E,$.forEach(N=>N(K,E)))};let C=o[1];const q=(K=++o[1])=>(C!==K&&!$.size&&(C=K,Z.forEach(([E])=>{const N=E[1](K);N>I&&(I=N)})),I),H=K=>(E,N)=>{const B=[...E];B[1]=[K,...B[1]],O(B,N)},Z=new Map,A=(K,E)=>{var N;if(((N={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})==null?void 0:N.MODE)!=="production"&&Z.has(K))throw new Error("prop listener already exists");if($.size){const B=E[3](H(K));Z.set(K,[E,B])}else Z.set(K,[E])},U=K=>{var E;const N=Z.get(K);N&&(Z.delete(K),(E=N[1])==null||E.call(N))},m=K=>($.add(K),$.size===1&&Z.forEach(([N,B],V)=>{var T;if(((T={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})==null?void 0:T.MODE)!=="production"&&B)throw new Error("remove already exists");const x=N[3](H(V));Z.set(V,[N,x])}),()=>{$.delete(K),$.size===0&&Z.forEach(([N,B],V)=>{B&&(B(),Z.set(V,[N]))})}),_=Array.isArray(g)?[]:Object.create(Object.getPrototypeOf(g)),a=t(_,{deleteProperty(K,E){const N=Reflect.get(K,E);U(E);const B=Reflect.deleteProperty(K,E);return B&&O(["delete",[E],N]),B},set(K,E,N,B){const V=Reflect.has(K,E),T=Reflect.get(K,E,B);if(V&&(e(T,N)||l.has(N)&&e(T,l.get(N))))return!0;U(E),sn(N)&&(N=Jg(N)||N);let x=N;if(N instanceof Promise)N.then(W=>{N.status="fulfilled",N.value=W,O(["resolve",[E],W])}).catch(W=>{N.status="rejected",N.reason=W,O(["reject",[E],W])});else{!ir.has(N)&&r(N)&&(x=f(N));const W=!ai.has(x)&&ir.get(x);W&&A(E,W)}return Reflect.set(K,E,x,B),O(["set",[E],N,T]),!0}});l.set(g,a);const y=[_,q,u,m];return ir.set(a,y),Reflect.ownKeys(g).forEach(K=>{const E=Object.getOwnPropertyDescriptor(g,K),N="value"in E;delete E.value,Object.defineProperty(_,K,E),N&&(a[K]=g[K])}),a})=>[f,ir,ai,e,t,r,i,n,u,l,o],[Zg]=Xg();function ar(e={}){return Zg(e)}function Yr(e,t,r){var i;const n=ir.get(e);((i={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})==null?void 0:i.MODE)!=="production"&&!n&&console.warn("Please use proxy object");let u;const l=[],o=n[3];let f=!1;const b=o(I=>{if(l.push(I),r){t(l.splice(0));return}u||(u=Promise.resolve().then(()=>{u=void 0,f&&t(l.splice(0))}))});return f=!0,()=>{f=!1,b()}}var rc={},Li={};Li.byteLength=t1;Li.toByteArray=i1;Li.fromByteArray=o1;var Ut=[],Dt=[],Qg=typeof Uint8Array<"u"?Uint8Array:Array,on="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var pr=0,e1=on.length;pr<e1;++pr)Ut[pr]=on[pr],Dt[on.charCodeAt(pr)]=pr;Dt["-".charCodeAt(0)]=62;Dt["_".charCodeAt(0)]=63;function ic(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var i=r===t?0:4-r%4;return[r,i]}function t1(e){var t=ic(e),r=t[0],i=t[1];return(r+i)*3/4-i}function r1(e,t,r){return(t+r)*3/4-r}function i1(e){var t,r=ic(e),i=r[0],n=r[1],u=new Qg(r1(e,i,n)),l=0,o=n>0?i-4:i,f;for(f=0;f<o;f+=4)t=Dt[e.charCodeAt(f)]<<18|Dt[e.charCodeAt(f+1)]<<12|Dt[e.charCodeAt(f+2)]<<6|Dt[e.charCodeAt(f+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=t&255;return n===2&&(t=Dt[e.charCodeAt(f)]<<2|Dt[e.charCodeAt(f+1)]>>4,u[l++]=t&255),n===1&&(t=Dt[e.charCodeAt(f)]<<10|Dt[e.charCodeAt(f+1)]<<4|Dt[e.charCodeAt(f+2)]>>2,u[l++]=t>>8&255,u[l++]=t&255),u}function n1(e){return Ut[e>>18&63]+Ut[e>>12&63]+Ut[e>>6&63]+Ut[e&63]}function s1(e,t,r){for(var i,n=[],u=t;u<r;u+=3)i=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(e[u+2]&255),n.push(n1(i));return n.join("")}function o1(e){for(var t,r=e.length,i=r%3,n=[],u=16383,l=0,o=r-i;l<o;l+=u)n.push(s1(e,l,l+u>o?o:l+u));return i===1?(t=e[r-1],n.push(Ut[t>>2]+Ut[t<<4&63]+"==")):i===2&&(t=(e[r-2]<<8)+e[r-1],n.push(Ut[t>>10]+Ut[t>>4&63]+Ut[t<<2&63]+"=")),n.join("")}var Jn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Jn.read=function(e,t,r,i,n){var u,l,o=n*8-i-1,f=(1<<o)-1,g=f>>1,b=-7,I=r?n-1:0,$=r?-1:1,O=e[t+I];for(I+=$,u=O&(1<<-b)-1,O>>=-b,b+=o;b>0;u=u*256+e[t+I],I+=$,b-=8);for(l=u&(1<<-b)-1,u>>=-b,b+=i;b>0;l=l*256+e[t+I],I+=$,b-=8);if(u===0)u=1-g;else{if(u===f)return l?NaN:(O?-1:1)*(1/0);l=l+Math.pow(2,i),u=u-g}return(O?-1:1)*l*Math.pow(2,u-i)};Jn.write=function(e,t,r,i,n,u){var l,o,f,g=u*8-n-1,b=(1<<g)-1,I=b>>1,$=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=i?0:u-1,C=i?1:-1,q=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,l=b):(l=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-l))<1&&(l--,f*=2),l+I>=1?t+=$/f:t+=$*Math.pow(2,1-I),t*f>=2&&(l++,f/=2),l+I>=b?(o=0,l=b):l+I>=1?(o=(t*f-1)*Math.pow(2,n),l=l+I):(o=t*Math.pow(2,I-1)*Math.pow(2,n),l=0));n>=8;e[r+O]=o&255,O+=C,o/=256,n-=8);for(l=l<<n|o,g+=n;g>0;e[r+O]=l&255,O+=C,l/=256,g-=8);e[r+O-C]|=q*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=Li,r=Jn,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=A,e.INSPECT_MAX_BYTES=50;const n=2147483647;e.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=u(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function u(){try{const d=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(d,s),d.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}});function l(d){if(d>n)throw new RangeError('The value "'+d+'" is invalid for option "size"');const s=new Uint8Array(d);return Object.setPrototypeOf(s,o.prototype),s}function o(d,s,c){if(typeof d=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return I(d)}return f(d,s,c)}o.poolSize=8192;function f(d,s,c){if(typeof d=="string")return $(d,s);if(ArrayBuffer.isView(d))return C(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(he(d,ArrayBuffer)||d&&he(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(he(d,SharedArrayBuffer)||d&&he(d.buffer,SharedArrayBuffer)))return q(d,s,c);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const p=d.valueOf&&d.valueOf();if(p!=null&&p!==d)return o.from(p,s,c);const D=H(d);if(D)return D;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return o.from(d[Symbol.toPrimitive]("string"),s,c);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}o.from=function(d,s,c){return f(d,s,c)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function g(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function b(d,s,c){return g(d),d<=0?l(d):s!==void 0?typeof c=="string"?l(d).fill(s,c):l(d).fill(s):l(d)}o.alloc=function(d,s,c){return b(d,s,c)};function I(d){return g(d),l(d<0?0:Z(d)|0)}o.allocUnsafe=function(d){return I(d)},o.allocUnsafeSlow=function(d){return I(d)};function $(d,s){if((typeof s!="string"||s==="")&&(s="utf8"),!o.isEncoding(s))throw new TypeError("Unknown encoding: "+s);const c=U(d,s)|0;let p=l(c);const D=p.write(d,s);return D!==c&&(p=p.slice(0,D)),p}function O(d){const s=d.length<0?0:Z(d.length)|0,c=l(s);for(let p=0;p<s;p+=1)c[p]=d[p]&255;return c}function C(d){if(he(d,Uint8Array)){const s=new Uint8Array(d);return q(s.buffer,s.byteOffset,s.byteLength)}return O(d)}function q(d,s,c){if(s<0||d.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<s+(c||0))throw new RangeError('"length" is outside of buffer bounds');let p;return s===void 0&&c===void 0?p=new Uint8Array(d):c===void 0?p=new Uint8Array(d,s):p=new Uint8Array(d,s,c),Object.setPrototypeOf(p,o.prototype),p}function H(d){if(o.isBuffer(d)){const s=Z(d.length)|0,c=l(s);return c.length===0||d.copy(c,0,0,s),c}if(d.length!==void 0)return typeof d.length!="number"||ye(d.length)?l(0):O(d);if(d.type==="Buffer"&&Array.isArray(d.data))return O(d.data)}function Z(d){if(d>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return d|0}function A(d){return+d!=d&&(d=0),o.alloc(+d)}o.isBuffer=function(s){return s!=null&&s._isBuffer===!0&&s!==o.prototype},o.compare=function(s,c){if(he(s,Uint8Array)&&(s=o.from(s,s.offset,s.byteLength)),he(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),!o.isBuffer(s)||!o.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(s===c)return 0;let p=s.length,D=c.length;for(let F=0,j=Math.min(p,D);F<j;++F)if(s[F]!==c[F]){p=s[F],D=c[F];break}return p<D?-1:D<p?1:0},o.isEncoding=function(s){switch(String(s).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(s,c){if(!Array.isArray(s))throw new TypeError('"list" argument must be an Array of Buffers');if(s.length===0)return o.alloc(0);let p;if(c===void 0)for(c=0,p=0;p<s.length;++p)c+=s[p].length;const D=o.allocUnsafe(c);let F=0;for(p=0;p<s.length;++p){let j=s[p];if(he(j,Uint8Array))F+j.length>D.length?(o.isBuffer(j)||(j=o.from(j)),j.copy(D,F)):Uint8Array.prototype.set.call(D,j,F);else if(o.isBuffer(j))j.copy(D,F);else throw new TypeError('"list" argument must be an Array of Buffers');F+=j.length}return D};function U(d,s){if(o.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||he(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);const c=d.length,p=arguments.length>2&&arguments[2]===!0;if(!p&&c===0)return 0;let D=!1;for(;;)switch(s){case"ascii":case"latin1":case"binary":return c;case"utf8":case"utf-8":return xe(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return c*2;case"hex":return c>>>1;case"base64":return Ee(d).length;default:if(D)return p?-1:xe(d).length;s=(""+s).toLowerCase(),D=!0}}o.byteLength=U;function m(d,s,c){let p=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((c===void 0||c>this.length)&&(c=this.length),c<=0)||(c>>>=0,s>>>=0,c<=s))return"";for(d||(d="utf8");;)switch(d){case"hex":return z(this,s,c);case"utf8":case"utf-8":return T(this,s,c);case"ascii":return G(this,s,c);case"latin1":case"binary":return k(this,s,c);case"base64":return V(this,s,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,s,c);default:if(p)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),p=!0}}o.prototype._isBuffer=!0;function _(d,s,c){const p=d[s];d[s]=d[c],d[c]=p}o.prototype.swap16=function(){const s=this.length;if(s%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let c=0;c<s;c+=2)_(this,c,c+1);return this},o.prototype.swap32=function(){const s=this.length;if(s%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let c=0;c<s;c+=4)_(this,c,c+3),_(this,c+1,c+2);return this},o.prototype.swap64=function(){const s=this.length;if(s%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let c=0;c<s;c+=8)_(this,c,c+7),_(this,c+1,c+6),_(this,c+2,c+5),_(this,c+3,c+4);return this},o.prototype.toString=function(){const s=this.length;return s===0?"":arguments.length===0?T(this,0,s):m.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(s){if(!o.isBuffer(s))throw new TypeError("Argument must be a Buffer");return this===s?!0:o.compare(this,s)===0},o.prototype.inspect=function(){let s="";const c=e.INSPECT_MAX_BYTES;return s=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(s+=" ... "),"<Buffer "+s+">"},i&&(o.prototype[i]=o.prototype.inspect),o.prototype.compare=function(s,c,p,D,F){if(he(s,Uint8Array)&&(s=o.from(s,s.offset,s.byteLength)),!o.isBuffer(s))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof s);if(c===void 0&&(c=0),p===void 0&&(p=s?s.length:0),D===void 0&&(D=0),F===void 0&&(F=this.length),c<0||p>s.length||D<0||F>this.length)throw new RangeError("out of range index");if(D>=F&&c>=p)return 0;if(D>=F)return-1;if(c>=p)return 1;if(c>>>=0,p>>>=0,D>>>=0,F>>>=0,this===s)return 0;let j=F-D,ie=p-c;const oe=Math.min(j,ie),ve=this.slice(D,F),Ie=s.slice(c,p);for(let De=0;De<oe;++De)if(ve[De]!==Ie[De]){j=ve[De],ie=Ie[De];break}return j<ie?-1:ie<j?1:0};function S(d,s,c,p,D){if(d.length===0)return-1;if(typeof c=="string"?(p=c,c=0):c>2147483647?c=2147483647:c<-2147483648&&(c=-2147483648),c=+c,ye(c)&&(c=D?0:d.length-1),c<0&&(c=d.length+c),c>=d.length){if(D)return-1;c=d.length-1}else if(c<0)if(D)c=0;else return-1;if(typeof s=="string"&&(s=o.from(s,p)),o.isBuffer(s))return s.length===0?-1:a(d,s,c,p,D);if(typeof s=="number")return s=s&255,typeof Uint8Array.prototype.indexOf=="function"?D?Uint8Array.prototype.indexOf.call(d,s,c):Uint8Array.prototype.lastIndexOf.call(d,s,c):a(d,[s],c,p,D);throw new TypeError("val must be string, number or Buffer")}function a(d,s,c,p,D){let F=1,j=d.length,ie=s.length;if(p!==void 0&&(p=String(p).toLowerCase(),p==="ucs2"||p==="ucs-2"||p==="utf16le"||p==="utf-16le")){if(d.length<2||s.length<2)return-1;F=2,j/=2,ie/=2,c/=2}function oe(Ie,De){return F===1?Ie[De]:Ie.readUInt16BE(De*F)}let ve;if(D){let Ie=-1;for(ve=c;ve<j;ve++)if(oe(d,ve)===oe(s,Ie===-1?0:ve-Ie)){if(Ie===-1&&(Ie=ve),ve-Ie+1===ie)return Ie*F}else Ie!==-1&&(ve-=ve-Ie),Ie=-1}else for(c+ie>j&&(c=j-ie),ve=c;ve>=0;ve--){let Ie=!0;for(let De=0;De<ie;De++)if(oe(d,ve+De)!==oe(s,De)){Ie=!1;break}if(Ie)return ve}return-1}o.prototype.includes=function(s,c,p){return this.indexOf(s,c,p)!==-1},o.prototype.indexOf=function(s,c,p){return S(this,s,c,p,!0)},o.prototype.lastIndexOf=function(s,c,p){return S(this,s,c,p,!1)};function y(d,s,c,p){c=Number(c)||0;const D=d.length-c;p?(p=Number(p),p>D&&(p=D)):p=D;const F=s.length;p>F/2&&(p=F/2);let j;for(j=0;j<p;++j){const ie=parseInt(s.substr(j*2,2),16);if(ye(ie))return j;d[c+j]=ie}return j}function K(d,s,c,p){return be(xe(s,d.length-c),d,c,p)}function E(d,s,c,p){return be(Fe(s),d,c,p)}function N(d,s,c,p){return be(Ee(s),d,c,p)}function B(d,s,c,p){return be(Ue(s,d.length-c),d,c,p)}o.prototype.write=function(s,c,p,D){if(c===void 0)D="utf8",p=this.length,c=0;else if(p===void 0&&typeof c=="string")D=c,p=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(p)?(p=p>>>0,D===void 0&&(D="utf8")):(D=p,p=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const F=this.length-c;if((p===void 0||p>F)&&(p=F),s.length>0&&(p<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");D||(D="utf8");let j=!1;for(;;)switch(D){case"hex":return y(this,s,c,p);case"utf8":case"utf-8":return K(this,s,c,p);case"ascii":case"latin1":case"binary":return E(this,s,c,p);case"base64":return N(this,s,c,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,s,c,p);default:if(j)throw new TypeError("Unknown encoding: "+D);D=(""+D).toLowerCase(),j=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(d,s,c){return s===0&&c===d.length?t.fromByteArray(d):t.fromByteArray(d.slice(s,c))}function T(d,s,c){c=Math.min(d.length,c);const p=[];let D=s;for(;D<c;){const F=d[D];let j=null,ie=F>239?4:F>223?3:F>191?2:1;if(D+ie<=c){let oe,ve,Ie,De;switch(ie){case 1:F<128&&(j=F);break;case 2:oe=d[D+1],(oe&192)===128&&(De=(F&31)<<6|oe&63,De>127&&(j=De));break;case 3:oe=d[D+1],ve=d[D+2],(oe&192)===128&&(ve&192)===128&&(De=(F&15)<<12|(oe&63)<<6|ve&63,De>2047&&(De<55296||De>57343)&&(j=De));break;case 4:oe=d[D+1],ve=d[D+2],Ie=d[D+3],(oe&192)===128&&(ve&192)===128&&(Ie&192)===128&&(De=(F&15)<<18|(oe&63)<<12|(ve&63)<<6|Ie&63,De>65535&&De<1114112&&(j=De))}}j===null?(j=65533,ie=1):j>65535&&(j-=65536,p.push(j>>>10&1023|55296),j=56320|j&1023),p.push(j),D+=ie}return W(p)}const x=4096;function W(d){const s=d.length;if(s<=x)return String.fromCharCode.apply(String,d);let c="",p=0;for(;p<s;)c+=String.fromCharCode.apply(String,d.slice(p,p+=x));return c}function G(d,s,c){let p="";c=Math.min(d.length,c);for(let D=s;D<c;++D)p+=String.fromCharCode(d[D]&127);return p}function k(d,s,c){let p="";c=Math.min(d.length,c);for(let D=s;D<c;++D)p+=String.fromCharCode(d[D]);return p}function z(d,s,c){const p=d.length;(!s||s<0)&&(s=0),(!c||c<0||c>p)&&(c=p);let D="";for(let F=s;F<c;++F)D+=me[d[F]];return D}function Y(d,s,c){const p=d.slice(s,c);let D="";for(let F=0;F<p.length-1;F+=2)D+=String.fromCharCode(p[F]+p[F+1]*256);return D}o.prototype.slice=function(s,c){const p=this.length;s=~~s,c=c===void 0?p:~~c,s<0?(s+=p,s<0&&(s=0)):s>p&&(s=p),c<0?(c+=p,c<0&&(c=0)):c>p&&(c=p),c<s&&(c=s);const D=this.subarray(s,c);return Object.setPrototypeOf(D,o.prototype),D};function J(d,s,c){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+s>c)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUintLE=o.prototype.readUIntLE=function(s,c,p){s=s>>>0,c=c>>>0,p||J(s,c,this.length);let D=this[s],F=1,j=0;for(;++j<c&&(F*=256);)D+=this[s+j]*F;return D},o.prototype.readUintBE=o.prototype.readUIntBE=function(s,c,p){s=s>>>0,c=c>>>0,p||J(s,c,this.length);let D=this[s+--c],F=1;for(;c>0&&(F*=256);)D+=this[s+--c]*F;return D},o.prototype.readUint8=o.prototype.readUInt8=function(s,c){return s=s>>>0,c||J(s,1,this.length),this[s]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(s,c){return s=s>>>0,c||J(s,2,this.length),this[s]|this[s+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(s,c){return s=s>>>0,c||J(s,2,this.length),this[s]<<8|this[s+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(s,c){return s=s>>>0,c||J(s,4,this.length),(this[s]|this[s+1]<<8|this[s+2]<<16)+this[s+3]*16777216},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(s,c){return s=s>>>0,c||J(s,4,this.length),this[s]*16777216+(this[s+1]<<16|this[s+2]<<8|this[s+3])},o.prototype.readBigUInt64LE=ue(function(s){s=s>>>0,te(s,"offset");const c=this[s],p=this[s+7];(c===void 0||p===void 0)&&fe(s,this.length-8);const D=c+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24,F=this[++s]+this[++s]*2**8+this[++s]*2**16+p*2**24;return BigInt(D)+(BigInt(F)<<BigInt(32))}),o.prototype.readBigUInt64BE=ue(function(s){s=s>>>0,te(s,"offset");const c=this[s],p=this[s+7];(c===void 0||p===void 0)&&fe(s,this.length-8);const D=c*2**24+this[++s]*2**16+this[++s]*2**8+this[++s],F=this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+p;return(BigInt(D)<<BigInt(32))+BigInt(F)}),o.prototype.readIntLE=function(s,c,p){s=s>>>0,c=c>>>0,p||J(s,c,this.length);let D=this[s],F=1,j=0;for(;++j<c&&(F*=256);)D+=this[s+j]*F;return F*=128,D>=F&&(D-=Math.pow(2,8*c)),D},o.prototype.readIntBE=function(s,c,p){s=s>>>0,c=c>>>0,p||J(s,c,this.length);let D=c,F=1,j=this[s+--D];for(;D>0&&(F*=256);)j+=this[s+--D]*F;return F*=128,j>=F&&(j-=Math.pow(2,8*c)),j},o.prototype.readInt8=function(s,c){return s=s>>>0,c||J(s,1,this.length),this[s]&128?(255-this[s]+1)*-1:this[s]},o.prototype.readInt16LE=function(s,c){s=s>>>0,c||J(s,2,this.length);const p=this[s]|this[s+1]<<8;return p&32768?p|4294901760:p},o.prototype.readInt16BE=function(s,c){s=s>>>0,c||J(s,2,this.length);const p=this[s+1]|this[s]<<8;return p&32768?p|4294901760:p},o.prototype.readInt32LE=function(s,c){return s=s>>>0,c||J(s,4,this.length),this[s]|this[s+1]<<8|this[s+2]<<16|this[s+3]<<24},o.prototype.readInt32BE=function(s,c){return s=s>>>0,c||J(s,4,this.length),this[s]<<24|this[s+1]<<16|this[s+2]<<8|this[s+3]},o.prototype.readBigInt64LE=ue(function(s){s=s>>>0,te(s,"offset");const c=this[s],p=this[s+7];(c===void 0||p===void 0)&&fe(s,this.length-8);const D=this[s+4]+this[s+5]*2**8+this[s+6]*2**16+(p<<24);return(BigInt(D)<<BigInt(32))+BigInt(c+this[++s]*2**8+this[++s]*2**16+this[++s]*2**24)}),o.prototype.readBigInt64BE=ue(function(s){s=s>>>0,te(s,"offset");const c=this[s],p=this[s+7];(c===void 0||p===void 0)&&fe(s,this.length-8);const D=(c<<24)+this[++s]*2**16+this[++s]*2**8+this[++s];return(BigInt(D)<<BigInt(32))+BigInt(this[++s]*2**24+this[++s]*2**16+this[++s]*2**8+p)}),o.prototype.readFloatLE=function(s,c){return s=s>>>0,c||J(s,4,this.length),r.read(this,s,!0,23,4)},o.prototype.readFloatBE=function(s,c){return s=s>>>0,c||J(s,4,this.length),r.read(this,s,!1,23,4)},o.prototype.readDoubleLE=function(s,c){return s=s>>>0,c||J(s,8,this.length),r.read(this,s,!0,52,8)},o.prototype.readDoubleBE=function(s,c){return s=s>>>0,c||J(s,8,this.length),r.read(this,s,!1,52,8)};function re(d,s,c,p,D,F){if(!o.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>D||s<F)throw new RangeError('"value" argument is out of bounds');if(c+p>d.length)throw new RangeError("Index out of range")}o.prototype.writeUintLE=o.prototype.writeUIntLE=function(s,c,p,D){if(s=+s,c=c>>>0,p=p>>>0,!D){const ie=Math.pow(2,8*p)-1;re(this,s,c,p,ie,0)}let F=1,j=0;for(this[c]=s&255;++j<p&&(F*=256);)this[c+j]=s/F&255;return c+p},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(s,c,p,D){if(s=+s,c=c>>>0,p=p>>>0,!D){const ie=Math.pow(2,8*p)-1;re(this,s,c,p,ie,0)}let F=p-1,j=1;for(this[c+F]=s&255;--F>=0&&(j*=256);)this[c+F]=s/j&255;return c+p},o.prototype.writeUint8=o.prototype.writeUInt8=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,1,255,0),this[c]=s&255,c+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,2,65535,0),this[c]=s&255,this[c+1]=s>>>8,c+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,2,65535,0),this[c]=s>>>8,this[c+1]=s&255,c+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,4,4294967295,0),this[c+3]=s>>>24,this[c+2]=s>>>16,this[c+1]=s>>>8,this[c]=s&255,c+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,4,4294967295,0),this[c]=s>>>24,this[c+1]=s>>>16,this[c+2]=s>>>8,this[c+3]=s&255,c+4};function Q(d,s,c,p,D){ee(s,p,D,d,c,7);let F=Number(s&BigInt(4294967295));d[c++]=F,F=F>>8,d[c++]=F,F=F>>8,d[c++]=F,F=F>>8,d[c++]=F;let j=Number(s>>BigInt(32)&BigInt(4294967295));return d[c++]=j,j=j>>8,d[c++]=j,j=j>>8,d[c++]=j,j=j>>8,d[c++]=j,c}function ae(d,s,c,p,D){ee(s,p,D,d,c,7);let F=Number(s&BigInt(4294967295));d[c+7]=F,F=F>>8,d[c+6]=F,F=F>>8,d[c+5]=F,F=F>>8,d[c+4]=F;let j=Number(s>>BigInt(32)&BigInt(4294967295));return d[c+3]=j,j=j>>8,d[c+2]=j,j=j>>8,d[c+1]=j,j=j>>8,d[c]=j,c+8}o.prototype.writeBigUInt64LE=ue(function(s,c=0){return Q(this,s,c,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=ue(function(s,c=0){return ae(this,s,c,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(s,c,p,D){if(s=+s,c=c>>>0,!D){const oe=Math.pow(2,8*p-1);re(this,s,c,p,oe-1,-oe)}let F=0,j=1,ie=0;for(this[c]=s&255;++F<p&&(j*=256);)s<0&&ie===0&&this[c+F-1]!==0&&(ie=1),this[c+F]=(s/j>>0)-ie&255;return c+p},o.prototype.writeIntBE=function(s,c,p,D){if(s=+s,c=c>>>0,!D){const oe=Math.pow(2,8*p-1);re(this,s,c,p,oe-1,-oe)}let F=p-1,j=1,ie=0;for(this[c+F]=s&255;--F>=0&&(j*=256);)s<0&&ie===0&&this[c+F+1]!==0&&(ie=1),this[c+F]=(s/j>>0)-ie&255;return c+p},o.prototype.writeInt8=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,1,127,-128),s<0&&(s=255+s+1),this[c]=s&255,c+1},o.prototype.writeInt16LE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,2,32767,-32768),this[c]=s&255,this[c+1]=s>>>8,c+2},o.prototype.writeInt16BE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,2,32767,-32768),this[c]=s>>>8,this[c+1]=s&255,c+2},o.prototype.writeInt32LE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,4,2147483647,-2147483648),this[c]=s&255,this[c+1]=s>>>8,this[c+2]=s>>>16,this[c+3]=s>>>24,c+4},o.prototype.writeInt32BE=function(s,c,p){return s=+s,c=c>>>0,p||re(this,s,c,4,2147483647,-2147483648),s<0&&(s=4294967295+s+1),this[c]=s>>>24,this[c+1]=s>>>16,this[c+2]=s>>>8,this[c+3]=s&255,c+4},o.prototype.writeBigInt64LE=ue(function(s,c=0){return Q(this,s,c,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=ue(function(s,c=0){return ae(this,s,c,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ne(d,s,c,p,D,F){if(c+p>d.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("Index out of range")}function ge(d,s,c,p,D){return s=+s,c=c>>>0,D||ne(d,s,c,4),r.write(d,s,c,p,23,4),c+4}o.prototype.writeFloatLE=function(s,c,p){return ge(this,s,c,!0,p)},o.prototype.writeFloatBE=function(s,c,p){return ge(this,s,c,!1,p)};function M(d,s,c,p,D){return s=+s,c=c>>>0,D||ne(d,s,c,8),r.write(d,s,c,p,52,8),c+8}o.prototype.writeDoubleLE=function(s,c,p){return M(this,s,c,!0,p)},o.prototype.writeDoubleBE=function(s,c,p){return M(this,s,c,!1,p)},o.prototype.copy=function(s,c,p,D){if(!o.isBuffer(s))throw new TypeError("argument should be a Buffer");if(p||(p=0),!D&&D!==0&&(D=this.length),c>=s.length&&(c=s.length),c||(c=0),D>0&&D<p&&(D=p),D===p||s.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(p<0||p>=this.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("sourceEnd out of bounds");D>this.length&&(D=this.length),s.length-c<D-p&&(D=s.length-c+p);const F=D-p;return this===s&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(c,p,D):Uint8Array.prototype.set.call(s,this.subarray(p,D),c),F},o.prototype.fill=function(s,c,p,D){if(typeof s=="string"){if(typeof c=="string"?(D=c,c=0,p=this.length):typeof p=="string"&&(D=p,p=this.length),D!==void 0&&typeof D!="string")throw new TypeError("encoding must be a string");if(typeof D=="string"&&!o.isEncoding(D))throw new TypeError("Unknown encoding: "+D);if(s.length===1){const j=s.charCodeAt(0);(D==="utf8"&&j<128||D==="latin1")&&(s=j)}}else typeof s=="number"?s=s&255:typeof s=="boolean"&&(s=Number(s));if(c<0||this.length<c||this.length<p)throw new RangeError("Out of range index");if(p<=c)return this;c=c>>>0,p=p===void 0?this.length:p>>>0,s||(s=0);let F;if(typeof s=="number")for(F=c;F<p;++F)this[F]=s;else{const j=o.isBuffer(s)?s:o.from(s,D),ie=j.length;if(ie===0)throw new TypeError('The value "'+s+'" is invalid for argument "value"');for(F=0;F<p-c;++F)this[F+c]=j[F%ie]}return this};const L={};function R(d,s,c){L[d]=class extends c{constructor(){super(),Object.defineProperty(this,"message",{value:s.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(D){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:D,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}R("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),R("ERR_INVALID_ARG_TYPE",function(d,s){return`The "${d}" argument must be of type number. Received type ${typeof s}`},TypeError),R("ERR_OUT_OF_RANGE",function(d,s,c){let p=`The value of "${d}" is out of range.`,D=c;return Number.isInteger(c)&&Math.abs(c)>2**32?D=h(String(c)):typeof c=="bigint"&&(D=String(c),(c>BigInt(2)**BigInt(32)||c<-(BigInt(2)**BigInt(32)))&&(D=h(D)),D+="n"),p+=` It must be ${s}. Received ${D}`,p},RangeError);function h(d){let s="",c=d.length;const p=d[0]==="-"?1:0;for(;c>=p+4;c-=3)s=`_${d.slice(c-3,c)}${s}`;return`${d.slice(0,c)}${s}`}function v(d,s,c){te(s,"offset"),(d[s]===void 0||d[s+c]===void 0)&&fe(s,d.length-(c+1))}function ee(d,s,c,p,D,F){if(d>c||d<s){const j=typeof s=="bigint"?"n":"";let ie;throw F>3?s===0||s===BigInt(0)?ie=`>= 0${j} and < 2${j} ** ${(F+1)*8}${j}`:ie=`>= -(2${j} ** ${(F+1)*8-1}${j}) and < 2 ** ${(F+1)*8-1}${j}`:ie=`>= ${s}${j} and <= ${c}${j}`,new L.ERR_OUT_OF_RANGE("value",ie,d)}v(p,D,F)}function te(d,s){if(typeof d!="number")throw new L.ERR_INVALID_ARG_TYPE(s,"number",d)}function fe(d,s,c){throw Math.floor(d)!==d?(te(d,c),new L.ERR_OUT_OF_RANGE(c||"offset","an integer",d)):s<0?new L.ERR_BUFFER_OUT_OF_BOUNDS:new L.ERR_OUT_OF_RANGE(c||"offset",`>= ${c?1:0} and <= ${s}`,d)}const Se=/[^+/0-9A-Za-z-_]/g;function _e(d){if(d=d.split("=")[0],d=d.trim().replace(Se,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function xe(d,s){s=s||1/0;let c;const p=d.length;let D=null;const F=[];for(let j=0;j<p;++j){if(c=d.charCodeAt(j),c>55295&&c<57344){if(!D){if(c>56319){(s-=3)>-1&&F.push(239,191,189);continue}else if(j+1===p){(s-=3)>-1&&F.push(239,191,189);continue}D=c;continue}if(c<56320){(s-=3)>-1&&F.push(239,191,189),D=c;continue}c=(D-55296<<10|c-56320)+65536}else D&&(s-=3)>-1&&F.push(239,191,189);if(D=null,c<128){if((s-=1)<0)break;F.push(c)}else if(c<2048){if((s-=2)<0)break;F.push(c>>6|192,c&63|128)}else if(c<65536){if((s-=3)<0)break;F.push(c>>12|224,c>>6&63|128,c&63|128)}else if(c<1114112){if((s-=4)<0)break;F.push(c>>18|240,c>>12&63|128,c>>6&63|128,c&63|128)}else throw new Error("Invalid code point")}return F}function Fe(d){const s=[];for(let c=0;c<d.length;++c)s.push(d.charCodeAt(c)&255);return s}function Ue(d,s){let c,p,D;const F=[];for(let j=0;j<d.length&&!((s-=2)<0);++j)c=d.charCodeAt(j),p=c>>8,D=c%256,F.push(D),F.push(p);return F}function Ee(d){return t.toByteArray(_e(d))}function be(d,s,c,p){let D;for(D=0;D<p&&!(D+c>=s.length||D>=d.length);++D)s[D+c]=d[D];return D}function he(d,s){return d instanceof s||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===s.name}function ye(d){return d!==d}const me=function(){const d="0123456789abcdef",s=new Array(256);for(let c=0;c<16;++c){const p=c*16;for(let D=0;D<16;++D)s[p+D]=d[c]+d[D]}return s}();function ue(d){return typeof BigInt>"u"?de:d}function de(){throw new Error("BigInt not supported")}})(rc);const Oe=ar({selectedChain:void 0,chains:void 0,standaloneChains:void 0,standaloneUri:void 0,address:void 0,profileName:void 0,profileAvatar:void 0,profileLoading:!1,balanceLoading:!1,balance:void 0,isConnected:!1,isStandalone:!1,isCustomDesktop:!1,isCustomMobile:!1,isDataLoaded:!1,isUiLoaded:!1,walletConnectVersion:1}),it={state:Oe,subscribe(e){return Yr(Oe,()=>e(Oe))},setChains(e){Oe.chains=e},setStandaloneChains(e){Oe.standaloneChains=e},setStandaloneUri(e){Oe.standaloneUri=e},getSelectedChain(){const e=Dn.client().getNetwork().chain;return e&&(Oe.selectedChain=e),Oe.selectedChain},setSelectedChain(e){Oe.selectedChain=e},setIsStandalone(e){Oe.isStandalone=e},setIsCustomDesktop(e){Oe.isCustomDesktop=e},setIsCustomMobile(e){Oe.isCustomMobile=e},getAccount(){const e=Dn.client().getAccount();Oe.address=e.address,Oe.isConnected=e.isConnected},setAddress(e){Oe.address=e},setIsConnected(e){Oe.isConnected=e},setProfileName(e){Oe.profileName=e},setProfileAvatar(e){Oe.profileAvatar=e},setProfileLoading(e){Oe.profileLoading=e},setBalanceLoading(e){Oe.balanceLoading=e},setBalance(e){Oe.balance=e},setIsDataLoaded(e){Oe.isDataLoaded=e},setIsUiLoaded(e){Oe.isUiLoaded=e},setWalletConnectVersion(e){Oe.walletConnectVersion=e},resetEnsProfile(){Oe.profileName=void 0,Oe.profileAvatar=void 0},resetBalance(){Oe.balance=void 0},resetAccount(){Oe.address=void 0,Oe.isConnected=!1,it.resetEnsProfile(),it.resetBalance()}},Rr=ar({initialized:!1,ethereumClient:void 0}),Dn={setEthereumClient(e){!Rr.initialized&&e&&(Rr.ethereumClient=e,it.setChains(e.chains),Rr.initialized=!0)},client(){if(Rr.ethereumClient)return Rr.ethereumClient;throw new Error("ClientCtrl has no client set")}},nr={WALLETCONNECT_DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",isMobile(){return!1},isAndroid(){return nr.isMobile()&&navigator.userAgent.toLowerCase().includes("android")},isEmptyObject(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.getOwnPropertyNames(e).length===0&&Object.getOwnPropertySymbols(e).length===0},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},formatNativeUrl(e,t,r){if(nr.isHttpUrl(e))return this.formatUniversalUrl(e,t,r);let i=e;i.includes("://")||(i=e.replaceAll("/","").replaceAll(":",""),i=`${i}://`),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(t);return`${i}wc?uri=${n}`},formatUniversalUrl(e,t,r){if(!nr.isHttpUrl(e))return this.formatNativeUrl(e,t,r);let i=e;e.endsWith("/")&&(i=e.slice(0,-1)),this.setWalletConnectDeepLink(i,r);const n=encodeURIComponent(t);return`${i}/wc?uri=${n}`},async wait(e){return new Promise(t=>{setTimeout(t,e)})},openHref(e,t="_self"){window.open(e,t,"noreferrer noopener")},setWalletConnectDeepLink(e,t){localStorage.setItem(nr.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))},setWalletConnectAndroidDeepLink(e){const[t]=e.split("?");localStorage.setItem(nr.WALLETCONNECT_DEEPLINK_CHOICE,JSON.stringify({href:t,name:"Android"}))},removeWalletConnectDeepLink(){localStorage.removeItem(nr.WALLETCONNECT_DEEPLINK_CHOICE)},isNull(e){return e===null}};function a1(){return typeof matchMedia<"u"&&matchMedia("(prefers-color-scheme: dark)").matches}const Ur=ar({projectId:"",themeMode:a1()?"dark":"light",themeColor:"default",themeBackground:nr.isMobile()?"themeColor":"gradient",themeZIndex:89,mobileWallets:void 0,desktopWallets:void 0,walletImages:void 0,chainImages:void 0,tokenImages:void 0,standaloneChains:void 0,enableStandaloneMode:!1,enableNetworkView:!1,enableAccountView:!0,defaultChain:void 0,explorerAllowList:void 0,explorerDenyList:void 0,termsOfServiceUrl:void 0,privacyPolicyUrl:void 0}),Ei={state:Ur,subscribe(e){return Yr(Ur,()=>e(Ur))},setConfig(e){var t,r,i,n;if(it.setStandaloneChains(e.standaloneChains),it.setIsStandalone(Boolean((t=e.standaloneChains)==null?void 0:t.length)||Boolean(e.enableStandaloneMode)),it.setIsCustomMobile(Boolean((r=e.mobileWallets)==null?void 0:r.length)),it.setIsCustomDesktop(Boolean((i=e.desktopWallets)==null?void 0:i.length)),it.setWalletConnectVersion((n=e.walletConnectVersion)!=null?n:1),e.defaultChain)it.setSelectedChain(e.defaultChain);else if(!it.state.isStandalone){const u=Dn.client().getDefaultChain();it.setSelectedChain(u)}Object.assign(Ur,e)},setThemeConfig(e){Object.assign(Ur,e)}},No="https://explorer-api.walletconnect.com";function c1(e){const t=Object.fromEntries(Object.entries(e).filter(([r,i])=>typeof i<"u"&&i!==null&&i!=="").map(([r,i])=>[r,i.toString()]));return new URLSearchParams(t).toString()}const ci={async fetchWallets(e,t){const r=c1(t),i=`${No}/v3/wallets?projectId=${e}&${r}`;return(await fetch(i)).json()},formatImageUrl(e,t){return`${No}/v3/logo/lg/${t}?projectId=${e}`}},tr=ar({wallets:{listings:[],total:0,page:1},search:{listings:[],total:0,page:1},previewWallets:[],recomendedWallets:[]});function ui(){const{projectId:e}=Ei.state;if(!e)throw new Error("projectId is required to work with explorer api");return e}const C1={state:tr,async getPreviewWallets(e){const{listings:t}=await ci.fetchWallets(ui(),e);return tr.previewWallets=Object.values(t),tr.previewWallets},async getRecomendedWallets(){const{listings:e}=await ci.fetchWallets(ui(),{page:1,entries:6});tr.recomendedWallets=Object.values(e)},async getPaginatedWallets(e){const{page:t,search:r}=e,{listings:i,total:n}=await ci.fetchWallets(ui(),e),u=Object.values(i),l=r?"search":"wallets";return tr[l]={listings:[...tr[l].listings,...u],total:n,page:t??1},{listings:u,total:n}},getImageUrl(e){return ci.formatImageUrl(ui(),e)},resetSearch(){tr.search={listings:[],total:0,page:1}}},yt=ar({history:["ConnectWallet"],view:"ConnectWallet",data:void 0}),Pr={state:yt,subscribe(e){return Yr(yt,()=>e(yt))},push(e,t){e!==yt.view&&(yt.view=e,t&&(yt.data=t),yt.history.push(e))},replace(e){yt.view=e,yt.history=[e]},goBack(){if(yt.history.length>1){yt.history.pop();const[e]=yt.history.slice(-1);yt.view=e}}},gr=ar({open:!1}),an={state:gr,subscribe(e){return Yr(gr,()=>e(gr))},async open(e){return new Promise(t=>{const{isConnected:r,isStandalone:i,isUiLoaded:n,isDataLoaded:u}=it.state,{enableNetworkView:l}=Ei.state;if(i?(it.setStandaloneUri(e==null?void 0:e.uri),it.setStandaloneChains(e==null?void 0:e.standaloneChains),Pr.replace("ConnectWallet")):e!=null&&e.route?Pr.replace(e.route):r?Pr.replace("Account"):l?Pr.replace("SelectNetwork"):Pr.replace("ConnectWallet"),n&&u)gr.open=!0,t();else{const o=setInterval(()=>{it.state.isUiLoaded&&it.state.isDataLoaded&&(clearInterval(o),gr.open=!0,t())},200)}})},close(){gr.open=!1}},rr=ar({open:!1,message:"",variant:"success"}),N1={state:rr,subscribe(e){return Yr(rr,()=>e(rr))},openToast(e,t){rr.open=!0,rr.message=e,rr.variant=t},closeToast(){rr.open=!1}};typeof window<"u"&&(window.Buffer||(window.Buffer=rc.Buffer),window.global||(window.global=window),window.process||(window.process={env:{}}));var u1=Object.defineProperty,Ro=Object.getOwnPropertySymbols,h1=Object.prototype.hasOwnProperty,l1=Object.prototype.propertyIsEnumerable,Uo=(e,t,r)=>t in e?u1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f1=(e,t)=>{for(var r in t||(t={}))h1.call(t,r)&&Uo(e,r,t[r]);if(Ro)for(var r of Ro(t))l1.call(t,r)&&Uo(e,r,t[r]);return e};class d1{constructor(t){this.openModal=an.open,this.closeModal=an.close,this.subscribeModal=an.subscribe,this.setTheme=Ei.setThemeConfig,Ei.setConfig(f1({enableStandaloneMode:!0},t)),this.initUi()}async initUi(){if(typeof window<"u"){await Wg(()=>import("./index-a34357b9.js"),[]);const t=document.createElement("w3m-modal");document.body.insertAdjacentElement("beforeend",t),it.setIsUiLoaded(!0)}}}const fi=document.getElementById("connect-button"),nc="8e6b5ffdcbc9794bf9f4a1952578365b",sc={eip155:{methods:["eth_sign"],chains:["eip155:1"],events:["accountsChanged"]}},Po=new d1({projectId:nc,standaloneChains:sc.eip155.chains});let Sn;async function p1(){try{fi.disabled=!0,Sn=await qg.init({projectId:nc}),fi.disabled=!1,fi.innerText="Connect Wallet"}catch(e){console.error(e)}}p1();fi.addEventListener("click",async()=>{try{if(Sn){const{uri:e,approval:t}=await Sn.connect({requiredNamespaces:sc});e&&(await Po.openModal({uri:e}),await t(),Po.closeModal())}}catch(e){console.error(e)}});export{C1 as A,N1 as D,Dn as L,Ei as W,it as a,nr as d,Pr as g,an as k};
